var E=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var N=E((exports,module)=>{var vscode=require("vscode"),isWebRuntime=!0,inspectValue=isWebRuntime?o=>{if(typeof o=="string")return o;try{return JSON.stringify(o,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",Logger=class{constructor(){this.C=vscode.window.createOutputChannel("Explorer Dates"),this.ct=!1,this.c=null,this.ge=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.ge)||(this.ge=DEFAULT_LOG_PROFILE),this.pe=new Map,this.zt=DEFAULT_CONSOLE_LEVEL,this.Nt(),this.c=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.Nt()})}Nt(){let e=vscode.workspace.getConfiguration("explorerDates");this.ct=e.get("enableLogging",!1);let t=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase();this.zt=LOG_LEVEL_ORDER.includes(t)?t:DEFAULT_CONSOLE_LEVEL}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.ge=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.pe.delete(e);return}this.pe.clear()}debug(e,...t){this.ct&&this._e("debug",null,e,t)}info(e,...t){this._e("info",null,e,t)}infoWithOptions(e,t,...s){this._e("info",e||null,t,s)}warn(e,...t){this._e("warn",null,e,t)}error(e,t,...s){let r=`[${new Date().toISOString()}] [ERROR] ${e}`;this.C.appendLine(r),t instanceof Error?(this.C.appendLine(`Error: ${t.message}`),t.stack&&this.C.appendLine(`Stack: ${t.stack}`)):t&&this.C.appendLine(this.lt(t));let n=this.Ut(s);n.length>0&&n.forEach(a=>this.C.appendLine(this.lt(a))),this.ht("error",r,[t,...n])}show(){this.C.show()}clear(){this.C.clear()}dispose(){this.C.dispose(),this.c&&(this.c.dispose(),this.c=null),loggerInstance===this&&(loggerInstance=null)}_e(e,t,s,i){if(e==="debug"&&!this.ct||this.Ls(e,t))return;let n=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${s}`;this.C.appendLine(n);let a=this.Ut(i);a.length>0&&a.forEach(c=>this.C.appendLine(this.lt(c))),this.ht(e,n,a)}Ut(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(s){return`<<log arg threw: ${s.message}>>`}})}lt(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}Ls(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let s=(t.profile||"stress").toLowerCase();if(!this.Ws(s))return!1;let i=Number(t.throttleLimit)||50,r=t.throttleKey,n=this.pe.get(r)||{count:0,suppressed:0,noticeLogged:!1};if(n.count<i)return n.count+=1,this.pe.set(r,n),!1;if(n.suppressed+=1,!n.noticeLogged){n.noticeLogged=!0;let a=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${r}" after ${i} entries (profile=${this.ge})`;this.C.appendLine(a),this.ht("info",a)}return this.pe.set(r,n),!0}Ws(e){let t=this.ge||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}zs(e){let t=LOG_LEVEL_ORDER.indexOf(this.zt),s=LOG_LEVEL_ORDER.indexOf(e);return t===-1||s===-1?!1:s>=t}ht(e,t,s=[]){if(!this.zs(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...s)}},loggerInstance=null;function getLogger(){return loggerInstance||(loggerInstance=new Logger),loggerInstance}module.exports={Logger,getLogger}});var Re=E((pi,tt)=>{var $e=require("vscode"),pe={en:{now:"now",minutes:"m",hours:"h",days:"d",weeks:"w",months:"mo",years:"y",justNow:"just now",minutesAgo:o=>`${o} minute${o!==1?"s":""} ago`,hoursAgo:o=>`${o} hour${o!==1?"s":""} ago`,yesterday:"yesterday",daysAgo:o=>`${o} day${o!==1?"s":""} ago`,lastModified:"Last modified",refreshSuccess:"Date decorations refreshed",activationError:"Explorer Dates failed to activate",errorAccessingFile:"Error accessing file for decoration"},es:{now:"ahora",minutes:"m",hours:"h",days:"d",weeks:"s",months:"m",years:"a",justNow:"ahora mismo",minutesAgo:o=>`hace ${o} minuto${o!==1?"s":""}`,hoursAgo:o=>`hace ${o} hora${o!==1?"s":""}`,yesterday:"ayer",daysAgo:o=>`hace ${o} d\xEDa${o!==1?"s":""}`,lastModified:"\xDAltima modificaci\xF3n",refreshSuccess:"Decoraciones de fecha actualizadas",activationError:"Explorer Dates no se pudo activar",errorAccessingFile:"Error al acceder al archivo para decoraci\xF3n"},fr:{now:"maintenant",minutes:"m",hours:"h",days:"j",weeks:"s",months:"m",years:"a",justNow:"\xE0 l'instant",minutesAgo:o=>`il y a ${o} minute${o!==1?"s":""}`,hoursAgo:o=>`il y a ${o} heure${o!==1?"s":""}`,yesterday:"hier",daysAgo:o=>`il y a ${o} jour${o!==1?"s":""}`,lastModified:"Derni\xE8re modification",refreshSuccess:"D\xE9corations de date actualis\xE9es",activationError:"\xC9chec de l'activation d'Explorer Dates",errorAccessingFile:"Erreur lors de l'acc\xE8s au fichier pour la d\xE9coration"},de:{now:"jetzt",minutes:"Min",hours:"Std",days:"T",weeks:"W",months:"Mon",years:"J",justNow:"gerade eben",minutesAgo:o=>`vor ${o} Minute${o!==1?"n":""}`,hoursAgo:o=>`vor ${o} Stunde${o!==1?"n":""}`,yesterday:"gestern",daysAgo:o=>`vor ${o} Tag${o!==1?"en":""}`,lastModified:"Zuletzt ge\xE4ndert",refreshSuccess:"Datumsdekorationen aktualisiert",activationError:"Explorer Dates konnte nicht aktiviert werden",errorAccessingFile:"Fehler beim Zugriff auf Datei f\xFCr Dekoration"},ja:{now:"\u4ECA",minutes:"\u5206",hours:"\u6642\u9593",days:"\u65E5",weeks:"\u9031",months:"\u30F6\u6708",years:"\u5E74",justNow:"\u305F\u3063\u305F\u4ECA",minutesAgo:o=>`${o}\u5206\u524D`,hoursAgo:o=>`${o}\u6642\u9593\u524D`,yesterday:"\u6628\u65E5",daysAgo:o=>`${o}\u65E5\u524D`,lastModified:"\u6700\u7D42\u66F4\u65B0",refreshSuccess:"\u65E5\u4ED8\u88C5\u98FE\u304C\u66F4\u65B0\u3055\u308C\u307E\u3057\u305F",activationError:"Explorer Dates\u306E\u30A2\u30AF\u30C6\u30A3\u30D9\u30FC\u30B7\u30E7\u30F3\u306B\u5931\u6557\u3057\u307E\u3057\u305F",errorAccessingFile:"\u30D5\u30A1\u30A4\u30EB\u30A2\u30AF\u30BB\u30B9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F"},zh:{now:"\u73B0\u5728",minutes:"\u5206\u949F",hours:"\u5C0F\u65F6",days:"\u5929",weeks:"\u5468",months:"\u6708",years:"\u5E74",justNow:"\u521A\u521A",minutesAgo:o=>`${o}\u5206\u949F\u524D`,hoursAgo:o=>`${o}\u5C0F\u65F6\u524D`,yesterday:"\u6628\u5929",daysAgo:o=>`${o}\u5929\u524D`,lastModified:"\u6700\u540E\u4FEE\u6539",refreshSuccess:"\u65E5\u671F\u88C5\u9970\u5DF2\u5237\u65B0",activationError:"Explorer Dates \u6FC0\u6D3B\u5931\u8D25",errorAccessingFile:"\u8BBF\u95EE\u6587\u4EF6\u88C5\u9970\u65F6\u51FA\u9519"}},me=class{constructor(){this.Le="en",this.c=null,this.Bt(),this.c=$e.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorerDates.locale")&&this.Bt()})}Bt(){let t=$e.workspace.getConfiguration("explorerDates").get("locale","auto");t==="auto"&&(t=$e.env.language.split("-")[0]),pe[t]||(t="en"),this.Le=t}getString(e,...t){let i=(pe[this.Le]||pe.en)[e];return typeof i=="function"?i(...t):i||pe.en[e]||e}getCurrentLocale(){return this.Le}formatDate(e,t={}){try{return e.toLocaleDateString(this.Le,t)}catch{return e.toLocaleDateString("en",t)}}dispose(){this.c&&(this.c.dispose(),this.c=null),re===this&&(re=null)}},re=null;function Xt(){return re||(re=new me),re}tt.exports={LocalizationManager:me,getLocalization:Xt}});var Pe=E((mi,it)=>{var st=require("vscode");function Yt(){try{return st?.env?.uiKind===st?.UIKind?.Web}catch{return!1}}it.exports={isWebEnvironment:Yt}});var we=E((wi,ot)=>{function q(o=""){return o?o.replace(/\\/g,"/"):""}function Qt(o=""){let e=q(o);return e?e.split("/").filter(Boolean):[]}function rt(o=""){let e=Qt(o);return e.length?e[e.length-1]:""}function Zt(o=""){let e=rt(o),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function es(o=""){let e=q(o),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function ts(...o){return q(o.filter(Boolean).join("/")).replace(/\/+/g,"/")}function ss(o=""){return q(o).toLowerCase()}function is(o=""){if(!o)return"";if(typeof o=="string")return o;if(typeof o.fsPath=="string"&&o.fsPath.length>0)return o.fsPath;if(typeof o.path=="string"&&o.path.length>0)return o.path;if(typeof o.toString=="function")try{return o.toString(!0)}catch{return o.toString()}return String(o)}function rs(o="",e=""){let t=q(o),s=q(e);return t&&s.startsWith(t)?s.substring(t.length).replace(/^\/+/,""):s}ot.exports={normalizePath:q,getFileName:rt,getExtension:Zt,getDirectory:es,joinPath:ts,getCacheKey:ss,getUriPath:is,getRelativePath:rs}});var Oe=E((bi,nt)=>{var Ie=class extends Error{constructor(e,t,s={}){super(t),this.code=e,this.context=s,this.name="ExtensionError"}},os={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function ns(o){if(!o)return!1;let e=o.code||o?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}nt.exports={ExtensionError:Ie,ERROR_CODES:os,isPermissionError:ns}});var oe=E((yi,lt)=>{function at(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function ct(o){return!!(o&&typeof o=="object"&&typeof o.getTime=="function")}function Q(o){if(!o||isNaN(o))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(o)}catch{}let e=864e5,t=36e5,s=6e4,i=1e3,r=1970,n=4,a=Math.floor(o/e),c=o%e,l=Math.floor(c/t),h=Math.floor(c%t/s),d=Math.floor(c%s/i),m=r+Math.floor(a/365.25),b=Math.floor(a%365.25/30.44)+1,y=Math.floor(a%30.44)+1,W=String(Math.min(b,12)).padStart(2,"0"),M=String(Math.min(y,31)).padStart(2,"0"),Z=String(l).padStart(2,"0"),he=String(h).padStart(2,"0"),j=String(d).padStart(2,"0");return`${W}/${M}/${m}, ${Z}:${he}:${j}`}function as(o){if(ct(o))return o;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(o==null){if(!e){let t=at();return{getTime:()=>t,toLocaleString:()=>Q(t),toString:()=>Q(t)}}return new Date}if(typeof o=="number")return e?new Date(o):{getTime:()=>o,toLocaleString:()=>Q(o),toString:()=>Q(o)};if(typeof o=="string"){let t=0;if(e)t=Date.parse(o);else{let s=parseFloat(o);t=isNaN(s)?0:s}return e?new Date(o):{getTime:()=>t,toLocaleString:()=>Q(t),toString:()=>Q(t)}}return e?new Date(o):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}lt.exports={ensureDate:as,isDateLike:ct,getCurrentTimestamp:at}});var ne=E((Ci,ut)=>{var x=require("vscode"),{isWebEnvironment:cs}=Pe(),{normalizePath:ls}=we(),{ExtensionError:hs,ERROR_CODES:us,isPermissionError:ds}=Oe(),{ensureDate:_e}=oe(),ht=!0,gs=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",S=null;if(!ht&&!gs)try{S=require("fs").promises}catch{S=null}var be=class{constructor(){this.isWeb=ht||cs()}R(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}P(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return x.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.P(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return x.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return x.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return x.Uri.parse(e.href);if(typeof e.scheme=="string")return x.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return x.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return x.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&S)return S.stat(this.R(e));let t=this.P(e),s=await x.workspace.fs.stat(t);return{...s,mtime:_e(s.mtime),ctime:_e(s.ctime),birthtime:_e(s.ctime),isFile:()=>s.type===x.FileType.File,isDirectory:()=>s.type===x.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&S)return S.readFile(this.R(e),t);let s=this.P(e),i=await x.workspace.fs.readFile(s);return t===null||t==="binary"?i:new TextDecoder(t).decode(i)}async writeFile(e,t,s="utf8"){let i=this.R(e);try{if(!this.isWeb&&S)return S.writeFile(i,t,s);let r=this.P(e),n=typeof t=="string"?new TextEncoder().encode(t):t;await x.workspace.fs.writeFile(r,n)}catch(r){this.jt("write file",i,r)}}async mkdir(e,t={recursive:!0}){let s=this.R(e);try{if(!this.isWeb&&S)return S.mkdir(s,t);let i=this.P(e);await x.workspace.fs.createDirectory(i)}catch(i){this.jt("create directory",s,i)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&S)return S.readdir(this.R(e),t);let s=this.P(e),i=await x.workspace.fs.readDirectory(s);return t.withFileTypes?i.map(([r,n])=>({name:r,isDirectory:()=>n===x.FileType.Directory,isFile:()=>n===x.FileType.File})):i.map(([r])=>r)}async delete(e,t={recursive:!1}){if(!this.isWeb&&S){let i=this.R(e);return t.recursive?S.rm?S.rm(i,t):S.rmdir(i,t):S.unlink(i)}let s=this.P(e);await x.workspace.fs.delete(s,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=ls(this.R(e));await this.mkdir(t,{recursive:!0})}jt(e,t,s){throw ds(s)?new hs(us.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:s.code}):s}},ps=new be;ut.exports={FileSystemAdapter:be,fileSystem:ps}});var Le=E((Ei,dt)=>{var ms=["Ja","Fe","Mr","Ap","My","Jn","Jl","Au","Se","Oc","No","De"],ws={ADVANCED_CACHE:"explorerDates.advancedCache",ADVANCED_CACHE_METADATA:"explorerDates.advancedCacheMetadata",TEMPLATE_STORE:"explorerDates.templates",WEB_GIT_NOTICE:"explorerDates.webGitNotice"};dt.exports={DEFAULT_CACHE_TIMEOUT:12e4,DEFAULT_MAX_CACHE_SIZE:1e4,DEFAULT_PERSISTENT_CACHE_TTL:864e5,MAX_BADGE_LENGTH:2,MONTH_ABBREVIATIONS:ms,GLOBAL_STATE_KEYS:ws}});var pt=E((vi,gt)=>{var{MAX_BADGE_LENGTH:ft}=Le();function bs(o=0,e="auto"){let t=typeof o=="number"&&!Number.isNaN(o)?o:0;if(e==="bytes")return`~${t}B`;let s=t/1024;if(e==="kb")return`~${s.toFixed(1)}K`;let i=s/1024;return e==="mb"?`~${i.toFixed(1)}M`:t<1024?`~${t}B`:s<1024?`~${Math.round(s)}K`:`~${i.toFixed(1)}M`}function ys(o){if(o)return o.length>ft?o.substring(0,ft):o}gt.exports={formatFileSize:bs,trimBadge:ys}});var ae=E((ki,mt)=>{var C={onboarding:34,analysisCommands:23,exportReporting:17,extensionApi:15,workspaceTemplates:14,advancedCache:28,workspaceIntelligence:31,incrementalWorkers:19},K=99,G={minimal:{id:"minimal",name:"Minimal",description:"Core decorations only, smallest bundle (~99KB)",targetBundleSize:K,settings:{"explorerDates.enableOnboardingSystem":!1,"explorerDates.enableAnalysisCommands":!1,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!1,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.showDateDecorations":!0,"explorerDates.dateDecorationFormat":"relative-short"},targetScenarios:["Resource-constrained environments","Basic file dates only","Large remote workspaces"]},balanced:{id:"balanced",name:"Balanced",description:"Essential features with optimization (~200KB)",targetBundleSize:K+C.onboarding+C.workspaceTemplates+C.advancedCache+C.analysisCommands,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.performanceMode":!0,"explorerDates.smartFileWatching":!0},targetScenarios:["Most development workflows","Remote environments","Medium to large workspaces"]},"web-development":{id:"web-development",name:"Web Development",description:"Optimized for web projects (~240KB)",targetBundleSize:K+C.onboarding+C.analysisCommands+C.workspaceTemplates+C.advancedCache+C.incrementalWorkers,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.showGitInfo":"author","explorerDates.colorScheme":"file-type"},targetScenarios:["JavaScript/TypeScript projects","Node.js development","Frontend frameworks"]},enterprise:{id:"enterprise",name:"Enterprise",description:"Full feature set with reporting and API (~380KB)",targetBundleSize:Object.values(C).reduce((o,e)=>o+e,K),settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!0,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.persistentCache":!0,"explorerDates.smartExclusions":!0},targetScenarios:["Team lead workflows","Analytics and reporting needs","API integration requirements","Full workspace intelligence"]},"data-science":{id:"data-science",name:"Data Science",description:"Optimized for data workflows (~280KB)",targetBundleSize:K+C.onboarding+C.analysisCommands+C.exportReporting+C.workspaceIntelligence+C.advancedCache,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.dateDecorationFormat":"iso-detailed"},targetScenarios:["Jupyter notebooks","Python data analysis","Research workflows"]}},Cs=new Set(["enableOnboardingSystem","enableAnalysisCommands","enableExportReporting","enableExtensionApi","enableWorkspaceTemplates","enableAdvancedCache","enableWorkspaceIntelligence","enableIncrementalWorkers","performanceMode","smartFileWatching"]);function Es(o){let e=K;return o["explorerDates.enableOnboardingSystem"]&&(e+=C.onboarding),o["explorerDates.enableAnalysisCommands"]&&(e+=C.analysisCommands),o["explorerDates.enableExportReporting"]&&(e+=C.exportReporting),o["explorerDates.enableExtensionApi"]&&(e+=C.extensionApi),o["explorerDates.enableWorkspaceTemplates"]&&(e+=C.workspaceTemplates),o["explorerDates.enableAdvancedCache"]&&(e+=C.advancedCache),o["explorerDates.enableWorkspaceIntelligence"]&&(e+=C.workspaceIntelligence),o["explorerDates.enableIncrementalWorkers"]&&(e+=C.incrementalWorkers),e}function vs(o){switch(o){case"minimal":case"extreme":return G.minimal;case"balanced":return G.balanced;case"web-development":return G["web-development"];case"data-science":return G["data-science"];case"enterprise":return G.enterprise;default:return G.balanced}}mt.exports={PRESET_DEFINITIONS:G,CHUNK_SIZES:C,BASE_BUNDLE_SIZE:K,RESTART_REQUIRED_SETTINGS:Cs,calculateBundleSize:Es,getDefaultPresetForProfile:vs}});var We=E((Di,wt)=>{var ye={onboarding:"src/chunks/onboarding-chunk",onboardingAssets:"src/chunks/onboarding-assets-chunk",reporting:"src/chunks/reporting-chunk",templates:"src/chunks/templates-chunk",analysis:"src/chunks/analysis-chunk",diagnostics:"src/chunks/diagnostics-chunk",extensionApi:"src/chunks/extension-api-chunk",advancedCache:"src/chunks/advancedCache-chunk",batchProcessor:"src/chunks/batchProcessor-chunk",workspaceIntelligence:"src/chunks/workspaceIntelligence",incrementalWorkers:"src/chunks/incrementalWorkers",uiAdapters:"src/chunks/ui-adapters",gitInsights:"src/chunks/gitInsights-chunk",smartWatcherFallback:"src/chunks/smartWatcherFallback-chunk"};function ks(o){return ye[o]||null}function Ds(){return Object.keys(ye)}function xs(o){let e={};for(let[t,s]of Object.entries(ye))e[t]=()=>o(`./${s}`);return e}wt.exports={CHUNK_MAP:ye,getChunkSourcePath:ks,getAllChunkNames:Ds,generateDevLoaderMap:xs}});var H=E((exports,module)=>{var{getLogger}=N(),{CHUNK_SIZES}=ae(),{getChunkSourcePath,getAllChunkNames}=We(),featureLogger=null,DEFAULT_CHUNK_TIMEOUT_MS=Number(process.env.EXPLORER_DATES_CHUNK_TIMEOUT||5e3),NETWORK_ERROR_CODES=new Set(["ENOTFOUND","ECONNRESET","ECONNREFUSED","EAI_AGAIN","ETIMEDOUT","EHOSTUNREACH"]),BUILT_CHUNK_CACHE=new Map,CHUNK_METHOD_ALIASES={reporting:"exportReporting",templates:"workspaceTemplates",analysis:"analysisCommands"},DEV_CHUNK_PATH_CACHE=new Map;function getDevChunkImportPath(o){if(DEV_CHUNK_PATH_CACHE.has(o))return DEV_CHUNK_PATH_CACHE.get(o);let e=getChunkSourcePath(o);if(!e)return DEV_CHUNK_PATH_CACHE.set(o,null),null;let t=e;return t.startsWith("src/")&&(t=t.slice(4)),t.startsWith("./")||(t=`./${t}`),DEV_CHUNK_PATH_CACHE.set(o,t),t}function resolveNodeDependencies(){if(nativeDepsResolved)return!!(nativePath&&nativeFs);if(nativeDepsResolved=!0,!isNodeLikeRuntime())return!1;try{nativePath=eval("require")("path"),nativeFs=eval("require")("fs")}catch{nativePath=null,nativeFs=null}return!!(nativePath&&nativeFs)}var nativeDepsResolved=!1,nativePath=null,nativeFs=null;function isWebRuntime(){try{return typeof navigator<"u"&&navigator?.userAgent?navigator.userAgent.includes("vscode-web")||navigator.userAgent.includes("Code - Web"):typeof process<"u"&&!0}catch{return!1}}function isNodeLikeRuntime(){return typeof process<"u"&&!!process.versions?.node&&!isWebRuntime()}function getChunkTimeoutMs(){return DEFAULT_CHUNK_TIMEOUT_MS>0?DEFAULT_CHUNK_TIMEOUT_MS:0}function logFeature(o,e,t){featureLogger||(featureLogger=getLogger());let s=featureLogger;typeof s[o]=="function"?s[o](e,t):s.info(e,t)}function logFeatureDisabled(o,e){logFeature("info","Feature disabled via configuration",{feature:o,savedKB:e&&CHUNK_SIZES[e]!==void 0?CHUNK_SIZES[e]:void 0})}function isLikelyNetworkIssue(o){if(!o)return!1;if(o.code&&NETWORK_ERROR_CODES.has(o.code))return!0;let e=(o.message||"").toLowerCase();return e.includes("network")||e.includes("fetch")||e.includes("timed out")}function runWithChunkTimeout(o,e){let t=getChunkTimeoutMs(),s=()=>{try{return Promise.resolve(o())}catch(i){return Promise.reject(i)}};return t?new Promise((i,r)=>{let n=!1,a=setTimeout(()=>{if(n)return;n=!0;let c=new Error(`Chunk "${e}" load timed out after ${t}ms`);c.code="CHUNK_TIMEOUT",r(c)},t);s().then(c=>{n||(n=!0,clearTimeout(a),i(c))}).catch(c=>{n||(n=!0,clearTimeout(a),r(c))})}):s()}function logResolverFailure(o,e){if(!e)return;let t={chunkName:o,error:e.message,code:e.code,networkIssue:isLikelyNetworkIssue(e),timedOut:e.code==="CHUNK_TIMEOUT"},s=t.networkIssue||t.timedOut?"warn":"error";logFeature(s,"Chunk resolver failed",t)}function tryLoadBuiltChunk(o){if(!o||!resolveNodeDependencies()||typeof nativeFs?.existsSync!="function")return null;if(BUILT_CHUNK_CACHE.has(o))return BUILT_CHUNK_CACHE.get(o);let e=[];typeof __dirname=="string"&&nativePath&&(e.push(nativePath.join(__dirname,"chunks",`${o}.js`)),e.push(nativePath.join(__dirname,"..","dist","chunks",`${o}.js`)));for(let t of e)try{if(!t||!nativeFs.existsSync(t))continue;let s=require(t),i=s?.default||s;return BUILT_CHUNK_CACHE.set(o,i||null),i&&logFeature("info","Loaded chunk via built artifact fallback",{chunkName:o,path:t}),i}catch(s){logFeature("warn","Built chunk fallback failed",{chunkName:o,path:t,error:s.message})}return BUILT_CHUNK_CACHE.set(o,null),null}function tryRequireDevChunk(o){if(isWebRuntime())return null;let e=getDevChunkImportPath(o);if(!e)return null;try{let t=require(e);return t?.default||t}catch(t){(t.code!=="MODULE_NOT_FOUND"||typeof t.message=="string"&&!t.message.includes(e))&&logFeature("debug","Dev chunk require failed",{chunkName:o,importPath:e,error:t.message})}return null}function tryRequireLocalBuiltChunk(o){if(isWebRuntime())return null;let e=`./chunks/${o}`;try{let t=require(e);return t?.default||t}catch(t){t.code==="MODULE_NOT_FOUND"||logFeature("debug","Local chunk require failed",{chunkName:o,importPath:e,error:t.message})}return null}function getSavingsKey(o){return o in CHUNK_SIZES?o:CHUNK_METHOD_ALIASES[o]||null}function announceChunkSavings(o){let e=getSavingsKey(o);if(!e)return;let t=CHUNK_SIZES[e];if(!t)return;let i=`\u{1F4BE} ${e===o||!o?e:`${e} (requested as "${o}")`} chunk unavailable - keeping the feature disabled is saving ~${t}KB`;logFeature("info","Chunk savings applied",{chunkName:e,requestedName:o,savedKB:t})}var getFeatureConfig=()=>{try{let e=require("vscode").workspace.getConfiguration("explorerDates");return{enableOnboarding:e.get("enableOnboardingSystem",!0),enableExportReporting:e.get("enableExportReporting",!0),enableWorkspaceTemplates:e.get("enableWorkspaceTemplates",!0),enableAnalysisCommands:e.get("enableAnalysisCommands",!0),enableAdvancedCache:e.get("enableAdvancedCache",!0),enableWorkspaceIntelligence:e.get("enableWorkspaceIntelligence",!0),enableIncrementalWorkers:e.get("enableIncrementalWorkers",!1),enableExtensionApi:e.get("enableExtensionApi",!0)}}catch{return{enableOnboarding:!0,enableExportReporting:!0,enableWorkspaceTemplates:!0,enableAnalysisCommands:!0,enableAdvancedCache:!0,enableWorkspaceIntelligence:!0,enableIncrementalWorkers:!1,enableExtensionApi:!0}}},featureLoaders=new Map,chunkResolver=null;function setFeatureChunkResolver(o){if(o&&typeof o!="function")throw new Error("Feature chunk resolver must be a function");chunkResolver=o||null}function registerFeatureLoader(o,e){if(typeof e!="function")throw new Error(`Feature loader for "${o}" must be a function`);featureLoaders.set(o,e)}function unregisterFeatureLoader(o){featureLoaders.delete(o)}function clearFeatureLoaders(){featureLoaders.clear()}async function loadFeatureModule(o){let e=featureLoaders.get(o);if(!e&&chunkResolver&&(e=()=>chunkResolver(o)),!e)return logFeature("warn","No loader registered for feature",{feature:o}),null;try{return await runWithChunkTimeout(()=>e(),o)}catch(t){return logFeature("warn","Feature loader failed",{feature:o,error:t.message,code:t.code,networkIssue:isLikelyNetworkIssue(t)}),announceChunkSavings(o),null}}function registerDefaultLoaders(){getAllChunkNames().forEach(e=>{featureLoaders.has(e)||registerFeatureLoader(e,createDefaultLoader(e))})}function createDefaultLoader(o){return async()=>{if(chunkResolver&&typeof chunkResolver=="function")try{let i=await runWithChunkTimeout(()=>chunkResolver(o),o);if(i)return i;logFeature("info","Chunk resolver returned no module",{chunkName:o})}catch(i){logResolverFailure(o,i)}let e=tryRequireDevChunk(o);if(e)return e;let t=tryRequireLocalBuiltChunk(o);if(t)return t;let s=tryLoadBuiltChunk(o);return s||(logFeature("warn","No built artifact available for chunk",{chunkName:o}),null)}}var featureFlags={async onboarding(){return getFeatureConfig().enableOnboarding?loadFeatureModule("onboarding"):(logFeatureDisabled("onboarding","onboarding"),null)},async exportReporting(){return getFeatureConfig().enableExportReporting?loadFeatureModule("reporting"):(logFeatureDisabled("exportReporting","exportReporting"),null)},async workspaceTemplates(){return getFeatureConfig().enableWorkspaceTemplates?loadFeatureModule("templates"):(logFeatureDisabled("workspaceTemplates","workspaceTemplates"),null)},async analysisCommands(){return getFeatureConfig().enableAnalysisCommands?loadFeatureModule("analysis"):(logFeatureDisabled("analysisCommands","analysisCommands"),null)},async advancedCache(){return getFeatureConfig().enableAdvancedCache?loadFeatureModule("advancedCache"):(logFeatureDisabled("advancedCache","advancedCache"),null)},async workspaceIntelligence(){return getFeatureConfig().enableWorkspaceIntelligence?loadFeatureModule("workspaceIntelligence"):(logFeatureDisabled("workspaceIntelligence","workspaceIntelligence"),null)},async incrementalWorkers(){return getFeatureConfig().enableIncrementalWorkers?loadFeatureModule("incrementalWorkers"):(logFeatureDisabled("incrementalWorkers","incrementalWorkers"),null)},async extensionApi(){return getFeatureConfig().enableExtensionApi?loadFeatureModule("extensionApi"):(logFeatureDisabled("extensionApi","extensionApi"),null)},async uiAdapters(){return loadFeatureModule("uiAdapters")},async batchProcessor(){return loadFeatureModule("batchProcessor")},async gitInsights(){return loadFeatureModule("gitInsights")},isEnabled(o){let e=getFeatureConfig();return{onboarding:e.enableOnboarding,exportReporting:e.enableExportReporting,workspaceTemplates:e.enableWorkspaceTemplates,analysisCommands:e.enableAnalysisCommands,advancedCache:e.enableAdvancedCache,workspaceIntelligence:e.enableWorkspaceIntelligence,incrementalWorkers:e.enableIncrementalWorkers,extensionApi:e.enableExtensionApi}[o]??!0},getEnabledFeatures(){let o=getFeatureConfig(),e=[];return o.enableOnboarding&&e.push("onboarding"),o.enableExportReporting&&e.push("exportReporting"),o.enableWorkspaceTemplates&&e.push("workspaceTemplates"),o.enableAnalysisCommands&&e.push("analysisCommands"),o.enableAdvancedCache&&e.push("advancedCache"),o.enableWorkspaceIntelligence&&e.push("workspaceIntelligence"),o.enableIncrementalWorkers&&e.push("incrementalWorkers"),o.enableExtensionApi&&e.push("extensionApi"),e},calculateSavings(){let o=getFeatureConfig(),e=0;return o.enableOnboarding||(e+=34),o.enableExportReporting||(e+=17),o.enableExtensionApi||(e+=15),o.enableWorkspaceTemplates||(e+=14),o.enableWorkspaceIntelligence||(e+=12),o.enableAnalysisCommands||(e+=8),o.enableAdvancedCache||(e+=5),e}};for(let[o,e]of Object.entries(CHUNK_METHOD_ALIASES))!featureFlags[o]&&typeof featureFlags[e]=="function"&&(featureFlags[o]=(...t)=>featureFlags[e](...t));function calculateSavings(o){o||(o=getFeatureConfig());let e=267,t=0;o.enableOnboarding||(t+=34),o.enableExportReporting||(t+=17),o.enableExtensionApi||(t+=15),o.enableWorkspaceTemplates||(t+=14),o.enableWorkspaceIntelligence||(t+=12),o.enableIncrementalWorkers||(t+=19),o.enableAnalysisCommands||(t+=8),o.enableAdvancedCache||(t+=5);let s=e-t,i=t>0?Math.round(t/e*100):0;return{baseSize:`${e}KB`,totalSavings:`${t}KB`,optimizedSize:`${s}KB`,percentage:i}}registerDefaultLoaders();module.exports={...featureFlags,getFeatureConfig,calculateSavings,registerFeatureLoader,setFeatureChunkResolver,unregisterFeatureLoader,clearFeatureLoaders,loadFeatureModule,registerDefaultLoaders}});var Ft=E((xi,St)=>{var u=require("vscode"),{getLogger:Ss}=N(),{getLocalization:Fs}=Re(),{fileSystem:Ts}=ne(),{formatFileSize:Ms,trimBadge:bt}=pt(),{getFileName:Ue,getExtension:Ce,getCacheKey:As,normalizePath:L,getUriPath:_}=we(),{DEFAULT_CACHE_TIMEOUT:yt,DEFAULT_MAX_CACHE_SIZE:$s,MONTH_ABBREVIATIONS:Rs,GLOBAL_STATE_KEYS:Ps}=Le(),{isWebEnvironment:Be}=Pe(),{ensureDate:Ct}=oe(),J=null;try{Be()||(J=require("path"))}catch{J=null}var Ee={basename:o=>{if(J)return J.basename(o);let e=o.replace(/\\/g,"/"),t=e.lastIndexOf("/");return t===-1?e:e.substring(t+1)},dirname:o=>{if(J)return J.dirname(o);let e=o.replace(/\\/g,"/"),t=e.lastIndexOf("/");return t===-1?".":e.substring(0,t)}},ve=3e4,ze="::",Et=Number(process.env.EXPLORER_DATES_MAX_DYNAMIC_WATCHERS||200),vt=Number(process.env.EXPLORER_DATES_WATCHER_TTL_MS||600*1e3),kt=["ts","tsx","js","jsx","mjs","cjs","mts","cts","vue","py","go","rb","rs","java","kt","swift","cs","cpp","c","php","scala","sql","md","mdx","json","jsonc","yml","yaml","toml","ini","txt","html","css","scss"],Is=new Map([["src",100],["app",95],["apps",95],["packages",90],["services",85],["service",80],["client",75],["clients",70],["server",70],["servers",65],["lib",65],["libs",60],["api",60],["apis",60],["components",55],["modules",55],["feature",50],["features",50],["extensions",45],["scripts",45],["tools",45],["examples",40],["docs",35],["config",35],["test",30],["tests",30],["spec",30],["specs",30],["demo",25],["demos",25]]),ke=Number(process.env.EXPLORER_DATES_WORKSPACE_SCAN_TIMEOUT||7e3),Os=5e4,De="__root__",Dt=300*1e3,_s=600*1e3,xt=900*1e3,Ls=Number(process.env.EXPLORER_DATES_VIEWPORT_HISTORY_LIMIT||400),Ne=["full","enhanced","standard","minimal"],Ws=Math.max(100,Number(process.env.EXPLORER_DATES_INDEXER_MAX_FILES||2e3)),I=(o="")=>{let e=typeof o=="string"?o:_(o),t=L(e);return Ue(t)||t||"unknown"},je=class{constructor(){this.d=new Map,this.x=new Map,this.m=0}get size(){return this.m}get bucketCount(){return this.d.size}clear(){this.d.clear(),this.x.clear(),this.m=0}get(e){if(!e)return;let t=this.x.get(e);if(!t)return;let s=this.d.get(t);if(!s){this.x.delete(e);return}return s.lastAccess=Date.now(),s.entries.get(e)}set(e,t,s={}){if(!e)return;let i=s.folderKey||this.Ns(e),r=this.Us(i),n=r.entries.has(e);r.entries.set(e,t),r.lastAccess=Date.now(),n||this.m++,this.x.set(e,i)}delete(e){if(!e)return!1;let t=this.x.get(e);if(!t)return!1;let s=this.d.get(t);if(!s)return this.x.delete(e),!1;let i=s.entries.delete(e);return i&&(this.m=Math.max(0,this.m-1),s.entries.size===0&&this.d.delete(t)),this.x.delete(e),i}*entries(){for(let e of this.d.values())yield*e.entries.entries()}*keys(){for(let e of this.d.values())yield*e.entries.keys()}*values(){for(let e of this.d.values())yield*e.entries.values()}[Symbol.iterator](){return this.entries()}enforceLimit(e=0,t){if(!e||this.m<=e)return 0;let s=Math.max(Math.floor(e*.2),this.m-e,1),i=0,r=Array.from(this.d.entries()).map(([n,a])=>({folderKey:n,bucket:a}));r.sort((n,a)=>(n.bucket.lastAccess||0)-(a.bucket.lastAccess||0));for(let{folderKey:n,bucket:a}of r){if(i>=s)break;if(!a.entries.size){this.d.delete(n);continue}let c=a.entries.size,l=s-i;if(c<=l){i+=this.Bs(n,a);continue}let h=Array.from(a.entries.entries());h.sort((m,b)=>(m[1].timestamp||0)-(b[1].timestamp||0));let d=Math.min(l,Math.max(1,Math.ceil(c*.5)));for(let m=0;m<d&&m<h.length;m++){let[b]=h[m];a.entries.delete(b),this.x.delete(b),i++,this.m=Math.max(0,this.m-1)}a.entries.size?a.lastAccess=Date.now():this.d.delete(n)}return i>0&&t&&t.debug(`Hierarchical cache eviction removed ${i} entries (${this.m} remaining)`),i}Us(e){return this.d.has(e)||this.d.set(e,{entries:new Map,lastAccess:Date.now()}),this.d.get(e)}Bs(e,t){if(!t)return 0;let s=t.entries.size;for(let i of t.entries.keys())this.x.delete(i);return this.d.delete(e),this.m=Math.max(0,this.m-s),s}Ns(e){if(!e||typeof e!="string")return De;let t=L(e);if(!t)return De;let s=t.lastIndexOf("/");return s===-1?De:t.slice(0,s)||De}},zs=!0,Ve=class{constructor(){this.E=new u.EventEmitter,this.onDidChangeFileDecorations=this.E.event,this.r=new je,this.me=new Map,this.js=new Map,this.I=20,this.F=0,this.ut=!1,this.Vt=!1,this.O=new Map,this.We=[],this.f={hits:0,misses:0,allocations:0,reuses:0},this.Vs=512,this.ze=new Map,this.Ht=[],this.Hs=2048,this.G={hits:0,misses:0,allocations:0,reuses:0},this.Ne=new Map,this.qt=[],this.qs=2048,this.K={hits:0,misses:0,allocations:0,reuses:0},this.Ue=process.env.EXPLORER_DATES_ENABLE_DECORATION_POOL!=="0",this.Be=process.env.EXPLORER_DATES_ENABLE_FLYWEIGHTS!=="0",this._=process.env.EXPLORER_DATES_LIGHTWEIGHT_MODE==="1",this.je=process.env.EXPLORER_DATES_MEMORY_SHEDDING==="1",this.Ve=Number(process.env.EXPLORER_DATES_MEMORY_SHED_THRESHOLD_MB||3),this.He=!1,this.we=this.je?this.Gt():0,this.Gs=Number(process.env.EXPLORER_DATES_MEMORY_SHED_CACHE_LIMIT||1e3),this.Kt=Number(process.env.EXPLORER_DATES_MEMORY_SHED_REFRESH_MS||6e4),this.qe=null,this.Ge=process.env.EXPLORER_DATES_FORCE_CACHE_BYPASS==="1",this.Jt=Number(process.env.EXPLORER_DATES_LIGHTWEIGHT_PURGE_INTERVAL||400),this.Ke=zs||Be(),this.dt=yt*4,this.Xt=this.dt,this.ft=0,this.a=$s,this.be=Ts,this.gt=!this.Ke,this.Yt=!1,this.l=null,this.ye=null,this.Qt=process.env.EXPLORER_DATES_TELEMETRY==="1",this.Zt=Number(process.env.EXPLORER_DATES_TELEMETRY_INTERVAL_MS||6e4),this.J=null,this.X=null,this.ts=new Map,this.L=new Set,this.S=new Map,this.ss=Ls,this.Y=Dt,this.is=Date.now(),this.Q=[],this.Ce="full",this.W=null,this.e=Ss(),this.z=Fs(),this.o=null,this.n=null,this.Z=null,this.Ee=new Set,this.Je=!1,this.t=null,this.c=null,this.v=new Set,this.ee=void 0,this.w=new Map,this.te=[],this.ve=null,this.se=!0,this.Xe="auto",this.T=null,this.ke=null,this.N="none",this.ie=new Map,this.rs=null,this.b="unknown",this.Ks=process.env.EXPLORER_DATES_LOG_WATCHERS==="1",this.pt=typeof u.workspace.onDidChangeWorkspaceFolders=="function"?u.workspace.onDidChangeWorkspaceFolders(s=>this.Js(s)):null,this.U=null,this.De=null,this.mt=0,this.B=!1,this.k=null,this.h=null,this.wt=!1,this.re={profile:"stress",throttleKey:"decorations:request",throttleLimit:Number(process.env.EXPLORER_DATES_LOG_INFO_LIMIT||50)},this.s={totalDecorations:0,cacheHits:0,cacheMisses:0,cacheEvictions:0,errors:0,gitBlameTimeMs:0,gitBlameCalls:0,fileStatTimeMs:0,fileStatCalls:0,viewportPriorityDecorations:0,viewportBackgroundDecorations:0},this.D=null,this.j=6e4,this.oe=new Set,this.xe=!1,this.bt=!1;let e=u.workspace.getConfiguration("explorerDates"),t=e.get("cacheTimeout",ve);this.yt=this.os(e,t),this.g=this.ns(t),this.i=e.get("performanceMode",!1),this.as(e),this._&&(this.i=!0,this.Ue=!1,this.Be=!1,this.g=Math.min(this.g,5e3),this.a=Math.min(this.a,64),this.e.info("Lightweight mode: decoration pooling and flyweight caches disabled; cache timeout capped at 5s")),this.i||this.Se(),this.Ct(),this.i||this.Fe(),this.Ye(this.Qe(e),"initialization"),this.Xs(),this.e.info(`FileDateDecorationProvider initialized (performanceMode: ${this.i})`),this.Ge&&this.e.warn("Force cache bypass mode enabled - decoration caches will be skipped"),this.Ue||this.e.warn("Decoration pool disabled via EXPLORER_DATES_ENABLE_DECORATION_POOL=0"),this.Be||this.e.warn("Flyweight caches disabled via EXPLORER_DATES_ENABLE_FLYWEIGHTS=0"),this._&&this.e.warn("Lightweight mode enabled via EXPLORER_DATES_LIGHTWEIGHT_MODE=1 (performanceMode forced on)"),this.je&&this.e.warn(`Memory shedding enabled (threshold ${this.Ve} MB); will stretch refresh interval and shrink cache if exceeded.`),this.Ze=[],this.et=Number(process.env.EXPLORER_DATES_SOFT_HEAP_ALERT_MB||1),this.ne=0,this.Te=!1,this.Et=Number(process.env.EXPLORER_DATES_CACHE_PRESSURE_RATIO||.7),this.tt=!1,this.u=null,this.cs=null,this.ls()}async ls(){let e=u.workspace.getConfiguration("explorerDates"),t=e.get("autoThemeAdaptation",!0),s=e.get("accessibilityMode",!1);if(t||s)try{let i=await this.Ys();i&&(this.k=t?i.themeManager:null,this.h=s?i.accessibilityManager:null,this.wt=!0,this.e.debug(`\u{1F50C} UI adapters loaded: theme=${!!this.k}, accessibility=${!!this.h}`))}catch(i){this.e.error("Failed to load UI adapters chunk:",i),this.k=null,this.h=null,this.wt=!1}else this.e.debug("\u{1F50C} UI adapters not loaded (features disabled)")}async Ys(){try{let t=await H().uiAdapters();return t?typeof t.createUIAdapters=="function"?await t.createUIAdapters():t:null}catch(e){return this.e.warn("UI adapters chunk not available:",e.message),null}}async Qs(){return this.ye?this.ye:this.l?this.l:(this.ye=(async()=>{try{let t=await H().gitInsights();if(!t)throw new Error("Git insights chunk failed to load");let s=null;if(typeof t=="function"?s=t:t&&typeof t.getGitInsightsManager=="function"?s=t.getGitInsightsManager:t&&typeof t.default=="function"&&(s=t.default),typeof s!="function")throw new Error("Git insights chunk missing getGitInsightsManager export");if(this.l=s(),!this.l||typeof this.l.initialize!="function")throw new Error("Git insights manager factory returned invalid instance");let i=u.workspace.getConfiguration("explorerDates");return await this.l.initialize({enableWorker:i.get("enableWorkerThreads",!0),enableWasm:i.get("enableWasmDigest",!0)}),this.gt=await this.l.isGitAvailable(),this.e.debug("\u{1F527} Git insights manager loaded and initialized"),this.l}catch(e){return this.e.error("Failed to load git insights:",e),this.l=null,this.gt=!1,null}finally{this.ye=null}})(),this.ye)}async Zs(){this.k&&typeof this.k.dispose=="function"&&this.k.dispose(),this.h&&typeof this.h.dispose=="function"&&this.h.dispose(),this.k=null,this.h=null,this.wt=!1,await this.ls()}applyPreviewSettings(e){let t=!!this.u;e&&typeof e=="object"?(this.u=Object.assign({},e),this.e.info("\u{1F504} Applied preview settings",this.u)):(this.u=null,this.e.info("\u{1F504} Cleared preview settings"));let s=this.r.size;if(this.r.clear(),this.ae("preview-mode-change"),this.e.info(`\u{1F5D1}\uFE0F Cleared memory cache (${s} items) for preview mode change`),this.t)try{typeof this.t.clear=="function"?(this.t.clear(),this.e.info("\u{1F5D1}\uFE0F Cleared advanced cache for preview mode change")):this.e.warn("\u26A0\uFE0F Advanced cache does not support clear operation")}catch(i){this.e.warn("\u26A0\uFE0F Failed to clear advanced cache:",i.message)}this.u&&!t?this.e.info("\u{1F3AD} Entered preview mode - caching disabled"):!this.u&&t&&this.e.info("\u{1F3AD} Exited preview mode - caching re-enabled"),this.E.fire(void 0),this.e.info("\u{1F504} Fired decoration refresh event for preview change")}async testDecorationProvider(){this.e.info("\u{1F9EA} Testing decoration provider functionality...");let e=u.workspace.workspaceFolders;if(!e||e.length===0){this.e.error("\u274C No workspace folders available for testing");return}let t=u.Uri.joinPath(e[0].uri,"package.json");try{let s=await this.provideFileDecoration(t);this.e.info("\u{1F9EA} Test decoration result:",{file:"package.json",success:!!s,badge:s?.badge,hasTooltip:!!s?.tooltip,hasColor:!!s?.color}),this.E.fire(t),this.e.info("\u{1F504} Fired decoration change event for test file")}catch(s){this.e.error("\u274C Test decoration failed:",s)}}forceRefreshAllDecorations(){this.e.info("\u{1F504} Force refreshing ALL decorations..."),this.ce(),this.r.clear(),this.ae("force-refresh"),this.t&&this.t.clear(),this.E.fire(void 0),this.e.info("\u{1F504} Triggered global decoration refresh")}startProviderCallMonitoring(){this.vt=0,this.Me=new Set;let e=this.provideFileDecoration.bind(this);this.provideFileDecoration=async(t,s)=>{this.vt++;let i=_(t)||t?.toString(!0)||"unknown";return this.Me.add(L(i)),this.e.info(`\u{1F50D} Provider called ${this.vt} times for: ${I(t||i)}`),await e(t,s)},this.e.info("\u{1F4CA} Started provider call monitoring")}getProviderCallStats(){return{totalCalls:this.vt||0,uniqueFiles:this.Me?this.Me.size:0,calledFiles:this.Me?Array.from(this.Me):[]}}async checkWorkspaceSize(){return this.De?this.De:(this.De=this.ei().catch(e=>{this.e.debug("Workspace size check failed (non-critical):",e)}).finally(()=>{this.De=null}),this.De)}async ti(e){let t=Number.isFinite(ke)?ke:0,s=u.workspace.findFiles("**/*",null,e);if(!t||t<=0)return s;try{return await new Promise((i,r)=>{let n=null,a=(c,l=!1)=>{n&&(clearTimeout(n),n=null),l?r(c):i(c)};n=setTimeout(()=>a(null),t),s.then(c=>a(c),c=>a(c,!0))})}catch(i){return this.e.warn("Workspace scan failed, assuming large workspace",{error:i.message}),null}}async ei(){let e=u.workspace.getConfiguration("explorerDates"),t=e.get("forceEnableForLargeWorkspaces",!1),s=e.get("performanceMode",!1);if(t||s)return;let i=u.workspace.workspaceFolders;if(!i||i.length===0)return;this.e.info("Checking workspace size for large workspace detection...");let r=await this.ti(50001),n=!Array.isArray(r),a=n?Os:r.length;if(n){let l=ke?`${ke}ms`:"the configured timeout";this.e.warn(`Workspace scan exceeded ${l}; defaulting to extreme scale`)}else this.e.info(`Workspace contains ${a>=50001?"50,000+":a} files`);let c=this.b;this.rs=a,this.b=a>=5e4?"extreme":a>=1e4?"large":"normal",c!==this.b&&this.se&&!this.i&&(this.e.info(`Workspace scale changed ${c} -> ${this.b}; recalibrating watchers`),this.Se("workspace-scale-update")),this.n&&typeof this.n.setWorkspaceScale=="function"&&this.n.setWorkspaceScale(this.b||"normal"),this.Ye(this.Qe(e),"workspace-scale-change")}hs(){let e=Ws;return this.b==="extreme"?Math.min(600,e):this.b==="large"?Math.min(1200,e):e}us(){let t=u.workspace.getConfiguration("explorerDates").get("enableProgressiveAnalysis");return t===!0||t===!1?t:this.b==="large"||this.b==="extreme"}Se(e="initial"){if(this.i||this.B){let i=this.B?"provider disposed":"performance mode enabled";this.e.debug(`Skipping file watcher setup (${e}) - ${i}`);return}this.ee||(this.ee={pending:!0});let t=++this.mt;(async()=>{if(this.ke)try{await this.ke}catch(r){this.e.debug("Previous watcher setup promise rejected",r)}let i=this.si(e,t);this.ke=i;try{await i}finally{this.ke===i&&(this.ke=null)}})().catch(i=>{this.e.error("Failed to configure file watchers",i)})}async si(e,t){if(this.Ae(t))return;if(this.st({permanent:!1}),this.Ae(t)){this.it("post-dispose");return}this.ee={pending:!0};let s=u.workspace.workspaceFolders;if(!s||s.length===0){this.e.debug("No workspace folders detected; skipping watcher setup"),this.N="none";return}if(Be()){this.e.info("File watchers are unavailable in web environments; skipping watcher setup"),this.N="none";return}let i=u.workspace.getConfiguration("explorerDates"),r=process.env.EXPLORER_DATES_DISABLE_SMART_WATCHERS==="1";this.se=!r&&i.get("smartFileWatching",!0),this.Xe=this.se&&i.get("enableSmartWatcherFallbacks","auto");let n=i.get("smartWatcherMaxPatterns",20),a=this.ii(i.get("smartWatcherExtensions",kt)),c=Math.max(1,Math.min(n,Et));if(this.ri={maxPatterns:c,extensions:a},this.Ae(t)){this.it("post-config");return}if(!this.se){this.e.info("Smart file watching disabled; falling back to global watcher"),await this.rt("disabled");return}let l=[];try{l=await this.oi(s,this.ri)}catch(h){this.e.error("Smart watcher analysis failed, falling back to global watcher",h),await this.rt("analysis-failed");return}if(this.Ae(t)){this.it("post-analysis");return}if(!l||l.length===0){this.e.warn("Smart watcher analysis yielded no targets; falling back to global watcher"),await this.rt("no-targets");return}for(let h of l)try{let d=await this.ds(h.pattern,h.label);d&&(this.kt(d,h.label),this.v.add(d))}catch(d){this.e.debug(`Failed to create watcher for pattern ${h.label}`,d)}if(this.v.size===0){this.e.warn("Smart watcher setup produced zero watchers; using global fallback"),await this.rt("no-watchers-created");return}if(this.Ae(t)){this.it("post-creation");return}this.ee=this.v.values().next().value||void 0,this.N="smart",this.e.info(`Smart file watching enabled (${this.v.size} base watcher${this.v.size===1?"":"s"})`,{reason:e,patterns:l.map(h=>h.label)}),this.ni()}Ae(e){return!!(this.B||this.i||typeof e=="number"&&e!==this.mt)}it(e="unknown"){let t=this.i||this.B;this.st({permanent:t}),this.e.debug(`Watcher setup aborted (${e})`,{permanentAbort:t,disposed:this.B,performanceMode:this.i})}async ds(e,t="unknown"){try{let s=u.workspace.createFileSystemWatcher(e);return this.e.debug(`Native watcher created for ${t}`),s}catch(s){if(this.e.debug(`Native watcher failed for ${t}:`,s),!this.ai())throw s;return this.ci(e,t)}}ai(){return this.Xe===!1?!1:this.Xe==="auto"||this.Xe===!0?this.li():!1}li(){let e=process.platform,t=process.env.WSL_DISTRO_NAME||process.env.WSLENV,s=u.env.remoteName,i=process.env.DOCKER_CONTAINER;return t||s||i||e==="android"}async ci(e,t){try{if(!this.T){let{loadFeatureModule:s}=H(),i=await s("smartWatcherFallback");if(i){let{SmartWatcherFallbackManager:r}=i;this.T=new r({logger:this.e}),await this.T.initialize()}}if(this.T){let i=await(await this.T.getFallback()).createWatcherWithFallback(e);return this.e.debug(`Fallback watcher created for ${t}`),i}}catch(s){this.e.warn(`Fallback watcher creation failed for ${t}:`,s)}return null}async rt(e="global-default"){this.Dt();let t=await this.ds("**/*",`global:${e}`);t?(this.kt(t,`global:${e}`),this.v.add(t),this.ee=t,this.N="global",this.e.info(`Global watcher activated (${e})`)):this.e.error(`Failed to create global watcher (${e})`)}kt(e,t="unknown"){e&&(e.onDidChange(s=>this.xt(s,"change",t)),e.onDidCreate(s=>this.xt(s,"create",t)),e.onDidDelete(s=>this.xt(s,"delete",t)))}xt(e,t,s="unknown"){if(!e||e.scheme!=="file")return;let i=this.hi();if(i<=0){this.gs(e,t,s);return}let r=`${e.toString()}:${t}`,n=this.ie.get(r);n&&clearTimeout(n.timer);let a=setTimeout(()=>{this.ie.delete(r),this.gs(e,t,s)},i);this.ie.set(r,{timer:a,source:s})}gs(e,t,s){t==="delete"?this.clearDecoration(e):this.refreshDecoration(e),this.o?.incrementalIndexer&&this.o.incrementalIndexer.queueDelta(e,t),this.Ks&&this.e.debug(`Watcher event processed (${t}) for ${I(e)} via ${s}`)}hi(){if(this.i)return 0;switch(this.b){case"extreme":return 600;case"large":return 250;default:return 100}}Js(e){let t=(e?.added||[]).map(r=>r.uri).filter(Boolean),s=(e?.removed||[]).map(r=>r.uri).filter(Boolean);if(t.length===0&&s.length===0)return;let i=async()=>{if(this.e.info("Workspace folders changed",{added:t.length,removed:s.length}),await this.checkWorkspaceSize(),!this.i&&(this.Se("workspace-change"),await this.St().catch(r=>{this.e.debug("Failed to reconfigure progressive loading after workspace change",r)}),this.o)){let r=(u.workspace.workspaceFolders||[]).map(n=>({uri:n.uri}));await this.o.onWorkspaceFoldersChanged({added:r,removed:s.map(n=>({uri:n}))})}};this.U&&clearTimeout(this.U),this.U=setTimeout(()=>{this.U=null,i().catch(r=>this.e.debug("Workspace folder change handling failed",r))},250)}st(e={}){let t=e.permanent===!0;if(this.v?.size){for(let s of this.v)try{s.dispose()}catch(i){this.e.debug("Failed to dispose file watcher",i)}this.v.clear()}this.ee=t?null:void 0,this.Dt(),this.ps(!0),this.ui(),this.N="none"}ui(){if(this.ie?.size){for(let e of this.ie.values())clearTimeout(e.timer);this.ie.clear()}}ni(){if(!this.se||this.te.length>0)return;let e=(s,i)=>{let r=this.ot(u.window,s,i);r&&this.te.push(r)},t=(s,i)=>{let r=this.ot(u.workspace,s,i);r&&this.te.push(r)};e("onDidChangeVisibleTextEditors",s=>{(s||[]).forEach(i=>this.$e(i?.document?.uri,"visible-editor"))}),e("onDidChangeActiveTextEditor",s=>{this.$e(s?.document?.uri,"active-editor")}),t("onDidOpenTextDocument",s=>{this.$e(s?.uri,"open-document")}),t("onDidSaveTextDocument",s=>{this.$e(s?.uri,"save-document")}),this.di(),this.fi()}Dt(){if(this.te?.length){for(let e of this.te)try{e.dispose()}catch(t){this.e.debug("Failed to dispose watcher listener",t)}this.te=[]}this.ms()}gi(){if(this.T){try{this.T.dispose()}catch(e){this.e.debug("Error disposing smart watcher fallback manager:",e)}this.T=null}}di(){(Array.isArray(u.window?.visibleTextEditors)?u.window.visibleTextEditors:[]).forEach(t=>this.$e(t?.document?.uri,"visible-seed"))}fi(){this.ve||(this.ve=setInterval(()=>this.ps(),vt))}ms(){this.ve&&(clearInterval(this.ve),this.ve=null)}ps(e=!1){if(!this.w?.size)return;let t=Date.now()-vt;for(let[s,i]of this.w.entries())if(e||i.lastUsed<t){try{i.watcher.dispose()}catch(r){this.e.debug(`Failed to dispose dynamic watcher for ${s}`,r)}this.w.delete(s)}this.w.size||this.ms()}$e(e,t="editor"){if(!this.se||!e||e.scheme!=="file"||!J)return;let s=Ee.dirname(e.fsPath||"");if(!s)return;let i=L(s),r=this.w.get(i);if(r){r.lastUsed=Date.now();return}this.w.size>=Et&&this.pi();try{let n=new u.RelativePattern(i,"**/*"),a=u.workspace.createFileSystemWatcher(n),c=Ee.basename(i)||"root";this.kt(a,`dynamic:${t}:${c}`),this.w.set(i,{watcher:a,lastUsed:Date.now(),source:t})}catch(n){this.e.debug(`Failed to create dynamic watcher for ${i}`,n)}}pi(){let e=null,t=Number.POSITIVE_INFINITY;for(let[s,i]of this.w.entries())i.lastUsed<t&&(t=i.lastUsed,e=s);if(e){let s=this.w.get(e);try{s?.watcher?.dispose()}catch(i){this.e.debug(`Failed to evict watcher for ${e}`,i)}this.w.delete(e)}}Xs(){if(this.Q.length>0)return;let e=(s,i)=>{let r=this.ot(u.window,s,i);r&&this.Q.push(r)},t=(s,i)=>{let r=this.ot(u.workspace,s,i);r&&this.Q.push(r)};e("onDidChangeVisibleTextEditors",s=>{this.ws(s)}),e("onDidChangeActiveTextEditor",s=>{this.Re(s?.document?.uri,{reason:"active-editor"})}),t("onDidOpenTextDocument",s=>{this.Re(s?.uri,{reason:"open-document"})}),t("onDidSaveTextDocument",s=>{this.Re(s?.uri,{reason:"save-document"})}),this.ws(Array.isArray(u.window?.visibleTextEditors)?u.window.visibleTextEditors:[]),u.window?.activeTextEditor?.document?.uri&&this.Re(u.window.activeTextEditor.document.uri,{reason:"initial-active"})}mi(){if(this.Q?.length){for(let e of this.Q)try{e.dispose()}catch(t){this.e.debug("Failed to dispose viewport listener",t)}this.Q=[],this.L.clear(),this.S.clear()}}ws(e){if(this.L.clear(),!Array.isArray(e))return;let t=Date.now();for(let s of e){let i=s?.document?.uri;if(!i||i.scheme!=="file")continue;let r=L(_(i));r&&(this.L.add(r),this.S.set(r,t))}this.Ft()}Re(e,t={}){if(!e||e.scheme!=="file")return;let s=L(_(e));if(!s)return;let i=Date.now();this.S.set(s,i),t.visible&&this.L.add(s),this.S.size>this.ss?this.Ft(!0):i-this.is>this.Y&&this.Ft()}Ft(e=!1){let t=Date.now(),s=t-this.Y*2;for(let[i,r]of this.S.entries())(e||r<s||this.S.size>this.ss&&r<t)&&this.S.delete(i);this.is=t}wi(e){if(!e||e.scheme!=="file"||this.i||this.Ce==="full")return!0;let t=L(_(e));if(!t||this.L.has(t))return!0;let s=this.S.get(t);return s?Date.now()-s<=this.Y:!1}async oi(e,t){let s=[],r=u.workspace.getConfiguration("explorerDates").get("excludedFolders",[]),n=new Set;for(let c of r){if(!c)continue;let l=c.toString?.()||c;if(!l)continue;let h=l.replace(/^\/+|\/+$/g,"");h&&(n.add(h.toLowerCase()),h.split(/[\\/]/g).forEach(d=>{d&&n.add(d.toLowerCase())}))}["node_modules",".git",".hg",".svn","dist","build","out",".vscode",".idea",".cache",".parcel-cache",".yarn",".pnpm-store","tmp","temp","coverage",".next"].forEach(c=>n.add(c));for(let c of e){if(s.length>=t.maxPatterns)break;let l=new u.RelativePattern(c,"*.{md,mdx,json,jsonc,yml,yaml,ts,tsx,js,jsx}");if(s.push({pattern:l,label:`root:${c.name}`}),s.length>=t.maxPatterns)break;let h=t.maxPatterns-s.length,d=await this.bi(c,{excludedSet:n,extensions:t.extensions,limit:h});s.push(...d)}return s.slice(0,t.maxPatterns)}async bi(e,t){if(t.limit<=0)return[];let s=[];try{s=await this.be.readdir(e.uri,{withFileTypes:!0})}catch(n){return this.e.debug(`Failed to read workspace folder ${e.name}`,n),[]}let i=[];for(let n of s){if(!n.isDirectory())continue;let a=n.name.toLowerCase();if(this.yi(a,t.excludedSet))continue;let c=Is.get(a)||(a.startsWith(".")?1:10);i.push({name:n.name,score:c})}return i.sort((n,a)=>a.score-n.score),i.slice(0,t.limit).map(n=>({pattern:new u.RelativePattern(e,this.Ci(n.name,t.extensions)),label:`dir:${e.name}/${n.name}`}))}yi(e,t){return!!(!e||t.has(e)||e.startsWith("."))}Ci(e,t){return!t||t.length===0?`${e}/**/*`:t.length===1?`${e}/**/*.${t[0]}`:`${e}/**/*.{${t.join(",")}}`}ii(e){let t=Array.isArray(e)&&e.length>0?e:kt;return Array.from(new Set(t.map(s=>(s||"").toString().trim().replace(/^\./,"").toLowerCase()).filter(Boolean)))}Fe(){let e=u.workspace.getConfiguration("explorerDates"),t=e.get("badgeRefreshInterval",6e4),s=this.qe||t;if(this.j=s,this.e.info(`Setting up periodic refresh with interval: ${this.j}ms`),this.D&&(clearInterval(this.D),this.D=null),this.ce(),!e.get("showDateDecorations",!0)){this.e.info("Decorations disabled, skipping periodic refresh setup");return}this.D=setInterval(()=>{if(this.xe){this.e.debug("Periodic refresh skipped - incremental refresh already running");return}this.e.debug("Periodic refresh triggered - scheduling incremental refresh"),this.Ei("periodic")},this.j),this.e.info("Periodic refresh timer started")}vi(e,t){if(t?.uri)return t.uri;if(!e)return null;try{return u.Uri.file(e)}catch(s){return this.e.debug(`Failed to rebuild URI from cache key: ${e}`,s),null}}ce(){if(this.oe?.size){for(let e of this.oe)clearTimeout(e);this.oe.clear()}this.xe=!1}Ei(e="manual"){if(this.bt){this.e.debug(`Incremental refresh (${e}) skipped - refresh already pending`);return}this.xe&&(this.e.debug(`Incremental refresh (${e}) already in progress, cancelling pending timers and rescheduling`),this.ce());let t=Array.from(this.r.entries());if(t.length===0){this.e.debug(`No cached decorations to refresh for ${e}, falling back to global refresh`),this.E.fire(void 0);return}let s=t.map(([c,l])=>{let h=this.vi(c,l);return h?{cacheKey:c,uri:h}:null}).filter(Boolean);if(s.length===0){this.e.debug(`Failed to resolve URIs for ${e} incremental refresh, firing global refresh`),this.E.fire(void 0);return}let i=40,r=Math.ceil(s.length/i),n=Math.min(4e3,Math.max(750,Math.floor(this.j*.25))),a=r>1?Math.max(25,Math.floor(n/r)):0;this.xe=!0,this.bt=!0,this.e.debug(`Incremental refresh (${e}) scheduled for ${s.length} items in ${r} batches (spacing: ${a}ms)`);for(let c=0;c<r;c++){let l=s.slice(c*i,(c+1)*i),h=c===0?0:a*c,d=setTimeout(()=>{try{l.forEach(({cacheKey:m,uri:b})=>{this.ki(m),this.E.fire(b)})}finally{this.oe.delete(d),this.oe.size===0&&(this.xe=!1,this.bt=!1,this.e.debug(`Incremental refresh (${e}) completed`))}},h);this.oe.add(d)}}ki(e){if(!e)return;let t=this.r.get(e);if(t){let s=Date.now()-t.timestamp;s>this.g*.75?(t.forceRefresh=!0,this.e.debug(`Marked stale entry for refresh: ${e} (age: ${Math.round(s/1e3)}s)`)):this.e.debug(`Skipped refresh for fresh entry: ${e} (age: ${Math.round(s/1e3)}s, threshold: ${Math.round(this.g*.75/1e3)}s)`)}if(this.t)try{let s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.t.invalidateByPattern(s)}catch(s){this.e.debug(`Could not invalidate advanced cache for ${e}: ${s.message}`)}}Ct(){this.c&&this.c.dispose(),this.c=u.workspace.onDidChangeConfiguration(async e=>{if(e.affectsConfiguration("explorerDates")){this.e.debug("Configuration changed, updating settings");let t=u.workspace.getConfiguration("explorerDates"),s=t.get("cacheTimeout",ve);this.yt=this.os(t,s),this.g=this.ns(s),this.a=t.get("maxCacheSize",1e4);let i=this.as(t);if(e.affectsConfiguration("explorerDates.performanceMode")){let a=t.get("performanceMode",!1);if(a!==this.i){if(this.i=a,this.e.info(`Performance mode changed to: ${a}`),a?(this.st({permanent:!0}),this.e.info("File watchers disabled for performance mode")):(this.Se("performance-mode-toggle"),this.e.info("File watchers enabled (performance mode off)")),a&&this.D?(clearInterval(this.D),this.D=null,this.e.info("Periodic refresh disabled for performance mode")):!a&&!this.D&&(this.Fe(),this.e.info("Periodic refresh enabled (performance mode off)")),this.Ye(this.Qe(t),"performance-mode-change"),this.refreshAll({reason:"performance-mode-change"}),a)this.o&&(this.o.dispose(),this.o=null);else if(!this.o){let l=await H().workspaceIntelligence();if(l){let{WorkspaceIntelligenceManager:h}=l;this.o=new h(this.be),await this.o.initialize({batchProcessor:this.n,enableProgressiveAnalysis:this.us()});let d=u.workspace.workspaceFolders;d?.length&&await this.o.analyzeWorkspace(d,{maxFiles:this.hs()})}}}}e.affectsConfiguration("explorerDates.featureLevel")&&this.Ye(this.Qe(t),"configuration-change"),e.affectsConfiguration("explorerDates.badgeRefreshInterval")&&(this.j=t.get("badgeRefreshInterval",6e4),this.e.info(`Badge refresh interval updated to: ${this.j}ms`),this.i||this.Fe());let r=e.affectsConfiguration("explorerDates.showDateDecorations")||e.affectsConfiguration("explorerDates.dateDecorationFormat")||e.affectsConfiguration("explorerDates.excludedFolders")||e.affectsConfiguration("explorerDates.excludedPatterns")||e.affectsConfiguration("explorerDates.highContrastMode")||e.affectsConfiguration("explorerDates.fadeOldFiles")||e.affectsConfiguration("explorerDates.fadeThreshold")||e.affectsConfiguration("explorerDates.colorScheme")||e.affectsConfiguration("explorerDates.showGitInfo")||e.affectsConfiguration("explorerDates.customColors")||e.affectsConfiguration("explorerDates.showFileSize")||e.affectsConfiguration("explorerDates.fileSizeFormat")||e.affectsConfiguration("explorerDates.featureLevel");(r||i)&&this.refreshAll({preservePersistentCache:!0,reason:r?"configuration-change":"namespace-change"});let n=e.affectsConfiguration("explorerDates.smartFileWatching")||e.affectsConfiguration("explorerDates.smartWatcherMaxPatterns")||e.affectsConfiguration("explorerDates.smartWatcherExtensions")||e.affectsConfiguration("explorerDates.excludedFolders")||e.affectsConfiguration("explorerDates.smartExclusions");!this.i&&n&&this.Se("configuration-change"),e.affectsConfiguration("explorerDates.progressiveLoading")&&this.St().catch(a=>{this.e.error("Failed to reconfigure progressive loading",a)}),(e.affectsConfiguration("explorerDates.autoThemeAdaptation")||e.affectsConfiguration("explorerDates.accessibilityMode"))&&(this.e.debug("UI adapters configuration changed, reloading..."),await this.Zs()),e.affectsConfiguration("explorerDates.showDateDecorations")&&!this.i&&this.Fe()}})}os(e,t){if(typeof t=="number"&&t!==ve)return!0;if(!e||typeof e.inspect!="function")return!1;try{let s=e.inspect("cacheTimeout");if(!s)return!1;if(typeof s=="object"&&(typeof s.globalValue=="number"||typeof s.workspaceValue=="number"||typeof s.workspaceFolderValue=="number"))return!0;if(s.cacheTimeout&&typeof s.cacheTimeout=="object"){let i=s.cacheTimeout;if(typeof i.globalValue=="number"||typeof i.workspaceValue=="number"||typeof i.workspaceFolderValue=="number"){let n=i.globalValue??i.workspaceValue??i.workspaceFolderValue;return typeof n=="number"&&n!==ve}}}catch{return!1}return!1}ns(e){return this.Ke||this.yt?e:Math.max(this.dt,e||this.dt)}async Di(){if(this.i)return null;if(!this.Z)try{let e=H();if(this.Z=await e.batchProcessor(),!this.Z)return this.e.debug("BatchProcessor chunk not available"),null;this.e.debug("BatchProcessor module loaded dynamically")}catch(e){return this.e.error("Failed to load BatchProcessor module:",e),null}if(!this.n&&this.Z){let e=this.Z.BatchProcessor||this.Z.default?.BatchProcessor;if(!e)return this.e.warn("BatchProcessor chunk missing BatchProcessor export"),null;this.n=new e,this.e.debug("BatchProcessor instance created")}return this.n}async St(){if(!u.workspace.getConfiguration("explorerDates").get("progressiveLoading",!0)){this.e.info("Progressive loading disabled via explorerDates.progressiveLoading - BatchProcessor will not be loaded"),this.Je=!1,this.n&&(this.n.dispose(),this.n=null,this.e.debug("BatchProcessor disposed due to disabled progressive loading")),this.nt();return}if(this.i){this.e.info("Progressive loading disabled due to performance mode"),this.nt(),this.Je=!1;return}if(!await this.Di()){this.e.info("BatchProcessor not available - progressive loading disabled"),this.Je=!1;return}this.Je=!0;let i=u.workspace.workspaceFolders;!i||i.length===0||(this.nt(),i.forEach(r=>{let n=this.n.processDirectoryProgressively(r.uri,async a=>{try{await this.provideFileDecoration(a)}catch(c){this.e.debug("Progressive warmup processor failed",c)}},{background:!0,priority:"low",maxFiles:500});n&&this.Ee.add(n)}),this.e.info(`Progressive loading queued for ${i.length} workspace folder(s).`))}nt(){if(!(!this.Ee||this.Ee.size===0)){if(this.n)for(let e of this.Ee)this.n.cancelBatch(e);this.Ee.clear()}}refreshDecoration(e){let t=this.Tt(e);if(this.r.delete(t),this.t)try{this.t.invalidateByPattern(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))}catch(s){this.e.debug(`Could not invalidate advanced cache for ${I(e)}: ${s.message}`)}this.E.fire(e),this.e.debug(`\u{1F504} Refreshed decoration cache for: ${I(e)}`)}clearDecoration(e){let t=this.Tt(e);this.r.delete(t),this.t&&this.e.debug(`Advanced cache entry will expire naturally: ${I(e)}`),this.E.fire(e),this.e.debug(`\u{1F5D1}\uFE0F Cleared decoration cache for: ${I(e)}`)}clearAllCaches(){this.ce();let e=this.r.size;this.r.clear(),this.ae("clearAllCaches"),this.e.info(`Cleared memory cache (was ${e} items)`),this.t&&(this.t.clear(),this.e.info("Cleared advanced cache")),this.s.cacheHits=0,this.s.cacheMisses=0,this.e.info("All caches cleared successfully")}refreshAll(e={}){let{preservePersistentCache:t=!1,reason:s="manual-refresh"}=e;this.ce(),this.r.clear(),this.ae("refreshAll"),this.l&&this.l.clearCache(),this.t&&(t&&typeof this.t.resetRuntimeOnly=="function"?this.t.resetRuntimeOnly():this.t.clear()),this.E.fire(void 0);let i=t?" (persistent cache preserved)":"";this.e.info(`All decorations refreshed (${s})${i}`)}async xi(e){let t=u.workspace.getConfiguration("explorerDates"),s=_(e);if(!s)return!1;let i=L(s),r=Ue(i),n=Ce(s),a=t.get("forceShowForFileTypes",[]);if(a.length>0&&a.includes(n))return this.e.debug(`File type ${n} is forced to show: ${s}`),!1;let c=t.get("enableTroubleShootingMode",!1);c&&this.e.info(`\u{1F50D} Checking exclusion for: ${r} (ext: ${n})`);let l=t.get("excludedFolders",["node_modules",".git","dist","build","out",".vscode-test"]),h=t.get("excludedPatterns",["**/*.tmp","**/*.log","**/.git/**","**/node_modules/**"]);for(let d of l){let m=d.replace(/^\/+|\/+$/g,"");if(i.includes(`/${m}/`)||i.endsWith(`/${m}`))return c?this.e.info(`\u274C File excluded by folder: ${s} (${d})`):this.e.debug(`File excluded by folder: ${s} (${d})`),!0}for(let d of h)if(d.includes("node_modules")&&i.includes("/node_modules/")||d.includes(".git/**")&&i.includes("/.git/")||d.includes("*.tmp")&&r.endsWith(".tmp")||d.includes("*.log")&&r.endsWith(".log"))return!0;return c&&this.e.info(`\u2705 File NOT excluded: ${r} (ext: ${n})`),!1}async Tr(e){let t=u.workspace.getConfiguration("explorerDates"),s=_(e);if(!s)return!1;let i=L(s),r=Ue(i),n=u.workspace.getWorkspaceFolder(e);if(n){let a=this.o?.smartExclusion?await this.o.smartExclusion.getCombinedExclusions(n.uri):null;for(let c of a.folders)if(new RegExp(`(^|/)${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(/|$)`).test(i))return this.e.debug(`File excluded by folder rule: ${s} (folder: ${c})`),!0;for(let c of a.patterns){let l=c.replace(/\*\*/g,".*").replace(/\*/g,"[^/\\\\]*").replace(/\?/g,"."),h=new RegExp(l);if(h.test(i)||h.test(r))return this.e.debug(`File excluded by pattern: ${s} (pattern: ${c})`),!0}}else{let a=t.get("excludedFolders",[]),c=t.get("excludedPatterns",[]);for(let l of a)if(new RegExp(`(^|/)${l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(/|$)`).test(i))return!0;for(let l of c){let h=l.replace(/\*\*/g,".*").replace(/\*/g,"[^/\\\\]*").replace(/\?/g,"."),d=new RegExp(h);if(d.test(i)||d.test(r))return!0}}return!1}Si(){if(this.r.size<=this.a)return;let e=this.r.enforceLimit(this.a,this.e);e>0&&(this.s.cacheEvictions+=e)}Fi(){if(this.Ke||this.yt)return;let e=this.s.cacheHits+this.s.cacheMisses;if(e<200)return;let t=this.s.cacheHits/e;if(t<.9||this.g>=this.Xt||e<=this.ft||e-this.ft<100)return;let i=this.g;this.g=Math.min(this.g+yt,this.Xt),this.ft=e,this.e.info("\u2699\uFE0F Cache timeout extended (max 8min)",{previousTimeout:i,newTimeout:this.g,hitRate:Number(t.toFixed(2)),totalLookups:e})}async Ti(e,t){if(this.Ge)return this.e.debug(`\u26A0\uFE0F Cache bypass enabled - recalculating decoration for: ${t}`),null;if(this.t)try{let i=await this.t.get(e);if(i)return this.s.cacheHits++,this.e.debug(`\u{1F9E0} Advanced cache hit for: ${t}`),i}catch(i){this.e.debug(`Advanced cache error: ${i.message}`)}let s=this.r.get(e);if(s){if(s.forceRefresh)this.r.delete(e),this.e.debug(`\u{1F6AB} Memory cache bypassed (forced refresh) for: ${t}`);else if(Date.now()-s.timestamp<this.g)return this.s.cacheHits++,this.e.debug(`\u{1F4BE} Memory cache hit for: ${t}`),s.decoration}return null}async Mi(e,t,s,i){if(this.Ge)return;this.Si();let r={decoration:t,timestamp:Date.now()};if(i&&(r.uri=i),this.r.set(e,r),this.Ai(),this.t)try{await this.t.set(e,t,{ttl:this.g}),this.e.debug(`\u{1F9E0} Stored in advanced cache: ${s}`)}catch(n){this.e.debug(`Failed to store in advanced cache: ${n.message}`)}this.Fi()}bs(e,t,s,i,r,n){if(!this.Be||!i)return n&&(n.misses++,n.allocations++),r();if(e.has(i))return n&&(n.hits++,n.reuses++),e.get(i);n&&(n.misses++,n.allocations++);let a=r();if(e.set(i,a),t.push(i),t.length>s){let c=t.shift();c&&e.delete(c)}return a}Gt(){try{let e=process?.memoryUsage?process.memoryUsage().heapUsed:0;return Number((e/1024/1024).toFixed(2))}catch{return 0}}ys(){try{let e=process?.memoryUsage?process.memoryUsage().rss:0;return Number((e/1024/1024).toFixed(2))}catch{return 0}}$i(){if(!this.je||this.He)return;let e=this.Gt();if(!e)return;if(!this.we){this.we=e,this.ne=0,this.Te=!1;return}let t=e-this.we;if(t>=this.et?(this.ne++,this.ne>=2&&!this.Te&&(this.Te=!0,this.e.warn("Memory pressure warning (soft threshold exceeded twice)",{deltaMB:Number(t.toFixed(2)),baselineMB:this.we,heapMB:e,rssMB:this.ys(),cacheSize:this.r.size,cacheLimit:this.a}))):this.ne>0&&(this.ne=0,t<this.et*.5&&(this.Te=!1)),t>=this.Ve){this.He=!0,this.a=Math.min(this.a,this.Gs),this.qe=Math.max(this.qe||this.j||this.Kt,this.Kt);let s=this.ys(),i={timestamp:new Date().toISOString(),deltaMB:Number(t.toFixed(2)),baselineMB:this.we,heapMB:e,rssMB:s,cacheSize:this.r.size,maxCacheSize:this.a,watcherStrategy:this.N,staticWatchers:this.v.size,dynamicWatchers:this.w.size};this.Ze.push(i),this.Ze.length>10&&this.Ze.shift(),this.e.warn(`Memory shedding activated (delta ${t.toFixed(2)} MB >= ${this.Ve} MB); cache size capped at ${this.a} and refresh interval stretched to ${this.qe}ms`,i),this.Fe(),this.Te=!1,this.ne=0}}Ai(){if(!this.a||this.a<=0)return;let e=this.r.size/this.a;e>=this.Et?this.tt||(this.tt=!0,this.e.infoWithOptions({throttleKey:"cache-pressure",intervalMs:6e4},`Decoration cache usage is at ${(e*100).toFixed(1)}% of capacity`,{cacheSize:this.r.size,maxCacheSize:this.a})):e<this.Et*.5&&(this.tt=!1)}Ri({badge:e,tooltip:t,color:s}){if(!this.Ue){this.f.misses++,this.f.allocations++;let n=new u.FileDecoration(e||"??");return t&&(n.tooltip=t),s&&(n.color=s),n.propagate=!1,n}if(!e)return this.f.allocations++,new u.FileDecoration("??");let i=this.Pi(e,t,s);if(i&&this.O.has(i))return this.f.hits++,this.f.reuses++,this.O.get(i);let r=new u.FileDecoration(e);if(t&&(r.tooltip=t),s&&(r.color=s),r.propagate=!1,this.f.allocations++,i&&(this.O.set(i,r),this.We.push(i),this.We.length>this.Vs)){let n=this.We.shift();n&&n!==i&&this.O.delete(n)}return this.f.misses++,r}Pi(e,t,s){let i=e||"",r=t||"",n=this.Ii(s);return`${i}::${n}::${r}`}Ii(e){if(!e)return"none";if(typeof e=="string")return e;if(e.id)return e.id;try{return JSON.stringify(e)}catch{return String(e)}}ae(e="unspecified"){this.O.size!==0&&(this.O.clear(),this.We.length=0,this.e.debug(`\u{1F9FC} Cleared decoration pool (${e})`))}Cs(e="lightweight"){this._&&(this.r.size>0&&this.r.clear(),this.ae(e),this.ze.size>0&&(this.ze.clear(),this.Ht.length=0),this.Ne.size>0&&(this.Ne.clear(),this.qt.length=0),this.e.debug(`\u{1F9FD} Purged lightweight caches (${e})`))}Oi(){if(!this._)return;if(this.Jt<=0){this.Cs("lightweight-interval-disabled");return}let e=this.s?.totalDecorations||0;e>0&&e%this.Jt===0&&this.Cs("lightweight-interval")}_i({formatType:e,diffMinutes:t,diffHours:s,diffDays:i,diffWeeks:r,diffMonths:n,date:a}){let c=(l,h=null)=>({value:l,key:h?`badge:${e||"default"}:${h}`:null});switch(e){case"relative-short":case"relative-long":return t<1?c("\u25CF\u25CF","just"):t<60?c(`${Math.min(t,99)}m`,`m:${Math.min(t,99)}`):s<24?c(`${Math.min(s,23)}h`,`h:${Math.min(s,23)}`):i<7?c(`${i}d`,`d:${i}`):r<4?c(`${r}w`,`w:${r}`):n<12?c(`${n}M`,`M:${n}`):c("1y","y:1");case"absolute-short":case"absolute-long":{let l=a.getDate(),h=`${Rs[a.getMonth()]}${l<10?"0"+l:l}`,d=[a.getMonth(),l];return e==="absolute-long"&&d.push(a.getFullYear()),c(h,`abs:${d.join("-")}`)}case"technical":return t<60?c(`${t}m`,`tech:m:${t}`):s<24?c(`${s}h`,`tech:h:${s}`):c(`${i}d`,`tech:d:${i}`);case"minimal":return s<1?c("\u2022\u2022","min:now"):s<24?c("\u25CB\u25CB","min:hours"):c("\u2500\u2500","min:days");default:return t<60?c(`${t}m`,`smart:m:${t}`):s<24?c(`${s}h`,`smart:h:${s}`):c(`${i}d`,`smart:d:${i}`)}}Es(e,t,s=null){let r=s!==null?s:new Date().getTime()-e.getTime();if(r<0)return this.e.debug(`File has future modification time (diffMs: ${r}), treating as just modified`),"\u25CF\u25CF";let n=Math.floor(r/(1e3*60)),a=Math.floor(r/(1e3*60*60)),c=Math.floor(r/(1e3*60*60*24)),l=Math.floor(c/7),h=Math.floor(c/30),d=this._i({formatType:t,diffMinutes:n,diffHours:a,diffDays:c,diffWeeks:l,diffMonths:h,date:e});return this.bs(this.ze,this.Ht,this.Hs,d.key,()=>d.value,this.G)}Pe(e,t="auto"){return Ms(e,t)}Li(e,t,s,i,r){let n=e.toDateString()===t.toDateString();return s<1?{key:"readable:just",factory:()=>this.z.getString("justNow")}:s<60?{key:`readable:minutes:${s}`,factory:()=>this.z.getString("minutesAgo",s)}:i<24&&n?{key:`readable:hours:${i}`,factory:()=>this.z.getString("hoursAgo",i)}:r<7?r===1?{key:"readable:yesterday",factory:()=>this.z.getString("yesterday")}:{key:`readable:days:${r}`,factory:()=>this.z.getString("daysAgo",r)}:null}Wi(e,t,s=""){if(t==="none")return;let r=new Date().getTime()-e.getTime(),n=Math.floor(r/(1e3*60*60)),a=Math.floor(r/(1e3*60*60*24));switch(t){case"recency":return n<1?new u.ThemeColor("charts.green"):n<24?new u.ThemeColor("charts.yellow"):new u.ThemeColor("charts.red");case"file-type":{let c=Ce(s);return[".js",".ts",".jsx",".tsx"].includes(c)?new u.ThemeColor("charts.blue"):[".css",".scss",".less"].includes(c)?new u.ThemeColor("charts.purple"):[".html",".htm",".xml"].includes(c)?new u.ThemeColor("charts.orange"):[".json",".yaml",".yml"].includes(c)?new u.ThemeColor("charts.green"):[".md",".txt",".log"].includes(c)?new u.ThemeColor("charts.yellow"):[".py",".rb",".php"].includes(c)?new u.ThemeColor("charts.red"):new u.ThemeColor("editorForeground")}case"subtle":return n<1?new u.ThemeColor("editorInfo.foreground"):a<7?new u.ThemeColor("editorWarning.foreground"):new u.ThemeColor("editorError.foreground");case"vibrant":return n<1?new u.ThemeColor("terminal.ansiGreen"):n<24?new u.ThemeColor("terminal.ansiYellow"):a<7?new u.ThemeColor("terminal.ansiMagenta"):new u.ThemeColor("terminal.ansiRed");case"custom":return n<1?new u.ThemeColor("explorerDates.customColor.veryRecent"):n<24?new u.ThemeColor("explorerDates.customColor.recent"):new u.ThemeColor("explorerDates.customColor.old");default:return}}zi({filePath:e,stat:t,diffMs:s,dateFormat:i,badgePriority:r,showFileSize:n,fileSizeFormat:a,gitBlame:c,showGitInfo:l}){let h=this.Es(t.mtime,i,s),d=this.vs(t.mtime),m=this.vs(t.birthtime),b=h;if(this.e.debug(`\u{1F3F7}\uFE0F Badge generation for ${I(e)}: badgePriority=${r}, showGitInfo=${l}, hasGitBlame=${!!c}, authorName=${c?.authorName}, previewMode=${!!this.u}`),r==="author"&&c?.authorName){let y=this.Ni(c.authorName);y&&(b=y,this.e.debug(`\u{1F3F7}\uFE0F Using author initials badge: "${y}" (from ${c.authorName})`))}else if(r==="size"&&n){let y=this.Ui(t.size);y&&(b=y,this.e.debug(`\u{1F3F7}\uFE0F Using size badge: "${y}"`))}else this.e.debug(`\u{1F3F7}\uFE0F Using time badge: "${h}" (badgePriority=${r})`);return{badge:h,displayBadge:b,readableModified:d,readableCreated:m,fileSizeLabel:n?this.Pe(t.size,a):null}}async Bi({filePath:e,resourceUri:t,stat:s,badgeDetails:i,gitBlame:r,shouldUseAccessibleTooltips:n,fileSizeFormat:a,isCodeFile:c}){let l=I(e),h=Ce(e);if(n){let b=this.h?.getAccessibleTooltip?.(e,s.mtime,s.birthtime,s.size,r);if(b)return this.e.info(`\u{1F50D} Using accessible tooltip (${b.length} chars): "${b.substring(0,50)}..."`),b;this.e.info("\u{1F50D} Accessible tooltip generation failed, using rich tooltip")}let d=`\u{1F4C4} File: ${l}
`;d+=`\u{1F4DD} Last Modified: ${i.readableModified}
`,d+=`   ${this.Mt(s.mtime)}

`,d+=`\u{1F4C5} Created: ${i.readableCreated}
`,d+=`   ${this.Mt(s.birthtime)}

`;let m=i.fileSizeLabel||this.Pe(s.size,a||"auto");if(d+=`\u{1F4CA} Size: ${m} (${s.size.toLocaleString()} bytes)
`,h&&(d+=`\u{1F3F7}\uFE0F Type: ${h.toUpperCase()} file
`),c)try{let b=t||e,W=(await this.be.readFile(b,"utf8")).split(`
`).length;d+=`\u{1F4CF} Lines: ${W.toLocaleString()}
`}catch{}return d+=`\u{1F4C2} Path: ${e}`,r&&(d+=`

\u{1F464} Last Modified By: ${r.authorName}`,r.authorEmail&&(d+=` (${r.authorEmail})`),r.authorDate&&(d+=`
   ${r.authorDate}`)),d}ji({filePath:e,stat:t,badgeDetails:s}){let i=[];s?.readableModified&&i.push(`Modified ${s.readableModified}`);let r=s?.fileSizeLabel||(t?.size?this.Pe(t.size,"auto"):null);return r&&i.push(r),`${I(e)} \u2014 ${i.filter(Boolean).join(" \u2022 ")||this.Mt(t?.mtime||new Date)}`}vs(e){let t=new Date,s=t.getTime()-e.getTime(),i=Math.floor(s/(1e3*60)),r=Math.floor(s/(1e3*60*60)),n=Math.floor(s/(1e3*60*60*24)),a=this.Li(e,t,i,r,n);return a?this.bs(this.Ne,this.qt,this.qs,a.key,a.factory,this.K):e.getFullYear()===t.getFullYear()?this.z.formatDate(e,{month:"short",day:"numeric"}):this.z.formatDate(e,{month:"short",day:"numeric",year:"numeric"})}async Vi(e,t=null){let s=await this.Qs();if(!s||typeof s.getGitBlameInfo!="function")return null;try{return await s.getGitBlameInfo(e,t)}catch(i){return this.e.warn("Git blame lookup failed",{filePath:e,message:i?.message||String(i)}),null}}Ni(e){if(this.l)return this.l.getInitials(e);if(!e||typeof e!="string")return null;let t=e.trim().split(/\s+/).filter(Boolean);return t.length===0?null:t.length===1?t[0].substring(0,2).toUpperCase():(t[0][0]+(t[1][0]||"")).substring(0,2).toUpperCase()}Ui(e){if(typeof e!="number"||isNaN(e))return null;let t=["B","K","M","G","T"],s=0,i=e;for(;i>=1024&&s<t.length-1;)i=i/1024,s++;let r=Math.round(i),n=t[s];if(r<=9)return`${r}${n}`;let a=String(r);return a.length>=2?a.slice(0,2):a}Mt(e){let t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"};return e.toLocaleString("en-US",t)}Tt(e){let t=As(_(e));return this.X?`${this.X}${ze}${t}`:t}Hi(e){if(!e||typeof e!="string")return e;let t=e.indexOf(ze);return t===-1?e:e.slice(t+ze.length)}qi(e){let t=typeof e=="string"?e:JSON.stringify(e),s=0;for(let i=0;i<t.length;i++)s=(s<<5)-s+t.charCodeAt(i),s|=0;return Math.abs(s).toString(16)}Gi(e){try{let t=e||u.workspace.getConfiguration("explorerDates"),s={dateDecorationFormat:t.get("dateDecorationFormat","smart"),showGitInfo:t.get("showGitInfo",!0),showFileSize:t.get("showFileSize",!1),fileSizeFormat:t.get("fileSizeFormat","auto"),colorScheme:t.get("colorScheme","recency"),highContrastMode:t.get("highContrastMode",!1),fadeOldFiles:t.get("fadeOldFiles",!1),fadeThreshold:t.get("fadeThreshold",72),badgePriority:t.get("badgePriority","time"),showDateDecorations:t.get("showDateDecorations",!0),excludedFolders:(t.get("excludedFolders",[])||[]).join("|"),excludedPatterns:(t.get("excludedPatterns",[])||[]).join("|"),customColors:JSON.stringify(t.get("customColors",{})),metadataVersion:2};return`ns-${this.qi(s).slice(0,8)}`}catch(t){return this.e.debug(`Failed to build cache namespace: ${t.message}`),"ns-default"}}as(e){let t=this.Gi(e);if(t&&t!==this.X){let s=this.X;return this.X=t,this.e.info(`Cache namespace updated (${s||"unset"} \u2192 ${t})`),!0}return!1}Ki(e){return e?e.code==="ENOENT"?!0:typeof e.message=="string"&&e.message.includes("ENOENT"):!1}async Ji(e,t){if(this.F>=this.I)return this.e.warn("\u{1F6AB} Rejecting operation due to high concurrency",{filePath:e,activeOps:this.F,maxOps:this.I}),null;this.me.has(e)||this.me.set(e,Promise.resolve());let i=this.me.get(e).then(async()=>{this.F++;try{return await t()}finally{this.F--}}).catch(r=>{throw this.F--,r});return this.me.set(e,i),i}Xi(){let e=Date.now();if(this.At||(this.At=e),e-this.At<3e4)return;this.At=e;let t=this.r.size||0,s=1e4,i=t/s;i>.8&&(this.e.warn("\u{1F9E0} Memory pressure detected, performing cleanup",{cacheSize:t,maxSize:s,pressure:(i*100).toFixed(1)+"%"}),this.r.clear(),this.I=Math.max(5,this.I*.5),setTimeout(()=>{this.I=20,this.e.info("\u{1F504} Restored normal concurrency limits")},6e4))}Yi(e,t){let s=Date.now()-t,i={badge:"\u26A1",tooltip:`High load mode - ${Ee.basename(e.fsPath)}`,color:new u.ThemeColor("charts.yellow")};return this.e.info("\u26A1 Created minimal decoration for high load",{file:Ee.basename(e.fsPath),processingTimeMs:s}),i}async provideFileDecoration(e,t){if(this.ut){if(!this.Vt){let a={throttleKey:"provider:disposed",throttleLimit:1,profile:"default"};typeof this.e.infoWithOptions=="function"?this.e.infoWithOptions(a,"\u{1F6AB} Provider disposed, rejecting operation"):this.e.info("\u{1F6AB} Provider disposed, rejecting operation"),this.Vt=!0}return}let s=Date.now(),i=e?.fsPath;if(!i)return;let n=u.workspace.getConfiguration("explorerDates").get("performanceMode",!1);return n&&typeof n!="boolean"?null:i&&i.includes("\0")?(this.e.warn("\u{1F6AB} Skipping file with null character in path:",i),null):this.Ji(i,async()=>{try{if(this.e.info(`\u{1F4CA} Call context: token=${!!t}, cancelled=${t?.isCancellationRequested}`),t?.isCancellationRequested||this.ut){this.e.info("\u{1F6AB} Operation cancelled early");return}if(this.F>this.I*.8)return this.e.warn("\u26A1 High load detected, switching to fast mode",{activeOps:this.F,threshold:this.I*.8}),this.Yi(e,s);if(this.Xi(),!e){this.e.error("\u274C Invalid URI provided to provideFileDecoration:",e);return}let a=_(e);if(!a){this.e.error("\u274C Could not resolve path for URI in provideFileDecoration:",e);return}let c=I(a),l=L(a),h=e.scheme||"file";if(h!=="file"){this.e.debug(`\u23ED\uFE0F Skipping decoration for ${c} (unsupported scheme: ${h})`);return}this.i||(this.e.debug(`\u{1F50D} VSCODE REQUESTED DECORATION: ${c} (${i})`),this.e.infoWithOptions(this.re,`\u{1F4CA} Call context: token=${!!t}, cancelled=${t?.isCancellationRequested}`));let d=u.workspace.getConfiguration("explorerDates"),m=(k,Ze)=>{if(this.u&&Object.prototype.hasOwnProperty.call(this.u,k)){let et=this.u[k];return this.e.debug(`\u{1F3AD} Using preview value for ${k}: ${et} (config has: ${d.get(k,Ze)})`),et}return d.get(k,Ze)};if(this.u&&this.e.infoWithOptions(this.re,`\u{1F3AD} Processing ${c} in PREVIEW MODE with settings:`,()=>this.u),!m("showDateDecorations",!0)){this.i||this.e.infoWithOptions(this.re,`\u274C RETURNED UNDEFINED: Decorations disabled globally for ${c}`);return}if(await this.xi(e)){this.i||this.e.infoWithOptions(this.re,`\u274C File excluded: ${c}`);return}this.e.debug(`\u{1F50D} Processing file: ${c}`);let b=this.wi(e);this.Re(e,{reason:"decoration-request",visible:l?this.L.has(l):!1}),b?this.s.viewportPriorityDecorations++:this.s.viewportBackgroundDecorations++;let y=this.W||this.ks(this.Ce),W=this.Tt(e);if(this.u)this.e.debug(`\u{1F504} Skipping cache due to active preview settings for: ${c}`);else{let k=await this.Ti(W,c);if(k)return k}if(this.s.cacheMisses++,this.e.debug(`\u274C Cache miss for: ${c} (key: ${W.substring(0,50)}...)`),t?.isCancellationRequested){this.e.debug(`Decoration cancelled for: ${i}`);return}let M=null;if(!b&&this.o?.incrementalIndexer){let k=this.o.incrementalIndexer.getIndexedStat(i);k&&(M=k,this.e.debug(`Indexed stat hit for ${c}`))}let Z=Date.now();if(!M){try{M=await this.be.stat(e)}catch(k){if(this.s.fileStatTimeMs+=Date.now()-Z,this.s.fileStatCalls++,this.Ki(k)){this.e.debug(`\u23ED\uFE0F Skipping decoration for ${c}: file not found (${k.message||k})`);return}throw k}this.o?.incrementalIndexer&&this.o.incrementalIndexer.primeFromStat(e,M)}if(this.s.fileStatTimeMs+=Date.now()-Z,this.s.fileStatCalls++,!(typeof M.isFile=="function"?M.isFile():!0))return;let j=Ct(M.mtime),Fe=Ct(M.birthtime||M.ctime||M.mtime),ee={mtime:j,birthtime:Fe,size:M.size},te=Date.now()-j.getTime(),V=m("dateDecorationFormat","smart"),R=this.i?"none":m("colorScheme","none"),ue=m("highContrastMode",!1),se=this.i?!1:m("showFileSize",!1),de=m("fileSizeFormat","auto"),g=m("accessibilityMode",!1),v=this.i?!1:m("fadeOldFiles",!1),A=m("fadeThreshold",30),$=this.i?"none":m("showGitInfo","none"),O=this.i?"time":m("badgePriority","time");y.enableColors||(R="none"),y.enableFileSize||(se=!1),y.enableAccessibility||(g=!1),y.enableGit||($="none"),this._&&(R="none",se=!1,g=!1,$="none",O="time"),!b&&y.applyBackgroundLimits&&(R="none",se=!1,$="none",O!=="time"&&(O="time"));let Te=($!=="none"||O==="author")&&this.gt&&!this.i&&y.enableGit,Xe=Te?$:"none";O==="author"&&!Te&&(O="time");let Ye=Te?await this.Vi(i,j.getTime()):null,fe=this.zi({filePath:i,stat:ee,diffMs:te,dateFormat:V,badgePriority:O,showFileSize:se,fileSizeFormat:de,gitBlame:Ye,showGitInfo:Xe}),Gt=Ce(i),Kt=[".js",".ts",".jsx",".tsx",".py",".rb",".php",".java",".cpp",".c",".cs",".go",".rs",".kt",".swift"].includes(Gt),Qe=g&&this.h?.shouldEnhanceAccessibility(),Me=b?y.enableRichTooltips?"rich":"summary":y.backgroundTooltipMode||"off";this.e.debug(`\u{1F50D} Tooltip generation for ${c}: accessibilityMode=${g}, shouldUseAccessible=${Qe}, preference=${Me}, previewMode=${!!this.u}`);let Y;Me==="rich"?Y=await this.Bi({filePath:i,resourceUri:e,stat:ee,badgeDetails:fe,gitBlame:Xe==="none"?null:Ye,shouldUseAccessibleTooltips:Qe,fileSizeFormat:de,isCodeFile:Kt}):Me==="summary"?Y=this.ji({filePath:i,stat:ee,badgeDetails:fe}):Y=void 0;let ie;R!=="none"&&(ie=this.k?this.k.applyThemeAwareColorScheme?.(R,i,te):this.Wi(j,R,i)),this.e.debug(`\u{1F3A8} Color scheme setting: ${R}, using color: ${ie?"yes":"no"}`);let ge=bt(fe.displayBadge)||bt(fe.badge)||"??";this.h?.shouldEnhanceAccessibility?.()&&(ge=this.h.getAccessibleBadge?.(ge)||ge);let P,z=ie;z&&(z=this.Qi(z),this.e.debug(`\u{1F3A8} Added enhanced color: ${z.id||z} (original: ${ie?.id||ie})`)),v&&Math.floor(te/864e5)>A&&(z=new u.ThemeColor("editorGutter.commentRangeForeground")),ue&&(z=new u.ThemeColor("editorWarning.foreground"),this.e.info(`\u{1F506} Applied high contrast color (overriding colorScheme=${R})`));let Ae=Y&&Y.length<500?Y:void 0;try{P=this.Ri({badge:ge,tooltip:Ae,color:z}),Ae&&this.e.debug(`\u{1F4DD} Added tooltip (${Ae.length} chars)`)}catch(k){this.e.error("\u274C Failed to create decoration:",k),P=new u.FileDecoration("!!"),P.propagate=!1}if(this.e.debug(`\u{1F3A8} Color/contrast check for ${c}: colorScheme=${R}, highContrastMode=${ue}, hasColor=${!!z}, previewMode=${!!this.u}`),this.u?this.e.debug(`\u{1F504} Skipping cache storage due to preview mode for: ${c}`):await this.Mi(W,P,c,e),this.s.totalDecorations++,this.$i(),this.Oi(),!P?.badge){this.e.error(`\u274C Decoration badge is invalid for: ${c}`);return}let Jt=Date.now()-s;return this.i||(this.e.infoWithOptions(this.re,`\u2705 Decoration created for: ${c} (badge: ${P.badge||"undefined"}) - Cache key: ${W.substring(0,30)}...`),this.e.infoWithOptions(this.re,"\u{1F3AF} RETURNING DECORATION TO VSCODE:",()=>({file:c,badge:P.badge,hasTooltip:!!P.tooltip,hasColor:!!P.color,colorType:P.color?.constructor?.name,processingTimeMs:Jt,decorationType:P.constructor.name}))),P}catch(a){this.s.errors++;let c=s?Date.now()-s:0,l=I(e),h=_(e)||"unknown-uri";this.e.error(`\u274C DECORATION ERROR for ${l}:`,{error:a.message,stack:a.stack?.split(`
`)[0],processingTimeMs:c,uri:h}),this.e.error(`\u274C CRITICAL ERROR DETAILS for ${l}: ${a.message}`),this.e.error(`\u274C Error type: ${a.constructor.name}`),this.e.error(`\u274C Full stack: ${a.stack}`),this.e.info(`\u274C RETURNED UNDEFINED: Error occurred for ${l}`);return}}).catch(a=>{this.e.error("\u{1F512} File locking error",{filePath:i,error:a.message})})}Qe(e){if(this.i||this._)return"minimal";let t="auto";try{t=((e||u.workspace.getConfiguration("explorerDates")).get("featureLevel","auto")||"auto").toLowerCase()}catch{t="auto"}if(Ne.includes(t))return t;switch(this.b){case"extreme":return"standard";case"large":return"standard";default:return"full"}}Ye(e,t="unspecified"){return!e||(Ne.includes(e)||(e="full"),this.Ce===e&&this.W)?!1:(this.Ce=e,this.W=this.ks(e),this.Y=this.W.viewportWindowMs,this.e.info(`Feature level set to "${e}" (${t})`,{viewportWindowMs:this.Y,applyBackgroundLimits:this.W.applyBackgroundLimits,backgroundTooltipMode:this.W.backgroundTooltipMode}),!0)}ks(e="full"){let t=Ne.includes(e)?e:"full";switch(t){case"enhanced":return{level:t,enableGit:!0,enableColors:!0,enableFileSize:!0,enableAccessibility:!0,enableRichTooltips:!0,applyBackgroundLimits:!0,backgroundTooltipMode:"summary",viewportWindowMs:_s};case"standard":return{level:t,enableGit:!1,enableColors:!0,enableFileSize:!1,enableAccessibility:!0,enableRichTooltips:!0,applyBackgroundLimits:!0,backgroundTooltipMode:"summary",viewportWindowMs:xt};case"minimal":return{level:t,enableGit:!1,enableColors:!1,enableFileSize:!1,enableAccessibility:!1,enableRichTooltips:!1,applyBackgroundLimits:!0,backgroundTooltipMode:"off",viewportWindowMs:xt};case"full":default:return{level:"full",enableGit:!0,enableColors:!0,enableFileSize:!0,enableAccessibility:!0,enableRichTooltips:!0,applyBackgroundLimits:!1,backgroundTooltipMode:"rich",viewportWindowMs:Dt}}}getMetrics(){let e=r=>{if(!r)return 0;let n=(r.reuses||0)+(r.allocations||0);return n?Number(((r.reuses||0)/n*100).toFixed(2)):0},t={...this.s,cacheSize:this.r.size,cacheBuckets:this.r.bucketCount,cacheHitRate:this.s.cacheHits+this.s.cacheMisses>0?(this.s.cacheHits/(this.s.cacheHits+this.s.cacheMisses)*100).toFixed(2)+"%":"0.00%",forceCacheBypass:this.Ge,decorationPoolEnabled:this.Ue,flyweightsEnabled:this.Be,lightweightMode:this._,memorySheddingEnabled:this.je,memorySheddingActive:this.He,watcherStrategy:this.N,staticWatchers:this.v.size,dynamicWatchers:this.w.size,workspaceScale:this.b,workspaceFileCount:this.rs,featureLevel:this.Ce,featureProfile:this.W,viewportWindowMs:this.Y,viewportVisibleFiles:this.L.size,viewportHistorySize:this.S.size,softHeapAlertThresholdMB:this.et};if(t.decorationPool={size:this.O.size,hits:this.f.hits,misses:this.f.misses,allocations:this.f.allocations,reuses:this.f.reuses,reusePercent:e(this.f)},t.badgeFlyweight={...this.G,cacheSize:this.ze.size,reusePercent:e(this.G)},t.readableFlyweight={...this.K,cacheSize:this.Ne.size,reusePercent:e(this.K)},t.allocationTelemetry={decorationPool:{allocations:this.f.allocations,reuses:this.f.reuses,reusePercent:e(this.f)},badgeFlyweight:{allocations:this.G.allocations,reuses:this.G.reuses,reusePercent:e(this.G)},readableFlyweight:{allocations:this.K.allocations,reuses:this.K.reuses,reusePercent:e(this.K)}},this.t&&(t.advancedCache=this.t.getStats()),this.n&&(t.batchProcessor=this.n.getMetrics()),this.o){let r=this.o.getMetrics();r.incrementalIndexer&&(t.incrementalIndexer=r.incrementalIndexer),r.smartExclusion&&(t.smartExclusion=r.smartExclusion)}let s=Array.from(this.r.keys()).slice(0,5).map(r=>this.Hi(r)),i=this.a>0?Number((this.r.size/this.a).toFixed(3)):0;return t.cacheDebugging={memoryCacheKeys:s,cacheTimeout:this.g,maxCacheSize:this.a,cacheBuckets:this.r.bucketCount,keyStatsSize:this.ts?this.ts.size:0,cacheNamespace:this.X,cacheUsageRatio:i},t.cachePressure={warned:this.tt,thresholdRatio:this.Et,usageRatio:i},t.memoryShedding={thresholdMB:this.Ve,softThresholdMB:this.et,active:this.He,events:this.Ze.slice(-5)},t.performanceTiming={avgGitBlameMs:this.s.gitBlameCalls>0?(this.s.gitBlameTimeMs/this.s.gitBlameCalls).toFixed(1):"0.0",avgFileStatMs:this.s.fileStatCalls>0?(this.s.fileStatTimeMs/this.s.fileStatCalls).toFixed(1):"0.0",totalGitBlameTimeMs:this.s.gitBlameTimeMs,totalFileStatTimeMs:this.s.fileStatTimeMs,gitBlameCalls:this.s.gitBlameCalls,fileStatCalls:this.s.fileStatCalls},t}Ds(){!this.Qt||this.J||(this.J=setTimeout(()=>{this.J=null,this.Zi(),this.Ds()},this.Zt))}Zi(){let e=this.getMetrics().allocationTelemetry,t=e.decorationPool.allocations+e.badgeFlyweight.allocations+e.readableFlyweight.allocations,s=e.decorationPool.reuses+e.badgeFlyweight.reuses+e.readableFlyweight.reuses;(t>0||s>0)&&this.e.info("\u{1F9EE} Allocation telemetry report",{timestamp:new Date().toISOString(),pool:{allocations:e.decorationPool.allocations,reuses:e.decorationPool.reuses,reuseRate:e.decorationPool.reusePercent+"%"},badgeFlyweight:{allocations:e.badgeFlyweight.allocations,reuses:e.badgeFlyweight.reuses,reuseRate:e.badgeFlyweight.reusePercent+"%"},readableFlyweight:{allocations:e.readableFlyweight.allocations,reuses:e.readableFlyweight.reuses,reuseRate:e.readableFlyweight.reusePercent+"%"},summary:{totalAllocations:t,totalReuses:s,overallReuseRate:t+s>0?(s/(t+s)*100).toFixed(1)+"%":"0%"},decorationsProcessed:this.s.totalDecorations,cacheHitRate:this.getMetrics().cacheHitRate})}async initializeAdvancedSystems(e){try{if(this.cs=e,this.Ke&&await this.er(),this.i){this.e.info("Performance mode enabled - skipping advanced cache, batch processor, and progressive loading");return}let t=H(),s=await t.advancedCache();if(s){let n=null;if(typeof s=="function")if(s.name==="createAdvancedCache")this.t=s(e),await this.t.initialize(),this.e.info("Advanced cache initialized via factory function");else try{this.t=new s(e),await this.t.initialize(),this.e.info("Advanced cache initialized via direct constructor")}catch(a){this.e.warn("Failed to instantiate AdvancedCache via direct constructor, disabling advanced cache:",a.message),this.t=null}else s.AdvancedCache?(n=s.AdvancedCache,this.t=new n(e),await this.t.initialize(),this.e.info("Advanced cache initialized via module property")):s.createAdvancedCache?(this.t=s.createAdvancedCache(e),await this.t.initialize(),this.e.info("Advanced cache initialized via module factory")):(this.e.warn("AdvancedCache module format not recognized, disabling advanced cache"),this.t=null)}else this.e.info("Advanced cache disabled by feature flag"),this.t=null;await this.St(),this.n&&(this.n.initialize(),this.e.info("Batch processor initialized"));let i=await t.workspaceIntelligence();if(i)try{let n=i.WorkspaceIntelligenceManager||i.default?.WorkspaceIntelligenceManager||i;if(typeof n=="function"){this.o=new n(this.be),await this.o.initialize({batchProcessor:this.n,extensionContext:e,enableProgressiveAnalysis:this.us()});let a=u.workspace.workspaceFolders;a?.length&&await this.o.analyzeWorkspace(a,{maxFiles:this.hs()}),await this.o.cleanupWorkspaceProfiles(),this.e.info("Workspace intelligence initialized")}else this.e.warn("WorkspaceIntelligenceManager not found in chunk, disabling workspace intelligence"),this.o=null}catch(n){this.e.warn("Failed to initialize workspace intelligence:",n.message),this.o=null}else this.e.info("Workspace intelligence disabled by feature flag"),this.o=null;u.workspace.getConfiguration("explorerDates").get("autoThemeAdaptation",!0)&&this.k?.autoConfigureForTheme&&(await this.k.autoConfigureForTheme(),this.e.info("Theme integration configured")),this.h?.shouldEnhanceAccessibility?.()&&(await this.h.applyAccessibilityRecommendations?.(),this.e.info("Accessibility recommendations applied")),this.Qt&&(this.Ds(),this.e.info("Allocation telemetry enabled - reports every",this.Zt,"ms")),this.e.info("Advanced systems initialized successfully")}catch(t){this.e.error("Failed to initialize advanced systems",t)}}async er(){if(!this.Yt){this.Yt=!0;try{let e=this.cs?.globalState,t=Ps.WEB_GIT_NOTICE;if(e?.get(t,!1))return;if(e?.update)try{await e.update(t,!0)}catch(i){this.e.debug("Failed to persist Git limitation notice flag",i)}Promise.resolve().then(()=>{u.window.showInformationMessage("Explorer Dates: Git attribution badges are unavailable on VS Code for Web. Time-based decorations remain available.")})}catch(e){this.e.debug("Failed to display Git limitation notice",e)}}}Qi(e){let t={"charts.yellow":"list.warningForeground","charts.red":"list.errorForeground","charts.green":"list.highlightForeground","charts.blue":"symbolIcon.functionForeground","charts.purple":"symbolIcon.classForeground","charts.orange":"list.warningForeground","terminal.ansiYellow":"list.warningForeground","terminal.ansiGreen":"list.highlightForeground","terminal.ansiRed":"list.errorForeground","terminal.ansiBlue":"symbolIcon.functionForeground","terminal.ansiMagenta":"symbolIcon.classForeground","terminal.ansiCyan":"symbolIcon.stringForeground","editorGutter.commentRangeForeground":"list.deemphasizedForeground","editorWarning.foreground":"list.warningForeground","editorError.foreground":"list.errorForeground","editorInfo.foreground":"list.highlightForeground"},s=e.id||e,i=t[s];return i?(this.e.debug(`\u{1F527} Enhanced color ${s} \u2192 ${i} for better selection visibility`),new u.ThemeColor(i)):e}ot(e,t,s){if(!e||typeof e[t]!="function")return this.e.debug(`Event API unavailable: ${t}`),null;try{return e[t](s)}catch(i){return this.e.debug(`Failed to register listener (${t})`,i),null}}async dispose(){this.B||(this.B=!0,this.ut=!0,this.mt++,this.e.info("Disposing FileDateDecorationProvider",this.getMetrics()),this.me.clear(),this.js.clear(),this.F=0,this.D&&(clearInterval(this.D),this.D=null,this.e.info("Cleared periodic refresh timer")),this.ce(),this.t&&await this.t.dispose(),this.nt(),this.n&&this.n.dispose(),this.h&&typeof this.h.dispose=="function"&&this.h.dispose(),this.o&&this.o.dispose(),this.mi(),this.r.clear(),this.ae("dispose"),this.l&&(this.l.dispose(),this.l=null),this.E.dispose(),this.pt&&(this.pt.dispose(),this.pt=null),this.U&&(clearTimeout(this.U),this.U=null),this.J&&(clearTimeout(this.J),this.J=null),this.st({permanent:!0}),this.Dt(),this.gi(),this.c&&(this.c.dispose(),this.c=null))}};St.exports={FileDateDecorationProvider:Ve}});var Tt=E((exports,module)=>{var vscode=require("vscode"),{fileSystem}=ne(),{getFileName,getRelativePath}=we(),{ensureDate}=oe(),isWeb=!0,childProcess=null;function loadChildProcess(){return!childProcess&&!isWeb&&(childProcess=eval("require")("child_process")),childProcess}function registerCoreCommands({context:o,fileDateProvider:e,logger:t,l10n:s}){let i=[];i.push(vscode.commands.registerCommand("explorerDates.refreshDateDecorations",()=>{try{if(e){e.clearAllCaches(),e.refreshAll();let r=s?.getString("refreshSuccess")||"Date decorations refreshed - all caches cleared";vscode.window.showInformationMessage(r),t.info("Date decorations refreshed manually with cache clear")}}catch(r){t.error("Failed to refresh decorations",r),vscode.window.showErrorMessage(`Failed to refresh decorations: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.previewConfiguration",r=>{try{e&&(e.applyPreviewSettings(r),t.info("Configuration preview applied",r))}catch(n){t.error("Failed to apply configuration preview",n)}})),i.push(vscode.commands.registerCommand("explorerDates.clearPreview",()=>{try{e&&(e.applyPreviewSettings(null),t.info("Configuration preview cleared"))}catch(r){t.error("Failed to clear configuration preview",r)}})),i.push(vscode.commands.registerCommand("explorerDates.showMetrics",async()=>{try{if(e){let r=e.getMetrics(),n=`Explorer Dates Metrics:
Total Decorations: ${r.totalDecorations}
Cache Size: ${r.cacheSize}
Cache Hits: ${r.cacheHits}
Cache Misses: ${r.cacheMisses}
Cache Hit Rate: ${r.cacheHitRate}
Errors: ${r.errors}`;r.advancedCache&&(n+=`

Advanced Cache:
Memory Items: ${r.advancedCache.memoryItems}
Memory Usage: ${(r.advancedCache.memoryUsage/1024/1024).toFixed(2)} MB
Memory Hit Rate: ${r.advancedCache.memoryHitRate}
Disk Hit Rate: ${r.advancedCache.diskHitRate}
Evictions: ${r.advancedCache.evictions}`),r.batchProcessor&&(n+=`

Batch Processor:
Queue Length: ${r.batchProcessor.queueLength}
Is Processing: ${r.batchProcessor.isProcessing}
Average Batch Time: ${r.batchProcessor.averageBatchTime.toFixed(2)}ms`),await vscode.window.showInformationMessage(n,{modal:!0},"View Rich Analytics")==="View Rich Analytics"&&await vscode.commands.executeCommand("explorerDates.showPerformanceAnalytics"),t.info("Metrics displayed",r)}}catch(r){t.error("Failed to show metrics",r),vscode.window.showErrorMessage(`Failed to show metrics: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.openLogs",()=>{try{t.show()}catch(r){t.error("Failed to open logs",r),vscode.window.showErrorMessage(`Failed to open logs: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.showCurrentConfig",()=>{try{let r=vscode.workspace.getConfiguration("explorerDates"),n={highContrastMode:r.get("highContrastMode"),badgePriority:r.get("badgePriority"),colorScheme:r.get("colorScheme"),accessibilityMode:r.get("accessibilityMode"),dateDecorationFormat:r.get("dateDecorationFormat"),showGitInfo:r.get("showGitInfo"),showFileSize:r.get("showFileSize")},a=`Current Explorer Dates Configuration:

${Object.entries(n).map(([c,l])=>`${c}: ${JSON.stringify(l)}`).join(`
`)}`;vscode.window.showInformationMessage(a,{modal:!0}),t.info("Current configuration displayed",n)}catch(r){t.error("Failed to show configuration",r)}})),i.push(vscode.commands.registerCommand("explorerDates.resetToDefaults",async()=>{try{let r=vscode.workspace.getConfiguration("explorerDates");await r.update("highContrastMode",!1,vscode.ConfigurationTarget.Global),await r.update("badgePriority","time",vscode.ConfigurationTarget.Global),await r.update("accessibilityMode",!1,vscode.ConfigurationTarget.Global),vscode.window.showInformationMessage("Reset high contrast, badge priority, and accessibility mode to defaults. Changes should take effect immediately."),t.info("Reset problematic settings to defaults"),e&&(e.clearAllCaches(),e.refreshAll())}catch(r){t.error("Failed to reset settings",r),vscode.window.showErrorMessage(`Failed to reset settings: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.toggleDecorations",()=>{try{let r=vscode.workspace.getConfiguration("explorerDates"),n=r.get("showDateDecorations",!0);r.update("showDateDecorations",!n,vscode.ConfigurationTarget.Global);let a=n?s?.getString("decorationsDisabled")||"Date decorations disabled":s?.getString("decorationsEnabled")||"Date decorations enabled";vscode.window.showInformationMessage(a),t.info(`Date decorations toggled to: ${!n}`)}catch(r){t.error("Failed to toggle decorations",r),vscode.window.showErrorMessage(`Failed to toggle decorations: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.copyFileDate",async r=>{try{let n=r;if(!n&&vscode.window.activeTextEditor&&(n=vscode.window.activeTextEditor.document.uri),!n){vscode.window.showWarningMessage("No file selected");return}let a=await fileSystem.stat(n),c=ensureDate(a.mtime).toLocaleString();await vscode.env.clipboard.writeText(c),vscode.window.showInformationMessage(`Copied to clipboard: ${c}`),t.info(`File date copied for: ${n.fsPath||n.path}`)}catch(n){t.error("Failed to copy file date",n),vscode.window.showErrorMessage(`Failed to copy file date: ${n.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.showFileDetails",async r=>{try{let n=r;if(!n&&vscode.window.activeTextEditor&&(n=vscode.window.activeTextEditor.document.uri),!n){vscode.window.showWarningMessage("No file selected");return}let a=await fileSystem.stat(n),c=getFileName(n.fsPath||n.path),l=e?.Pe(a.size,"auto")||`${a.size} bytes`,h=ensureDate(a.mtime).toLocaleString(),d=ensureDate(a.birthtime||a.mtime).toLocaleString(),m=`File: ${c}
Size: ${l}
Modified: ${h}
Created: ${d}
Path: ${n.fsPath||n.path}`;vscode.window.showInformationMessage(m,{modal:!0}),t.info(`File details shown for: ${n.fsPath||n.path}`)}catch(n){t.error("Failed to show file details",n),vscode.window.showErrorMessage(`Failed to show file details: ${n.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.toggleFadeOldFiles",()=>{try{let r=vscode.workspace.getConfiguration("explorerDates"),n=r.get("fadeOldFiles",!1);r.update("fadeOldFiles",!n,vscode.ConfigurationTarget.Global);let a=n?"Fade old files disabled":"Fade old files enabled";vscode.window.showInformationMessage(a),t.info(`Fade old files toggled to: ${!n}`)}catch(r){t.error("Failed to toggle fade old files",r),vscode.window.showErrorMessage(`Failed to toggle fade old files: ${r.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.showFileHistory",async r=>{try{if(isWeb){vscode.window.showInformationMessage("Git history is unavailable on VS Code for Web.");return}let n=r;if(!n&&vscode.window.activeTextEditor&&(n=vscode.window.activeTextEditor.document.uri),!n){vscode.window.showWarningMessage("No file selected");return}let a=vscode.workspace.getWorkspaceFolder(n);if(!a){vscode.window.showWarningMessage("File is not in a workspace");return}let l=`git log --oneline -10 -- "${getRelativePath(a.uri.fsPath||a.uri.path,n.fsPath||n.path)}"`;loadChildProcess().exec(l,{cwd:a.uri.fsPath,timeout:3e3},(d,m)=>{if(d){d.message.includes("not a git repository")?vscode.window.showWarningMessage("This file is not in a Git repository"):vscode.window.showErrorMessage(`Git error: ${d.message}`);return}if(!m.trim()){vscode.window.showInformationMessage("No Git history found for this file");return}let b=m.trim(),y=getFileName(n.fsPath||n.path);vscode.window.showInformationMessage(`Recent commits for ${y}:

${b}`,{modal:!0})}),t.info(`File history requested for: ${n.fsPath||n.path}`)}catch(n){t.error("Failed to show file history",n),vscode.window.showErrorMessage(`Failed to show file history: ${n.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.compareWithPrevious",async r=>{try{if(isWeb){vscode.window.showInformationMessage("Git comparisons are unavailable on VS Code for Web.");return}let n=r;if(!n&&vscode.window.activeTextEditor&&(n=vscode.window.activeTextEditor.document.uri),!n){vscode.window.showWarningMessage("No file selected");return}if(!vscode.workspace.getWorkspaceFolder(n)){vscode.window.showWarningMessage("File is not in a workspace");return}await vscode.commands.executeCommand("git.openChange",n),t.info(`Git diff opened for: ${n.fsPath||n.path}`)}catch(n){t.error("Failed to compare with previous version",n),vscode.window.showErrorMessage(`Failed to compare with previous version: ${n.message}`)}})),i.push(vscode.commands.registerCommand("explorerDates.applyCustomColors",async()=>{try{let n=vscode.workspace.getConfiguration("explorerDates").get("customColors",{veryRecent:"#00ff00",recent:"#ffff00",old:"#ff0000"}),a=`To use custom colors with Explorer Dates, add the following to your settings.json:

"workbench.colorCustomizations": {
  "explorerDates.customColor.veryRecent": "${n.veryRecent}",
  "explorerDates.customColor.recent": "${n.recent}",
  "explorerDates.customColor.old": "${n.old}"
}

Also set: "explorerDates.colorScheme": "custom"`,c=await vscode.window.showInformationMessage("Custom colors configuration",{modal:!0,detail:a},"Copy to Clipboard","Open Settings");if(c==="Copy to Clipboard"){let l=`"workbench.colorCustomizations": {
  "explorerDates.customColor.veryRecent": "${n.veryRecent}",
  "explorerDates.customColor.recent": "${n.recent}",
  "explorerDates.customColor.old": "${n.old}"
}`;await vscode.env.clipboard.writeText(l),vscode.window.showInformationMessage("Custom color configuration copied to clipboard")}else c==="Open Settings"&&await vscode.commands.executeCommand("workbench.action.openSettings","workbench.colorCustomizations");t.info("Custom colors help displayed")}catch(r){t.error("Failed to apply custom colors",r),vscode.window.showErrorMessage(`Failed to apply custom colors: ${r.message}`)}})),i.forEach(r=>o.subscriptions.push(r))}module.exports={registerCoreCommands}});var At=E((Si,Mt)=>{var U=require("vscode");function Ns({context:o,logger:e,getOnboardingManager:t}){let s=[];s.push(U.commands.registerCommand("explorerDates.showFeatureTour",async()=>{try{let i=await t();if(!i){U.window.showWarningMessage("Onboarding system unavailable.");return}await i.showFeatureTour(),e.info("Feature tour opened")}catch(i){e.error("Failed to show feature tour",i),U.window.showErrorMessage(`Failed to show feature tour: ${i.message}`)}})),s.push(U.commands.registerCommand("explorerDates.showQuickSetup",async()=>{try{let i=await t();if(!i){U.window.showWarningMessage("Onboarding system unavailable.");return}await i.showQuickSetupWizard(),e.info("Quick setup wizard opened")}catch(i){e.error("Failed to show quick setup wizard",i),U.window.showErrorMessage(`Failed to show quick setup wizard: ${i.message}`)}})),s.push(U.commands.registerCommand("explorerDates.showWhatsNew",async()=>{try{let i=await t();if(!i){U.window.showWarningMessage("Onboarding system unavailable.");return}let r=o.extension.packageJSON.version;await i.showWhatsNew(r),e.info("What's new panel opened")}catch(i){e.error("Failed to show what's new",i),U.window.showErrorMessage(`Failed to show what's new: ${i.message}`)}})),s.forEach(i=>o.subscriptions.push(i))}Mt.exports={registerOnboardingCommands:Ns}});var Rt=E((Fi,$t)=>{var f=require("vscode");function Us({context:o,logger:e,getSettingsMigrationManager:t}){let s=[];return s.push(f.commands.registerCommand("explorerDates.migrateSettings",async()=>{try{let i=await t();if(!i){f.window.showWarningMessage("Settings migration system unavailable.");return}f.window.showInformationMessage("Checking for settings that need migration...");let r=await i.migrateAllSettings(o);r.length===0?f.window.showInformationMessage("\u2705 All settings are up to date!"):f.window.showInformationMessage(`\u2705 Migrated ${r.length} setting(s) successfully.`),e.info("Manual settings migration completed",{results:r})}catch(i){e.error("Failed to run settings migration",i),f.window.showErrorMessage(`Failed to migrate settings: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.validateConfiguration",async()=>{try{let i=await t();if(!i){f.window.showWarningMessage("Settings validation system unavailable.");return}let r=await i.validateConfiguration();if(r.length===0)f.window.showInformationMessage("\u2705 Configuration is valid - no issues found!");else{let n=`Found ${r.length} configuration issue(s). Would you like to see details?`;await f.window.showWarningMessage(n,"Show Details","Dismiss")==="Show Details"&&await Bs(r)}e.info("Configuration validation completed",{issuesFound:r.length,issues:r})}catch(i){e.error("Failed to validate configuration",i),f.window.showErrorMessage(`Failed to validate configuration: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.cleanLegacySettings",async()=>{try{let i=await t();if(!i){f.window.showWarningMessage("Settings migration system unavailable.");return}let r=await i.cleanupDeprecatedSettings();r?f.window.showInformationMessage("\u2705 Deprecated settings have been cleaned up!"):f.window.showInformationMessage("\u2139\uFE0F No deprecated settings found to clean up."),e.info("Legacy settings cleanup completed",{cleaned:r})}catch(i){e.error("Failed to clean legacy settings",i),f.window.showErrorMessage(`Failed to clean legacy settings: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.showMigrationHistory",async()=>{try{let i=await t();if(!i){f.window.showWarningMessage("Settings migration system unavailable.");return}let r=i.getMigrationHistory(o);if(r.length===0){f.window.showInformationMessage("No migration history found.");return}await js(r),e.info("Displayed migration history",{historyLength:r.length})}catch(i){e.error("Failed to show migration history",i),f.window.showErrorMessage(`Failed to show migration history: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.applyCustomColors",async()=>{try{let i=await f.window.showQuickPick([{label:"Copy to Clipboard",description:"Copy color configuration to clipboard"},{label:"Open Settings",description:"Open VS Code settings to workbench.colorCustomizations"},{label:"Apply Default Colors",description:"Apply default Explorer Dates colors"}],{placeHolder:"How would you like to set up custom colors?",ignoreFocusOut:!0});if(!i)return;let r={"explorerDates.customColor.veryRecent":"#00ff00","explorerDates.customColor.recent":"#ffff00","explorerDates.customColor.old":"#ff0000"};switch(i.label){case"Copy to Clipboard":let n=JSON.stringify({"workbench.colorCustomizations":r},null,2);await f.env.clipboard.writeText(n),f.window.showInformationMessage("Color configuration copied to clipboard!");break;case"Open Settings":await f.commands.executeCommand("workbench.action.openSettings","workbench.colorCustomizations");break;case"Apply Default Colors":let a=f.workspace.getConfiguration("workbench"),l={...a.get("colorCustomizations",{}),...r};await a.update("colorCustomizations",l,f.ConfigurationTarget.Global),await f.workspace.getConfiguration("explorerDates").update("colorScheme","custom",f.ConfigurationTarget.Global),f.window.showInformationMessage("\u2705 Custom colors applied successfully!");break}e.info("Custom colors command executed",{action:i.label})}catch(i){e.error("Failed to apply custom colors",i),f.window.showErrorMessage(`Failed to apply custom colors: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.resetToDefaults",async()=>{try{if(await f.window.showWarningMessage("This will reset all Explorer Dates settings to their default values. Are you sure?",{modal:!0},"Reset Settings","Cancel")!=="Reset Settings")return;let r=f.workspace.getConfiguration("explorerDates"),a=o.extension.packageJSON?.contributes?.configuration?.properties||{},c=0;for(let l of Object.keys(a))if(l.startsWith("explorerDates.")){let h=l.replace("explorerDates.","");try{await r.update(h,void 0,f.ConfigurationTarget.Global),await r.update(h,void 0,f.ConfigurationTarget.Workspace),c++}catch(d){e.warn(`Failed to reset setting ${h}`,d)}}f.window.showInformationMessage(`\u2705 Reset ${c} settings to defaults.`),e.info("Settings reset to defaults",{resetCount:c})}catch(i){e.error("Failed to reset settings to defaults",i),f.window.showErrorMessage(`Failed to reset settings: ${i.message}`)}})),s.push(f.commands.registerCommand("explorerDates.exportConfiguration",async()=>{try{let i=f.workspace.getConfiguration("explorerDates"),r={},a=o.extension.packageJSON?.contributes?.configuration?.properties||{};for(let h of Object.keys(a))if(h.startsWith("explorerDates.")){let d=h.replace("explorerDates.",""),m=i.get(d);m!==void 0&&(r[h]=m)}let c=JSON.stringify(r,null,2),l=await f.window.showQuickPick([{label:"Copy to Clipboard",description:"Copy configuration to clipboard"},{label:"Save to File",description:"Save configuration to a JSON file"}],{placeHolder:"How would you like to export the configuration?"});if(!l)return;switch(l.label){case"Copy to Clipboard":await f.env.clipboard.writeText(c),f.window.showInformationMessage("Configuration copied to clipboard!");break;case"Save to File":let h=await f.window.showSaveDialog({defaultUri:f.Uri.file("explorer-dates-config.json"),filters:{JSON:["json"]}});h&&(await f.workspace.fs.writeFile(h,Buffer.from(c,"utf8")),f.window.showInformationMessage(`Configuration saved to ${h.fsPath}`));break}e.info("Configuration exported",{action:l.label,settingsCount:Object.keys(r).length})}catch(i){e.error("Failed to export configuration",i),f.window.showErrorMessage(`Failed to export configuration: ${i.message}`)}})),s}async function Bs(o){let e=f.window.createWebviewPanel("explorerDatesConfigIssues","Explorer Dates - Configuration Issues",f.ViewColumn.One,{enableScripts:!1}),t=o.map(s=>`
        <div class="issue">
            <h3><code>${s.setting}</code></h3>
            <p><strong>Current value:</strong> <code>${JSON.stringify(s.value)}</code></p>
            <p><strong>Issue:</strong> ${s.message}</p>
        </div>
    `).join("");e.webview.html=`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Configuration Issues</title>
            <style>
                body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; }
                h1 { color: #d73a49; }
                .issue { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; margin: 10px 0; border-radius: 5px; }
                .issue h3 { margin-top: 0; color: #856404; }
                code { background: #f5f5f5; padding: 2px 4px; border-radius: 3px; }
            </style>
        </head>
        <body>
            <h1>\u26A0\uFE0F Configuration Issues Found</h1>
            ${t}
            <p><strong>To fix these issues:</strong> Open VS Code Settings and update the highlighted settings with valid values.</p>
        </body>
        </html>
    `}async function js(o){let e=f.window.createWebviewPanel("explorerDatesMigrationHistory","Explorer Dates - Migration History",f.ViewColumn.One,{enableScripts:!1}),t=o.slice().reverse().map((s,i)=>`
        <div class="migration-record">
            <h3>Migration #${o.length-i}</h3>
            <p><strong>Date:</strong> ${new Date(s.timestamp).toLocaleString()}</p>
            <p><strong>Extension Version:</strong> ${s.extensionVersion}</p>
            <p><strong>Settings Migrated:</strong></p>
            <ul>
                ${s.migratedSettings.map(r=>`<li><code>${r}</code></li>`).join("")}
            </ul>
        </div>
    `).join("");e.webview.html=`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Migration History</title>
            <style>
                body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; }
                h1 { color: #007ACC; }
                .migration-record { background: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; margin: 15px 0; border-radius: 5px; }
                .migration-record h3 { margin-top: 0; color: #495057; }
                code { background: #e9ecef; padding: 2px 4px; border-radius: 3px; }
                ul { line-height: 1.6; }
            </style>
        </head>
        <body>
            <h1>\u{1F4DC} Settings Migration History</h1>
            ${t}
        </body>
        </html>
    `}$t.exports={registerMigrationCommands:Us}});var Pt=E((exports,module)=>{var vscode=require("vscode"),fs=null,path=null;try{typeof process<"u"&&process.versions?.node}catch{fs=null,path=null}var textDecoder=typeof globalThis.TextDecoder=="function"?new globalThis.TextDecoder("utf-8"):new(require("util")).TextDecoder("utf-8"),TemplateStore=class{constructor(){this.$t=new Map,this.Rt=null}initialize(e){this.Rt=e?.extensionUri??null}async getTemplate(e){if(this.$t.has(e))return this.$t.get(e);let t=await this.tr(e);return this.$t.set(e,t),t}async tr(e){let t=`${e}.html`;if(this.Rt){let s=vscode.Uri.joinPath(this.Rt,"assets","templates",t),i=await vscode.workspace.fs.readFile(s);return textDecoder.decode(i)}if(fs&&path){let s=path.resolve(__dirname,"..","..","assets","templates",t);return await fs.promises.readFile(s,"utf8")}throw new Error(`TemplateStore: Unable to load template "${e}" (missing extension context)`)}},templateStore=new TemplateStore;module.exports={templateStore,initializeTemplateStore:o=>templateStore.initialize(o)}});var Ot=E((Ti,It)=>{var D=require("vscode"),{getLogger:Vs}=N(),He=class{constructor(){this.e=Vs(),this.y=new Set}async migrateAllSettings(e){let t=[()=>this.migrateReportingSettings(),()=>this.migrateCustomColorSettings(),()=>this.validateFeatureFlags(),()=>this.cleanupDeprecatedSettings(),()=>this.trackMigrationMetrics(e)],s=[];for(let i of t)try{let r=await i();r&&s.push(r)}catch(r){this.e.error("Settings migration failed:",r)}return s.length>0&&(this.e.info("Settings migration completed",{migratedSettings:s}),this.sr(s)),s}async migrateReportingSettings(){let e=D.workspace.getConfiguration("explorerDates"),t=e.inspect("enableReporting"),s=e.inspect("enableExportReporting");if(t?.globalValue!==void 0&&s?.globalValue===void 0)try{await e.update("enableExportReporting",t.globalValue,D.ConfigurationTarget.Global),this.y.add("enableReporting\u2192enableExportReporting (Global)"),this.e.info("Migrated global enableReporting to enableExportReporting",{oldValue:t.globalValue})}catch(i){this.e.error("Failed to migrate global enableReporting setting",i)}if(t?.workspaceValue!==void 0&&s?.workspaceValue===void 0)try{await e.update("enableExportReporting",t.workspaceValue,D.ConfigurationTarget.Workspace),this.y.add("enableReporting\u2192enableExportReporting (Workspace)"),this.e.info("Migrated workspace enableReporting to enableExportReporting",{oldValue:t.workspaceValue})}catch(i){this.e.error("Failed to migrate workspace enableReporting setting",i)}if(t?.workspaceFolderValue!==void 0&&s?.workspaceFolderValue===void 0)try{await e.update("enableExportReporting",t.workspaceFolderValue,D.ConfigurationTarget.WorkspaceFolder),this.y.add("enableReporting\u2192enableExportReporting (WorkspaceFolder)"),this.e.info("Migrated workspace folder enableReporting to enableExportReporting",{oldValue:t.workspaceFolderValue})}catch(i){this.e.error("Failed to migrate workspace folder enableReporting setting",i)}return this.y.has("enableReporting\u2192enableExportReporting (Global)")||this.y.has("enableReporting\u2192enableExportReporting (Workspace)")||this.y.has("enableReporting\u2192enableExportReporting (WorkspaceFolder)")}async migrateCustomColorSettings(){let t=D.workspace.getConfiguration("explorerDates").get("customColors");if(!t||typeof t!="object")return!1;let s=D.workspace.getConfiguration("workbench"),i=s.get("colorCustomizations",{});if(i["explorerDates.customColor.veryRecent"]!==void 0||i["explorerDates.customColor.recent"]!==void 0||i["explorerDates.customColor.old"]!==void 0)return!1;let n={...i,"explorerDates.customColor.veryRecent":t.veryRecent||"#00ff00","explorerDates.customColor.recent":t.recent||"#ffff00","explorerDates.customColor.old":t.old||"#ff0000"};try{return await s.update("colorCustomizations",n,D.ConfigurationTarget.Global),this.y.add("customColors\u2192workbench.colorCustomizations"),this.e.info("Migrated custom colors to workbench.colorCustomizations",{oldColors:t,newColors:n}),!0}catch(a){return this.e.error("Failed to migrate custom colors",a),!1}}async validateFeatureFlags(){let e=D.workspace.getConfiguration("explorerDates"),t={enableOnboardingSystem:{default:!0,type:"boolean"},enableExportReporting:{default:!0,type:"boolean"},enableAnalysisCommands:{default:!0,type:"boolean"},enableAdvancedCache:{default:!0,type:"boolean"},enableWorkspaceIntelligence:{default:!0,type:"boolean"},enableWorkspaceTemplates:{default:!0,type:"boolean"},enableExtensionApi:{default:!0,type:"boolean"},enableProgressiveAnalysis:{default:null,type:"boolean",allowNull:!0}},s=!1,i=[],r=[];for(let[n,a]of Object.entries(t)){let c=e.inspect(n),l=e.get(n),h=c?.globalValue!==void 0,d=c?.workspaceValue!==void 0;if(!h&&!d)r.push(n);else if(l!==void 0&&!(a.allowNull&&l===null?!0:typeof l===a.type))try{await e.update(n,a.default,D.ConfigurationTarget.Global),i.push(`${n}: corrected type mismatch`),s=!0}catch(b){this.e.error(`Failed to fix feature flag ${n}`,b)}}return s?(this.y.add("featureFlags\u2192validated"),this.e.info("Validated feature flags",{fixes:i})):r.length>0&&this.e.info("Feature flags relying on defaults (no migration needed)",{flags:r}),s}async cleanupDeprecatedSettings(){let e=D.workspace.getConfiguration("explorerDates"),t=["customColors","enableReporting"],s=[];for(let r of t){let n=e.inspect(r);(n?.globalValue!==void 0||n?.workspaceValue!==void 0||n?.workspaceFolderValue!==void 0)&&s.push(r)}if(s.length===0)return!1;if(await D.window.showInformationMessage(`Explorer Dates found ${s.length} deprecated setting(s). Would you like to remove them?`,{modal:!1},"Clean Up Now","Keep Old Settings","Ask Later")==="Clean Up Now"){for(let r of s)try{await e.update(r,void 0,D.ConfigurationTarget.Global),await e.update(r,void 0,D.ConfigurationTarget.Workspace),await e.update(r,void 0,D.ConfigurationTarget.WorkspaceFolder),this.e.info(`Removed deprecated setting: ${r}`)}catch(n){this.e.error(`Failed to remove deprecated setting ${r}`,n)}return this.y.add("deprecatedSettings\u2192removed"),!0}return!1}async trackMigrationMetrics(e){if(this.y.size===0)return!1;let t=e.globalState.get("explorerDates.migrationHistory",[]),s={timestamp:new Date().toISOString(),extensionVersion:e.extension.packageJSON.version,migratedSettings:Array.from(this.y)};return t.push(s),t.length>5&&t.splice(0,t.length-5),await e.globalState.update("explorerDates.migrationHistory",t),this.e.info("Recorded migration metrics",s),!0}async sr(e){let s=`Explorer Dates updated ${e.length} setting(s) for compatibility. Your configuration has been preserved.`;switch(await D.window.showInformationMessage(s,{modal:!1},"View Changes","Open Settings")){case"View Changes":await this.ir();break;case"Open Settings":await D.commands.executeCommand("workbench.action.openSettings","explorerDates");break}}async ir(){let e=D.window.createWebviewPanel("explorerDatesMigration","Explorer Dates - Settings Migration",D.ViewColumn.One,{enableScripts:!1}),t=Array.from(this.y).map(s=>`<li><code>${s}</code></li>`).join("");e.webview.html=`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Settings Migration</title>
                <style>
                    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; }
                    h1 { color: #007ACC; }
                    code { background: #f5f5f5; padding: 2px 4px; border-radius: 3px; }
                    ul { line-height: 1.6; }
                    .info { background: #e3f2fd; padding: 15px; border-radius: 5px; margin: 10px 0; }
                </style>
            </head>
            <body>
                <h1>\u{1F527} Settings Migration Completed</h1>
                
                <div class="info">
                    <strong>Good news!</strong> Explorer Dates automatically updated your settings to use the latest configuration options. Your preferences have been preserved.
                </div>

                <h2>Changes Made:</h2>
                <ul>
                    ${t}
                </ul>

                <h2>What This Means:</h2>
                <ul>
                    <li><strong>enableReporting \u2192 enableExportReporting:</strong> Consolidated naming for consistency</li>
                    <li><strong>customColors \u2192 workbench.colorCustomizations:</strong> Uses VS Code's standard color system</li>
                    <li><strong>Feature flags validated:</strong> Ensures proper types and values</li>
                    <li><strong>Deprecated settings cleaned:</strong> Removes unused configuration</li>
                </ul>

                <h2>Next Steps:</h2>
                <ul>
                    <li>Your extension will continue working as before</li>
                    <li>Check VS Code Settings if you want to customize further</li>
                    <li>Run "Explorer Dates: Validate Configuration" anytime to check for issues</li>
                </ul>
            </body>
            </html>
        `}async validateConfiguration(){let e=[],t=D.workspace.getConfiguration("explorerDates"),s=[{setting:"dateDecorationFormat",validate:i=>["smart","relative-short","relative-long","absolute-short","absolute-long"].includes(i),message:"Invalid date decoration format"},{setting:"colorScheme",validate:i=>["none","recency","file-type","subtle","vibrant","custom"].includes(i),message:"Invalid color scheme"},{setting:"badgePriority",validate:i=>["time","author","size"].includes(i),message:"Invalid badge priority"},{setting:"maxCacheSize",validate:i=>typeof i=="number"&&i>=100&&i<=5e4,message:"Cache size must be between 100 and 50,000"},{setting:"cacheTimeout",validate:i=>typeof i=="number"&&i>=5e3&&i<=3e5,message:"Cache timeout must be between 5,000 and 300,000 milliseconds"}];for(let i of s){let r=t.get(i.setting);r!==void 0&&!i.validate(r)&&e.push({setting:i.setting,value:r,message:i.message})}return e}getMigrationHistory(e){return e.globalState.get("explorerDates.migrationHistory",[])}};It.exports={SettingsMigrationManager:He}});var Lt=E((Mi,_t)=>{var B=require("vscode"),{getLogger:Hs}=N(),qe=Hs();function qs(o,e="default"){if(!o)return`unknown-workspace-${e}`;let t=o.fsPath||o.path||"",s=t.split("/").pop()||"workspace",i=Math.abs(t.split("").reduce((n,a)=>(n=(n<<5)-n+a.charCodeAt(0),n&n),0)).toString(36).substr(0,8),r=Math.abs(e.split("").reduce((n,a)=>(n=(n<<5)-n+a.charCodeAt(0),n&n),0)).toString(36).substr(0,4);return`${s}-${i}-${r}`}async function Gs(o){try{if(!o)return"unknown";let t=(await B.workspace.findFiles("**/*",null,50001)).length,s="small";t>=5e4?s="extreme":t>=1e4?s="large":t>=1e3&&(s="medium");let i=B.env.remoteName,r=B.env.uiKind===B.UIKind.Web;if(s==="extreme"||s==="large"&&(i||r))return"minimal";if(s==="large"||i||r)return"balanced";try{let a=(await B.workspace.fs.readDirectory(o)).map(([c])=>c.toLowerCase());if(a.includes("package.json")||a.includes("yarn.lock"))return"web-development";if(a.some(c=>c.endsWith(".ipynb"))||a.includes("requirements.txt"))return"data-science";if(a.includes("docker-compose.yml")||a.includes(".enterprise"))return"enterprise"}catch(n){qe.debug("Project type detection failed:",n)}return"full"}catch(e){return qe.error("Workspace profile detection failed:",e),"unknown"}}async function Ks(o){if(!o)return null;try{let t=(await B.workspace.findFiles("**/*",null,50001)).length,s="small";t>=5e4?s="extreme":t>=1e4?s="large":t>=1e3&&(s="medium");let i=!!B.env.remoteName,r=B.env.uiKind===B.UIKind.Web;return{workspaceSize:s,fileCount:t,remoteType:r?"web":i?"remote":"local",isRemoteEnvironment:i||r,timestamp:Date.now()}}catch(e){return qe.error("Workspace environment analysis failed:",e),null}}_t.exports={generateWorkspaceKey:qs,detectWorkspaceProfile:Gs,analyzeWorkspaceEnvironment:Ks}});var Nt=E((Ai,zt)=>{var F=require("vscode"),{getLogger:Js}=N(),{generateWorkspaceKey:Xs,detectWorkspaceProfile:Ys,analyzeWorkspaceEnvironment:Ge}=Lt(),{PRESET_DEFINITIONS:xe,calculateBundleSize:Qs,getDefaultPresetForProfile:Zs,RESTART_REQUIRED_SETTINGS:Wt}=ae(),ce=Js(),Ke=class{constructor(e){this.xs=e,this.V=e.globalState,this.p=null,this.le=null,this.Ie="explorerDates.pendingRestart",this.Ss="explorerDates.suggestionHistory",this.Ct(),ce.info("Runtime configuration manager initialized")}async getCurrentRuntimeState(){let e=F.workspace.getConfiguration("explorerDates"),t=this.Oe(e),s=this.M(null,t),i=F.workspace.workspaceFolders?.[0]?.uri,r=await Ge(i);return{currentSettings:t,currentBundleSize:s,analysis:r,availablePresets:Object.keys(xe),pendingRestart:this.V.get(this.Ie,[]),timestamp:Date.now()}}async checkAutoSuggestion(){try{let e=F.workspace.workspaceFolders?.[0]?.uri;if(!e)return;let t=await Ys(e),s=Xs(e,t),i=this.V.get(this.Ss,{}),r=i[s];if(!r||r.profileDetected!==t||await this.rr(r)){let a=await this.or(t);if(a){let c=await Ge(e);i[s]={profileDetected:t,suggestedAt:Date.now(),fileCountAtSuggestion:c?.fileCount||0,accepted:a.accepted,presetId:a.preset},await this.V.update(this.Ss,i),ce.info("Auto-suggestion updated:",i[s])}}}catch(e){ce.error("Auto-suggestion check failed:",e)}}async or(e){let t=this.Oe(F.workspace.getConfiguration("explorerDates")),s=Zs(e),i=this.M(null,t),r=s?this.M(s.settings,t):i,n=i-r;if(n<=10)return{accepted:!1,preset:e,reason:"minimal savings"};let a=`Explorer Dates detected a ${e} workspace. Would you like to apply ${s.name} settings? This could save ~${n}KB.`;switch(await F.window.showInformationMessage(a,{modal:!1},"Apply Settings","Show Details","Not Now")){case"Apply Settings":return await this.Pt(s.id),{accepted:!0,preset:e};case"Show Details":return await this.showPresetComparison(t,s),{accepted:!1,preset:e};default:return{accepted:!1,preset:e}}}async Pt(e){let t=xe[e];if(!t)throw new Error(`Unknown preset: ${e}`);let s=F.workspace.getConfiguration(),i=[];for(let[r,n]of Object.entries(t.settings))s.get(r)!==n&&(await s.update(r,n,F.ConfigurationTarget.Workspace),i.push(r.replace("explorerDates.","")));return i.length>0&&(this.Fs(i),ce.info(`Applied ${t.name} preset`,{changedSettings:i})),{applied:i.length,preset:t,requiresRestart:i.some(r=>Wt.has(r)),estimatedBundleSize:this.M()}}async showPresetComparison(e,t){let s=e||this.Oe(F.workspace.getConfiguration("explorerDates")),i=this.M(null,s),r=t?this.M(t.settings,s):i,n=i-r,a=[{label:"\u{1F4E6} Current Configuration",description:`Bundle: ${i}KB total`,detail:this.Ts(s),action:"current"},t?{label:`\u26A1 Recommended: ${t.name}`,description:`Bundle: ${r}KB total (saves ${Math.max(0,n)}KB)`,detail:this.Ts(t.settings),action:"apply",preset:t}:null,{label:"\u{1F527} Browse All Presets...",description:`Choose from ${Object.keys(xe).length} available presets`,detail:"Minimal, Balanced, Web Development, Enterprise, Data Science",action:"browse"}].filter(Boolean),c=await F.window.showQuickPick(a,{placeHolder:"Choose configuration approach",ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0});if(c)switch(c.action){case"apply":c.preset&&await this.Pt(c.preset.id);break;case"browse":await this.showAllPresets();break}}async showAllPresets(){let e=this.Oe(F.workspace.getConfiguration("explorerDates")),t=this.M(null,e),s=Object.values(xe).map(r=>{let n=this.M(r.settings,e),a=t-n,c=a>0?`saves ${a}KB`:a<0?`adds ${Math.abs(a)}KB`:"same size";return{label:`${r.name}`,description:`${n}KB (${c})`,detail:`${r.description} - ${r.targetScenarios.join(", ")}`,preset:r}}),i=await F.window.showQuickPick(s,{placeHolder:"Select a preset configuration",ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0});i?.preset&&await F.window.showInformationMessage(`Apply "${i.preset.name}" preset?
${i.preset.description}`,{modal:!1},"Apply","Cancel")==="Apply"&&await this.Pt(i.preset.id)}Ct(){this.p=F.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorerDates")&&this.nr(e)})}async nr(e){let t=Array.from(Wt).filter(s=>e.affectsConfiguration(`explorerDates.${s}`));t.length>0&&this.Fs(t)}Fs(e){let t=this.V.get(this.Ie,[]),s=[...new Set([...t,...e])];this.V.update(this.Ie,s),this.le&&clearTimeout(this.le),this.le=setTimeout(async()=>{await this.ar(),this.le=null},2e3)}async ar(){let e=this.V.get(this.Ie,[]);if(e.length===0)return;let t=e.map(n=>this.cr(n)).join(", "),i=`${e.length===1?`"${t}"`:`${e.length} settings (${t})`} changed. Reload to apply chunk optimizations?`;await F.window.showInformationMessage(i,{modal:!1},"Reload Now","Reload Later")==="Reload Now"&&await F.commands.executeCommand("workbench.action.reloadWindow"),await this.V.update(this.Ie,[])}M(e=null,t=null){let s=t?{...t}:this.Oe(F.workspace.getConfiguration("explorerDates"));return e&&typeof e=="object"&&Object.assign(s,e),Qs(s)}Oe(e){let t={enableOnboardingSystem:!0,enableAnalysisCommands:!0,enableExportReporting:!0,enableExtensionApi:!0,enableWorkspaceTemplates:!0,enableAdvancedCache:!0,enableWorkspaceIntelligence:!0,enableIncrementalWorkers:!1},s={};for(let[i,r]of Object.entries(t))s[`explorerDates.${i}`]=e.get(i,r);return s}Ts(e){let t=Object.entries(e).filter(([r,n])=>n===!0&&r.includes("enable")).map(([r])=>r.replace("explorerDates.enable","").replace("System","")).slice(0,3),s=Math.max(0,Object.keys(e).length-3),i=s>0?` +${s} more`:"";return`Features: ${t.join(", ")}${i}`}cr(e){return e.replace("enable","").replace(/([A-Z])/g," $1").trim()}async rr(e){if(!e)return!0;try{let t=F.workspace.workspaceFolders?.[0]?.uri,s=await Ge(t);if(!s)return!1;let i=e.fileCountAtSuggestion||0,r=s.fileCount,n=this.Ms(i),a=this.Ms(r);return n!==a}catch(t){return ce.debug("Heuristics change check failed:",t),!1}}Ms(e){return e>=5e4?"extreme":e>=1e4?"large":e>=1e3?"medium":"small"}dispose(){this.p&&this.p.dispose(),this.le&&clearTimeout(this.le)}};zt.exports={RuntimeConfigManager:Ke}});var Bt=E(($i,Ut)=>{var p=require("vscode"),{getLogger:ei}=N(),{fileSystem:ti}=ne(),{CHUNK_SIZES:si}=ae(),w=ei(),le="1.0.0",ii="explorerDates.teamConfig.backup",Se={"explorerDates.enableOnboardingSystem":"onboarding","explorerDates.enableAnalysisCommands":"analysisCommands","explorerDates.enableExportReporting":"exportReporting","explorerDates.enableExtensionApi":"extensionApi","explorerDates.enableWorkspaceTemplates":"workspaceTemplates","explorerDates.enableAdvancedCache":"advancedCache","explorerDates.enableWorkspaceIntelligence":"workspaceIntelligence","explorerDates.enableIncrementalWorkers":"incrementalWorkers"},ri={onboarding:"Onboarding System",analysisCommands:"Analysis Commands",exportReporting:"Export Reporting",extensionApi:"Extension API",workspaceTemplates:"Workspace Templates",advancedCache:"Advanced Cache",workspaceIntelligence:"Workspace Intelligence",incrementalWorkers:"Incremental Workers"},Je=class{constructor(e){this.xs=e,this.A=ti,this.H=".explorer-dates-profiles.json",this.q=null,this.It=null,this.Ot=null,this.$=new Map,this.p=null,this.he=null,w.info("Team persistence manager initialized with full functionality")}async validateTeamConfiguration(){try{let e=p.workspace.workspaceFolders?.[0]?.uri;if(!e)return{valid:!0,conflicts:[],hasTeamConfig:!1};let t=p.Uri.joinPath(e,this.H);if(!await this._t(t))return w.debug("No team configuration file found"),{valid:!0,conflicts:[],hasTeamConfig:!1};let i=await this.As(t);if(!i)return{valid:!0,conflicts:[],hasTeamConfig:!1};let r=await this.lr(i);return r.length>0&&await this.$s(r),{valid:r.length===0,conflicts:r,hasTeamConfig:!0,teamConfig:i}}catch(e){return w.error("Team configuration validation failed:",e),{valid:!0,conflicts:[],error:e.message}}}async $s(e){let t=e.length,s=`Found ${t} conflict${t>1?"s":""} between team configuration and your personal settings.`;switch(await p.window.showWarningMessage(s,"Show Details","Use Team Config","Keep My Settings")){case"Show Details":await this.hr(e);break;case"Use Team Config":await this.ur();break;case"Keep My Settings":await this.dr(e);break}}async As(e){try{let t=this.ue(e),s;if(this.$.has(t))s=this.$.get(t),w.debug("Loaded team configuration from ephemeral storage");else{let r;try{r=await this.A.readFile(e,"utf8")}catch(n){if(n?.code==="ENOENT")return w.debug("Team configuration file not found on disk"),null;throw n}if(typeof r=="string"&&r.trim().startsWith("// virtual content"))return w.debug("Team configuration file placeholder detected (treated as missing)"),null;try{s=JSON.parse(r)}catch{throw new Error("Team configuration file is not valid JSON.")}}let i=this.gr(s);return i.version!==le&&w.warn(`Team configuration schema mismatch. Expected ${le}, received ${i.version}`),this.q=i,this.It=e,this.Ot=this.at(i),w.debug("Loaded team configuration",{profileCount:Object.keys(i.profiles||{}).length}),i}catch(t){if(t?.code==="ENOENT")return w.debug("Team configuration file not found during load"),null;throw w.error("Failed to load team configuration:",t),t}}async lr(e){let t=this.at(e);if(!t)return[];let s=e.profiles?.[t];if(!s||!s.settings)return[];let i=p.workspace.getConfiguration(),r=[];for(let[n,a]of Object.entries(s.settings)){let c=i.inspect(n);if(!c||!(c.workspaceValue!==void 0||c.globalValue!==void 0))continue;let h=c.workspaceValue!==void 0?c.workspaceValue:c.globalValue;if(this.Rs(h,a))continue;let d={key:n,profileId:t,teamValue:a,userValue:h,source:c.workspaceValue!==void 0?"workspace":"global",impact:this.pr(n,a,h),chunkEffect:this.mr(n,a)};r.push(d)}return r.sort((n,a)=>{let c={high:3,medium:2,low:1};return(c[a.impact]||0)-(c[n.impact]||0)}),w.debug("Detected team configuration conflicts",{conflictCount:r.length}),r}async saveTeamProfiles(e){let t=p.workspace.workspaceFolders?.[0]?.uri;if(!t)throw new Error("No workspace folders available for team profiles");let s=p.Uri.joinPath(t,this.H),i=Object.keys(e),r={version:le,createdAt:new Date().toISOString(),defaultProfile:i[0]||null,profiles:e,metadata:{extensionVersion:this.Ps(),vscodeVersion:p.version}};try{await this.A.ensureDirectory(t)}catch(n){if(!this.Is(n))throw n;w.warn("Workspace directory is not writable; continuing with ephemeral storage",{code:n.code}),(n.code==="EACCES"||n.code==="EPERM")&&p.window.showWarningMessage("Explorer Dates team configuration cannot be saved due to file permissions. Configuration will be stored temporarily and may be lost when VS Code restarts. Contact your administrator to enable write access to the workspace folder.","Understood")}try{return await this.wr(s,r),this.q=r,this.It=s,this.Ot=this.at(r),w.info("Saved team profiles",{profileCount:Object.keys(e).length}),s}catch(n){throw w.error("Failed to save team profiles:",n),new Error(`Failed to save team profiles: ${n.message}`)}}async loadTeamProfiles(e=!1){let t=p.workspace.workspaceFolders?.[0]?.uri;if(!t)return null;let s=p.Uri.joinPath(t,this.H);try{return(await this.As(s))?.profiles??null}catch(i){return i.code==="FileNotFound"||(e||(i.message.includes("not valid JSON")||i.message.includes("JSON parsing failed")?p.window.showErrorMessage("Explorer Dates team configuration file appears to be corrupted. Please check the .explorer-dates-profiles.json file or restore from backup.","Show File Location").then(r=>{r==="Show File Location"&&p.commands.executeCommand("revealInExplorer",s)}):i.code==="TIMEOUT"||i.message.includes("timed out")||i.name==="NetworkError"&&i.message.includes("fetch failed")?p.window.showErrorMessage("Explorer Dates team configuration could not be loaded due to network timeout. Please check your connection and try again.","Retry").then(r=>{r==="Retry"&&this.loadTeamProfiles(!0)}):(i.code==="EACCES"||i.code==="EPERM")&&p.window.showWarningMessage("Explorer Dates team configuration cannot be accessed due to file permissions. Contact your administrator to enable read access to the workspace folder.")),w.error("Failed to load team profiles:",i)),null}}async hasTeamConfiguration(){let e=p.workspace.workspaceFolders?.[0]?.uri;if(!e)return!1;let t=p.Uri.joinPath(e,this.H),s=this.ue(t);return this.$.has(s)?!0:await this._t(t)}async createTeamProfile(e,t){let{name:s,description:i="",settings:r={},metadata:n={}}=t;if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");if(!s||typeof s!="string")throw new Error("Profile name must be a non-empty string");this.Lt(r);let a=await this.loadTeamProfiles(!0)||{};if(a[e])throw new Error(`Profile with ID '${e}' already exists`);let c={name:s,description:i,settings:r,metadata:{createdAt:new Date().toISOString(),createdBy:p.env.uriScheme==="vscode-insiders"?"vscode-insiders":"vscode",extensionVersion:this.Ps(),...n}},l={...a,[e]:c};return await this.saveTeamProfiles(l),w.info("Created team profile",{profileId:e,name:s}),c}async updateTeamProfile(e,t){if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");let s=await this.loadTeamProfiles(!0)||{};if(!s[e])throw new Error(`Profile with ID '${e}' does not exist`);let i=s[e];t.settings&&this.Lt(t.settings);let r={...i,...t,metadata:{...i.metadata,...t.metadata,updatedAt:new Date().toISOString(),updatedBy:p.env.uriScheme==="vscode-insiders"?"vscode-insiders":"vscode"}},n={...s,[e]:r};return await this.saveTeamProfiles(n),w.info("Updated team profile",{profileId:e,changes:Object.keys(t)}),r}async deleteTeamProfile(e){if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");let t=await this.loadTeamProfiles(!0)||{};if(!t[e])throw new Error(`Profile with ID '${e}' does not exist`);let{[e]:s,...i}=t;if(Object.keys(i).length===0){let r=p.workspace.workspaceFolders?.[0]?.uri;if(r){let n=p.Uri.joinPath(r,this.H),a=this.ue(n);this.$.delete(a);try{await this.A.delete(n),w.info("Deleted team configuration file (no profiles remaining)")}catch(c){w.warn("Could not delete team configuration file",{error:c.message})}}}else await this.saveTeamProfiles(i);return w.info("Deleted team profile",{profileId:e,name:s.name}),s}async listTeamProfiles(e={}){let t=await this.loadTeamProfiles(!0)||{},s=Object.entries(t).map(([n,a])=>({id:n,...a})),i=s;if(e.namePattern){let n=new RegExp(e.namePattern,"i");i=i.filter(a=>n.test(a.name))}if(e.hasSettings){let n=Array.isArray(e.hasSettings)?e.hasSettings:[e.hasSettings];i=i.filter(a=>n.every(c=>a.settings&&c in a.settings))}if(e.createdAfter){let n=new Date(e.createdAfter);i=i.filter(a=>a.metadata?.createdAt&&new Date(a.metadata.createdAt)>n)}let r=e.sortBy||"createdAt";return i.sort((n,a)=>{if(r==="createdAt"){let c=n.metadata?.createdAt?new Date(n.metadata.createdAt):new Date(0);return(a.metadata?.createdAt?new Date(a.metadata.createdAt):new Date(0)).getTime()-c.getTime()}else if(r==="name")return n.name.localeCompare(a.name);return 0}),w.debug("Listed team profiles",{total:s.length,filtered:i.length,filters:e}),i}async resolveConflictsAutomatically(e,t="prompt"){if(!Array.isArray(e)||e.length===0)return{resolved:0,skipped:0,errors:[]};let s={resolved:0,skipped:0,errors:[]};for(let i of e)try{let r=!1;switch(t){case"team-wins":r=!0;break;case"user-wins":r=!1;break;case"high-impact-only":r=i.impact==="high";break;case"chunks-only":r=!!i.chunkEffect;break;case"prompt":default:let n=await p.window.showQuickPick([{label:"Apply Team Value",value:!0},{label:"Keep My Value",value:!1},{label:"Skip This Setting",value:null}],{placeHolder:`Resolve conflict for ${i.key}`,ignoreFocusOut:!0});if(!n){s.skipped++;continue}if(n.value===null){s.skipped++;continue}r=n.value;break}r?(await this.Os(i.key,i.teamValue),s.resolved++,w.info("Auto-resolved conflict",{key:i.key,strategy:t,action:"applied-team-value"})):t!=="prompt"&&(s.skipped++,w.debug("Skipped conflict resolution",{key:i.key,strategy:t,action:"kept-user-value"}))}catch(r){s.errors.push({key:i.key,error:r.message}),w.error("Failed to resolve conflict",{key:i.key,error:r.message})}return w.info("Completed automatic conflict resolution",s),s}async hr(e){if(!e||e.length===0){p.window.showInformationMessage("No Explorer Dates conflicts to review.");return}let t=e.map(r=>({label:r.key,description:`Team: ${this.fe(r.teamValue)} | You: ${this.fe(r.userValue)}`,detail:`${r.chunkEffect||"UI setting change"} \xB7 Impact: ${r.impact}`,conflict:r})),s=await p.window.showQuickPick(t,{placeHolder:"Review team configuration conflicts",ignoreFocusOut:!0});if(!s)return;await p.window.showInformationMessage(`Apply team value for "${s.conflict.key}"?`,"Apply Team Value","Keep My Value")==="Apply Team Value"&&(await this.Os(s.conflict.key,s.conflict.teamValue),p.window.showInformationMessage(`Updated ${s.conflict.key} to match team configuration.`))}async ur(){if(!this.q){p.window.showWarningMessage("No team configuration is loaded. Validate the team config first.");return}let e=this.at(this.q),t=e?this.q.profiles?.[e]:null;if(!t||!t.settings){p.window.showWarningMessage("Team configuration is missing an active profile.");return}let s=p.workspace.getConfiguration(),i={},r=[];for(let[n,a]of Object.entries(t.settings)){let c=s.inspect(n),l=c?.workspaceValue??c?.globalValue??c?.defaultValue;i[n]=l,!this.Rs(l,a)&&(await s.update(n,a,p.ConfigurationTarget.Workspace),r.push(n))}r.length>0?(await this.xs?.workspaceState?.update(ii,{appliedAt:new Date().toISOString(),profileId:e,settings:i}),p.window.showInformationMessage(`Applied ${r.length} Explorer Dates settings from team profile "${t.name}".`)):p.window.showInformationMessage("Your settings already match the selected team profile.")}async dr(e){if(!e||e.length===0){p.window.showInformationMessage("No overrides to document.");return}let t=this.br();if(!t){w.warn("Cannot document overrides without a workspace.");return}let s=p.Uri.joinPath(t,".vscode"),i=p.Uri.joinPath(s,"explorer-dates-overrides.md");await this.A.ensureDirectory(s);let r="";await this._t(i)?(r=await this.A.readFile(i,"utf8"),r.includes("# Explorer Dates Override Notes")||(r=`# Explorer Dates Override Notes

${r.trimStart()}`)):r=`# Explorer Dates Override Notes

`;let n=this.yr(e);await this.A.writeFile(i,`${r}${n}
`,"utf8"),p.window.showInformationMessage("Documented Explorer Dates overrides in .vscode/explorer-dates-overrides.md")}async _t(e){let t=this.ue(e);if(this.$.has(t))return!0;try{return await this.A.stat(e),!0}catch{return!1}}Ps(){try{return p.extensions.getExtension("your.extension-id")?.packageJSON?.version||"unknown"}catch{return"unknown"}}at(e){if(!e?.profiles)return null;let{activeProfile:t,defaultProfile:s,profiles:i}=e;return t&&i[t]?t:s&&i[s]?s:Object.keys(i)[0]||null}Rs(e,t){if(e===t)return!0;if(typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}fe(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="object")try{return JSON.stringify(e)}catch{return"[object]"}return String(e)}pr(e,t,s){return Se[e]?typeof t=="boolean"?"high":"medium":typeof t=="boolean"&&typeof s=="boolean"?"medium":"low"}mr(e,t){let s=Se[e];if(!s)return null;let i=ri[s]||s,r=si[s]||0;return`${i} chunk will be ${t?"enabled":"disabled"}${r?` (${r}KB)`:""}`}async Os(e,t){await p.workspace.getConfiguration().update(e,t,p.ConfigurationTarget.Workspace)}br(){return p.workspace.workspaceFolders?.[0]?.uri??null}yr(e){let t=[`## ${new Date().toISOString()}`,"","| Setting | Team Value | Your Value | Impact | Notes |","| --- | --- | --- | --- | --- |"];for(let s of e){let i=[];s.chunkEffect&&i.push(s.chunkEffect);let r=s.reason||s.overrideReason;r&&i.push(`Reason: ${r}`);let n=s.userChoice||s.choice;n&&i.push(`User choice: ${n}`);let a=i.length>0?i.join(" \u2022 "):"n/a";t.push(`| \`${s.key}\` | ${this.fe(s.teamValue)} | ${this.fe(s.userValue)} | ${s.impact} | ${a} |`)}t.push("");for(let s of e){t.push(`## Setting: ${s.key}`),t.push(`- Team value: ${this.fe(s.teamValue)}`),t.push(`- Your value: ${this.fe(s.userValue)}`),(s.userChoice||s.choice)&&t.push(`- User choice: ${s.userChoice||s.choice}`);let i=s.reason||s.overrideReason;i&&t.push(`- Reason: ${i}`),s.chunkEffect&&t.push(`- Chunk impact: ${s.chunkEffect}`),t.push("")}return t.push(""),t.join(`
`)}gr(e){if(!e||typeof e!="object")throw new Error("Team configuration file is empty or invalid.");let{profiles:t}=e;if(!t||typeof t!="object"||Object.keys(t).length===0)throw new Error("Team configuration must include at least one profile.");let s={};for(let[i,r]of Object.entries(t)){if(!r||typeof r!="object")continue;let n=typeof r.settings=="object"?r.settings:{};s[i]={id:i,name:r.name||i,description:r.description||"",priority:r.priority||"normal",chunks:Array.isArray(r.chunks)?r.chunks:[],settings:n,metadata:r.metadata||{}}}if(Object.keys(s).length===0)throw new Error("Team configuration profiles are malformed.");return{version:e.version||le,defaultProfile:e.defaultProfile||Object.keys(s)[0],activeProfile:e.activeProfile,profiles:s,metadata:e.metadata||{},createdAt:e.createdAt||null,updatedAt:e.updatedAt||null}}Lt(e){if(!e||typeof e!="object")throw new Error("Settings must be a valid object");let t=new Set(Object.keys(Se)),s=new Set(["explorerDates.dateFormat","explorerDates.showFileAge","explorerDates.colorizeByAge","explorerDates.excludePatterns","explorerDates.maxCacheSize","explorerDates.refreshInterval"]),i=new Set([...t,...s]),r=[],n=[];for(let a of Object.keys(e))i.has(a)||(a.startsWith("explorerDates.")?n.push(a):r.push(a));if(r.length>0)throw new Error(`Invalid settings detected: ${r.join(", ")}. Settings must start with 'explorerDates.'`);n.length>0&&w.warn("Unrecognized Explorer Dates settings in team profile",{keys:n});for(let[a,c]of Object.entries(e))this.Cr(a,c)}Cr(e,t){let s=new Set(Object.keys(Se));if(s.add("explorerDates.showFileAge"),s.add("explorerDates.colorizeByAge"),s.has(e)&&typeof t!="boolean")throw new Error(`Setting '${e}' must be a boolean value, got ${typeof t}`);if(e==="explorerDates.dateFormat"&&(typeof t!="string"||t.trim().length===0))throw new Error(`Setting '${e}' must be a non-empty string`);if(e==="explorerDates.excludePatterns"){if(!Array.isArray(t))throw new Error(`Setting '${e}' must be an array of patterns`);for(let r of t)if(typeof r!="string")throw new Error(`Exclude pattern must be a string, got ${typeof r}`)}if(new Set(["explorerDates.maxCacheSize","explorerDates.refreshInterval"]).has(e)&&(typeof t!="number"||t<0))throw new Error(`Setting '${e}' must be a non-negative number, got ${t}`)}async exportTeamConfiguration(e="json",t={}){let s=this.q;if(!s)throw new Error("No team configuration is currently loaded");let{includeMetadata:i=!0,prettify:r=!0}=t,n={...s};switch(i||(delete n.metadata,n.profiles=Object.fromEntries(Object.entries(n.profiles).map(([a,c])=>{let{metadata:l,...h}=c;return[a,h]}))),e.toLowerCase()){case"json":return JSON.stringify(n,null,r?2:0);case"yaml":return this.Er(n);case"vscode-settings":let a={};for(let c of Object.values(n.profiles))Object.assign(a,c.settings);return JSON.stringify(a,null,r?2:0);case"csv":return this.vr(n);default:throw new Error(`Unsupported export format: ${e}`)}}async importTeamConfiguration(e,t="json",s={}){let{validate:i=!0,merge:r=!1}=s,n;try{switch(t.toLowerCase()){case"json":n=JSON.parse(e);break;case"vscode-settings":let a=JSON.parse(e);n=this.kr(a);break;default:throw new Error(`Unsupported import format: ${t}`)}}catch(a){throw new Error(`Failed to parse ${t} data: ${a.message}`)}if(i&&this.Dr(n),r){let a=await this.loadTeamProfiles(!0)||{};n.profiles={...a,...n.profiles}}return await this.saveTeamProfiles(n.profiles),w.info("Imported team configuration",{format:t,profileCount:Object.keys(n.profiles).length,merge:r}),n}startTeamConfigWatcher(){this.p&&this.p.dispose();let e=p.workspace.workspaceFolders?.[0]?.uri;if(!e){w.warn("Cannot start team config watcher without workspace");return}let t=p.Uri.joinPath(e,this.H),s=new p.RelativePattern(e,this.H);this.p=p.workspace.createFileSystemWatcher(s),this.p.onDidCreate(async i=>{w.info("Team configuration file created, revalidating"),await this.Wt(i,"created")}),this.p.onDidChange(async i=>{w.info("Team configuration file changed, revalidating"),await this.Wt(i,"changed")}),this.p.onDidDelete(async i=>{w.info("Team configuration file deleted"),await this.Wt(i,"deleted")}),w.info("Started team configuration file watcher")}stopTeamConfigWatcher(){this.p&&(this.p.dispose(),this.p=null,w.info("Stopped team configuration file watcher"))}async Wt(e,t){try{if(t==="deleted"){this.q=null,this.It=null,this.Ot=null,p.window.showInformationMessage("Explorer Dates team configuration was removed.","Understood");return}this.he&&clearTimeout(this.he),this.he=setTimeout(async()=>{try{let s=await this.validateTeamConfiguration();s.hasTeamConfig&&s.conflicts.length>0?p.window.showInformationMessage(`Explorer Dates team configuration updated with ${s.conflicts.length} conflicts detected.`,"Review Conflicts","Ignore").then(i=>{i==="Review Conflicts"&&this.$s(s.conflicts)}):s.hasTeamConfig&&p.window.showInformationMessage("Explorer Dates team configuration updated successfully.","Understood")}catch(s){w.error("Failed to handle team config change",s),p.window.showErrorMessage(`Explorer Dates team configuration update failed: ${s.message}`)}},1e3)}catch(s){w.error("Error handling team config change",s)}}Er(e){let t=[],s=(i,r=0)=>{let n="  ".repeat(r);for(let[a,c]of Object.entries(i))if(c==null)t.push(`${n}${a}: null`);else if(typeof c=="object"&&!Array.isArray(c))t.push(`${n}${a}:`),s(c,r+1);else if(Array.isArray(c)){t.push(`${n}${a}:`);for(let l of c)t.push(`${n}  - ${JSON.stringify(l)}`)}else t.push(`${n}${a}: ${JSON.stringify(c)}`)};return s(e),t.join(`
`)}vr(e){let t=[];t.push("Profile ID,Profile Name,Setting Key,Setting Value,Description");for(let[s,i]of Object.entries(e.profiles)){let r=i.name||s,n=i.description||"";if(i.settings&&Object.keys(i.settings).length>0)for(let[a,c]of Object.entries(i.settings)){let l=[s,r,a,typeof c=="string"?c:JSON.stringify(c),n].map(h=>`"${String(h).replace(/"/g,'""')}"`).join(",");t.push(l)}else{let a=[s,r,"","",n].map(c=>`"${String(c).replace(/"/g,'""')}"`).join(",");t.push(a)}}return t.join(`
`)}kr(e){let t={};for(let[s,i]of Object.entries(e))s.startsWith("explorerDates.")&&(t[s]=i);if(Object.keys(t).length===0)throw new Error("No Explorer Dates settings found in VS Code settings");return{version:le,defaultProfile:"imported",profiles:{imported:{name:"Imported Configuration",description:"Configuration imported from VS Code settings",settings:t,metadata:{importedAt:new Date().toISOString(),source:"vscode-settings"}}},metadata:{importedAt:new Date().toISOString(),source:"vscode-settings"}}}Dr(e){if(!e||typeof e!="object")throw new Error("Imported data must be a valid object");if(!e.profiles||typeof e.profiles!="object")throw new Error("Imported data must contain a profiles object");let t=Object.keys(e.profiles).length;if(t===0)throw new Error("Imported data must contain at least one profile");for(let[s,i]of Object.entries(e.profiles)){if(!i||typeof i!="object")throw new Error(`Profile '${s}' is invalid`);if(!i.name||typeof i.name!="string")throw new Error(`Profile '${s}' must have a valid name`);if(i.settings)try{this.Lt(i.settings)}catch(r){throw new Error(`Profile '${s}' has invalid settings: ${r.message}`)}}w.info("Validated imported team configuration",{profileCount:t})}dispose(){this.stopTeamConfigWatcher(),this.he&&(clearTimeout(this.he),this.he=null),this.$.clear(),w.info("Team persistence manager disposed")}ue(e){return e?typeof e=="string"?e:e.fsPath||e.path||String(e):""}Is(e){if(!e)return!1;let t=new Set(["EACCES","EPERM","EROFS","ENOENT"]);return process.env.EXPLORER_DATES_TEST_MODE==="1"&&t.has(e.code)}async wr(e,t){let s=JSON.stringify(t,null,2);try{await this.A.writeFile(e,s,"utf8"),this.$.delete(this.ue(e))}catch(i){if(this.Is(i)){let r=JSON.parse(s);this.$.set(this.ue(e),r),w.warn("Stored team configuration in ephemeral memory due to filesystem restriction",{code:i.code});return}throw i.code==="ENOSPC"?p.window.showErrorMessage("Explorer Dates team configuration cannot be saved - disk is full. Free up some space and try again.","Understood"):(i.code==="EACCES"||i.code==="EPERM")&&p.window.showErrorMessage("Explorer Dates team configuration cannot be saved due to insufficient permissions. Contact your administrator to enable write access.","Understood"),i}}};Ut.exports={TeamConfigPersistenceManager:Je}});var Vt=E((Ri,jt)=>{var T=require("vscode"),{getLogger:oi}=N(),{RuntimeConfigManager:ni}=Nt(),{TeamConfigPersistenceManager:ai}=Bt(),X=oi();function ci(o){let e=new ni(o),t=new ai(o);return[T.commands.registerCommand("explorerDates.applyPreset",async()=>{try{await e.showAllPresets()}catch(i){X.error("Apply preset command failed:",i),T.window.showErrorMessage(`Failed to apply preset: ${i.message}`)}}),T.commands.registerCommand("explorerDates.configureRuntime",async()=>{try{let i=await e.getCurrentRuntimeState();await e.showPresetComparison(i.currentSettings)}catch(i){X.error("Configure runtime command failed:",i),T.window.showErrorMessage(`Failed to show runtime configuration: ${i.message}`)}}),T.commands.registerCommand("explorerDates.suggestOptimalPreset",async()=>{try{await e.checkAutoSuggestion()}catch(i){X.error("Suggest optimal preset command failed:",i),T.window.showErrorMessage(`Failed to suggest preset: ${i.message}`)}}),T.commands.registerCommand("explorerDates.showChunkStatus",async()=>{try{let i=await e.getCurrentRuntimeState();await li(i)}catch(i){X.error("Show chunk status command failed:",i),T.window.showErrorMessage(`Failed to show chunk status: ${i.message}`)}}),T.commands.registerCommand("explorerDates.optimizeBundle",async()=>{try{let i=await e.getCurrentRuntimeState();if(i.analysis){let r=ui(i.analysis);await e.showPresetComparison(i.currentSettings,r)}else await e.showAllPresets()}catch(i){X.error("Optimize bundle command failed:",i),T.window.showErrorMessage(`Failed to optimize bundle: ${i.message}`)}}),T.commands.registerCommand("explorerDates.validateTeamConfig",async()=>{try{let i=await t.validateTeamConfiguration();if(i.hasTeamConfig){let r=i.conflicts.length>0?`Found ${i.conflicts.length} conflicts.`:"No conflicts detected.";T.window.showInformationMessage(`Team configuration validated. ${r}`)}else T.window.showInformationMessage("No team configuration found in workspace.")}catch(i){X.error("Validate team config command failed:",i),T.window.showErrorMessage(`Failed to validate team configuration: ${i.message}`)}})].forEach(i=>o.subscriptions.push(i)),X.info("Runtime management commands registered"),{runtimeManager:e,teamPersistenceManager:t}}async function li(o){let e=T.workspace.getConfiguration("explorerDates"),s=[{name:"Onboarding System",key:"enableOnboardingSystem",size:34},{name:"Analysis Commands",key:"enableAnalysisCommands",size:23},{name:"Export Reporting",key:"enableExportReporting",size:17},{name:"Extension API",key:"enableExtensionApi",size:15},{name:"Workspace Templates",key:"enableWorkspaceTemplates",size:14},{name:"Advanced Cache",key:"enableAdvancedCache",size:28},{name:"Workspace Intelligence",key:"enableWorkspaceIntelligence",size:31},{name:"Incremental Workers",key:"enableIncrementalWorkers",size:19}].map(i=>{let r=e.get(i.key,!0),n=r?"\u2705":"\u274C",a=r?"Enabled":"Disabled";return{label:`${n} ${i.name}`,description:`${i.size}KB | ${a}`,detail:hi(i.key)}});s.unshift({label:"\u{1F4CA} Bundle Summary",description:`Total: ${o.currentBundleSize}KB`,detail:`Base bundle: 99KB + ${o.currentBundleSize-99}KB chunks`}),await T.window.showQuickPick(s,{placeHolder:"Current chunk status",ignoreFocusOut:!0})}function hi(o){return{enableOnboardingSystem:"Welcome messages and guided setup",enableAnalysisCommands:"Advanced file analysis and metrics",enableExportReporting:"CSV/JSON export and reporting features",enableExtensionApi:"Public API for other extensions",enableWorkspaceTemplates:"Project templates and scaffolding",enableAdvancedCache:"Intelligent caching and performance",enableWorkspaceIntelligence:"Smart workspace analysis and insights",enableIncrementalWorkers:"Background processing and optimization"}[o]||"Explorer Dates feature chunk"}function ui(o){if(!o)return null;let{workspaceSize:e,isRemoteEnvironment:t}=o,s;e==="extreme"||e==="large"&&t?s="minimal":e==="large"||t?s="balanced":s="enterprise";let{PRESET_DEFINITIONS:i}=ae();return i[s]||i.balanced}jt.exports={registerRuntimeCommands:ci}});var Ht=E((exports,module)=>{var vscode=require("vscode"),{FileDateDecorationProvider}=Ft(),{getLogger}=N(),{getLocalization}=Re(),{fileSystem}=ne(),{registerCoreCommands}=Tt(),{registerOnboardingCommands}=At(),{registerMigrationCommands}=Rt(),{initializeTemplateStore}=Pt(),{SettingsMigrationManager}=Ot(),{ExtensionError,ERROR_CODES}=Oe(),{ensureDate}=oe(),isWebEnvironment=typeof process<"u"&&!0,nodeFs=null,nodePath=null,webTextDecoder=typeof TextDecoder=="function"?new TextDecoder("utf-8"):null;if(!isWebEnvironment){try{nodeFs=require("fs")}catch{nodeFs=null}try{nodePath=require("path")}catch{nodePath=null}}var AUTO_SUGGESTION_DELAY_MS=3e3,fileDateProvider,logger,l10n;function getActiveLogger(){return logger||(logger=getLogger()),logger}var featureFlagsModule=H(),featureFlags=featureFlagsModule,{setFeatureChunkResolver}=featureFlagsModule,{generateDevLoaderMap}=We(),sourceChunkLoader=(()=>{return typeof process>"u",null;try{let localRequire=eval("require");return o=>{try{let t=generateDevLoaderMap(localRequire)[o]?.();return t?.default||t||null}catch(e){let t=new ExtensionError(ERROR_CODES.CHUNK_LOAD_FAILED,`Source chunk fallback failed for ${o}`,{chunkName:o,source:"development",error:e.message});return getActiveLogger().warn(t.message,t.context),null}}}catch{return null}})(),chunkLoader={loadedChunks:new Map,distPath:nodePath?__dirname:null,extensionUri:null,webChunkPromises:new Map,_s:new Set,initialize(o){nodePath&&(typeof o?.asAbsolutePath=="function"?this.distPath=o.asAbsolutePath("dist"):o?.extensionPath&&(this.distPath=nodePath.join(o.extensionPath,"dist"))),o?.extensionUri&&(this.extensionUri=o.extensionUri)},async loadChunk(o){if(this.loadedChunks.has(o))return this.loadedChunks.get(o);try{if(isWebEnvironment){let t=await this.xr(o);return t&&(this.loadedChunks.set(o,t),getActiveLogger().info("Chunk loaded",{chunkName:o,target:"web"})),t}let e=this.Sr(o);return e&&(this.loadedChunks.set(o,e),getActiveLogger().info("Chunk loaded",{chunkName:o,target:"node"})),e}catch(e){let t=e instanceof ExtensionError?e:new ExtensionError(ERROR_CODES.CHUNK_LOAD_FAILED,`Failed to load chunk ${o}`,{chunkName:o,target:isWebEnvironment?"web":"node",error:e?.message});return getActiveLogger().warn(t.message,t.context),null}},Sr(o){if(nodeFs&&nodePath&&this.distPath){let e=nodePath.join(this.distPath,"chunks",`${o}.js`);if(nodeFs.existsSync(e))try{let t=require(e);return t?.default&&(t=t.default),t}catch(t){let s=new ExtensionError(ERROR_CODES.CHUNK_LOAD_FAILED,`Failed to require built chunk ${o}`,{chunkName:o,path:e,error:t.message});getActiveLogger().warn(s.message,s.context)}}return sourceChunkLoader?sourceChunkLoader(o):null},async xr(o){if(!this.extensionUri){let e=new ExtensionError(ERROR_CODES.CHUNK_LOAD_FAILED,"Missing extensionUri for web chunk loading",{chunkName:o});return getActiveLogger().warn(e.message,e.context),null}if(!this.webChunkPromises.has(o)){let e=(async()=>{await this.Fr(o);let s=(globalThis.Mr||{})[o];if(!s)throw new Error(`Web chunk ${o} failed to register`);return s})();this.webChunkPromises.set(o,e)}return this.webChunkPromises.get(o)},async Fr(o){if(this._s.has(o))return;let e=vscode.Uri.joinPath(this.extensionUri,"dist","web-chunks",`${o}.js`);if(!vscode.workspace?.fs||!webTextDecoder)throw new Error("Workspace FS or TextDecoder unavailable for web chunk loading");let t=await vscode.workspace.fs.readFile(e),s=webTextDecoder.decode(t);new Function(s).call(globalThis),this._s.add(o)}},dynamicImports={async loadOnboarding(o){let e=await featureFlags.onboarding();return e?typeof e.createOnboardingManager=="function"?e.createOnboardingManager(o):e.OnboardingManager?new e.OnboardingManager(o):null:null},async loadExportReporting(o){let e=await featureFlags.exportReporting();return typeof e?.createExportReportingManager=="function"?e.createExportReportingManager(o):null},async loadWorkspaceTemplates(o){let e=await featureFlags.workspaceTemplates();return typeof e?.createWorkspaceTemplatesManager=="function"?e.createWorkspaceTemplatesManager(o):e?.WorkspaceTemplatesManager?new e.WorkspaceTemplatesManager(o):null},async loadAnalysisCommands(){return featureFlags.analysisCommands()},async loadExtensionApi(o){let e=await featureFlags.extensionApi();if(!e)return null;if(typeof e=="function"){if(e.name==="createExtensionApiManager")return e(o);try{return new e}catch{return null}}else{if(typeof e.createExtensionApiManager=="function")return e.createExtensionApiManager(o);if(e.ExtensionApiManager)return new e.ExtensionApiManager}return null}},onboardingManagerPromise=null,workspaceTemplatesManagerPromise=null,exportReportingManagerPromise=null,extensionApiManagerPromise=null;function ensureOnboardingManager(o){return onboardingManagerPromise||(onboardingManagerPromise=dynamicImports.loadOnboarding(o)),onboardingManagerPromise}function ensureWorkspaceTemplatesManager(o){return workspaceTemplatesManagerPromise||(workspaceTemplatesManagerPromise=dynamicImports.loadWorkspaceTemplates(o)),workspaceTemplatesManagerPromise}function ensureExportReportingManager(o){return exportReportingManagerPromise||(exportReportingManagerPromise=dynamicImports.loadExportReporting(o)),exportReportingManagerPromise}function ensureExtensionApiManager(o){return extensionApiManagerPromise||(extensionApiManagerPromise=dynamicImports.loadExtensionApi(o)),extensionApiManagerPromise}function initializeStatusBar(o){let e=vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Right,100);e.command="explorerDates.showFileDetails",e.tooltip="Click to show detailed file information";let t=async()=>{try{let r=vscode.window.activeTextEditor;if(!r){e.hide();return}let n=r.document.uri;if(n.scheme!=="file"){e.hide();return}let a=await fileSystem.stat(n),c=ensureDate(a.mtime),l=fileDateProvider.Es(c,"smart"),h=fileDateProvider.Pe(a.size,"auto");e.text=`$(clock) ${l} $(file) ${h}`,e.show()}catch(r){e.hide(),logger.debug("Failed to update status bar",r)}},s=vscode.window.onDidChangeActiveTextEditor(t),i=vscode.window.onDidChangeTextEditorSelection(t);return t(),o.subscriptions.push(e,s,i),e}async function activate(o){try{logger=getLogger(),l10n=getLocalization(),o.subscriptions.push(l10n),initializeTemplateStore(o),chunkLoader.initialize(o),setFeatureChunkResolver(g=>chunkLoader.loadChunk(g)),logger.info("Explorer Dates: Extension activated");let e=new SettingsMigrationManager;try{await e.migrateAllSettings(o)}catch(g){logger.warn("Settings migration encountered issues:",g)}let t=vscode.env.uiKind===vscode.UIKind.Web;await vscode.commands.executeCommand("setContext","explorerDates.gitFeaturesAvailable",!t);let s=vscode.workspace.getConfiguration("explorerDates"),i=s.get("enableWorkspaceTemplates",!0),r=s.get("enableExportReporting",s.get("enableReporting",!0)),n=s.get("enableExtensionApi",!0);fileDateProvider=new FileDateDecorationProvider;let a=vscode.window.registerFileDecorationProvider(fileDateProvider);o.subscriptions.push(a),o.subscriptions.push(fileDateProvider),o.subscriptions.push(logger),await fileDateProvider.initializeAdvancedSystems(o),await fileDateProvider.checkWorkspaceSize();let c=null,l=!1,h=async()=>{if(!n)throw new Error("Extension API is disabled via explorerDates.enableExtensionApi");return c||(c=await ensureExtensionApiManager(o),c&&o.subscriptions&&o.subscriptions.push(c)),c},d=async()=>{if(!r)throw new Error("Reporting is disabled via explorerDates.enableExportReporting");if(!l){let A=vscode.workspace.getConfiguration("explorerDates").get("performanceMode",!1),$=process.env.EXPLORER_DATES_LIGHTWEIGHT_MODE==="1";(A||$)&&logger.warn("Initializing Export Reporting Manager while performance/lightweight mode is active; activity tracking will remain suppressed.")}let g=await ensureExportReportingManager(o);return g&&!l&&(o.subscriptions.push(g),l=!0),g},m=null,b=null,y=async()=>(b||(b=(async()=>{let g=await h();return m=g?g.getApi():null,m})()),b);if(n?(o.exports=y,o.exportsAsync=y):(o.exports=void 0,o.exportsAsync=void 0,logger.info("Explorer Dates API exports disabled via explorerDates.enableExtensionApi")),vscode.workspace.getConfiguration("explorerDates").get("showWelcomeOnStartup",!0)){let g=await ensureOnboardingManager(o);g&&await g.shouldShowOnboarding()&&setTimeout(()=>{g.showWelcomeMessage()},5e3)}registerCoreCommands({context:o,fileDateProvider,logger,l10n});let M=async()=>{let g=await dynamicImports.loadAnalysisCommands();if(!g)return vscode.window.showWarningMessage("Analysis commands unavailable."),null;let v=g.registerAnalysisCommands||g;return typeof v!="function"?(vscode.window.showWarningMessage("Analysis commands registration function not found."),null):v({context:o,fileDateProvider,logger,chunkLoader})};if(s.get("enableAnalysisCommands",!0))try{await M(),logger.info("Analysis commands registered successfully")}catch(g){logger.warn("Failed to register analysis commands:",g)}registerOnboardingCommands({context:o,logger,getOnboardingManager:()=>ensureOnboardingManager(o)});let he=registerMigrationCommands({context:o,logger,getSettingsMigrationManager:()=>Promise.resolve(e)});o.subscriptions.push(...he);let j=vscode.commands.registerCommand("explorerDates.openTemplateManager",async()=>{try{if(!i){vscode.window.showInformationMessage("Workspace templates are disabled. Enable explorerDates.enableWorkspaceTemplates to use this command.");return}if(!await featureFlags.workspaceTemplates()){vscode.window.showWarningMessage("Workspace templates feature is not available. The required module failed to load."),logger.warn("openTemplateManager command executed but workspaceTemplates chunk is unavailable");return}let v=await ensureWorkspaceTemplatesManager(o);if(!v){vscode.window.showWarningMessage("Workspace templates module unavailable.");return}await v.showTemplateManager(),logger.info("Template manager opened")}catch(g){logger.error("Failed to open template manager",g),vscode.window.showErrorMessage(`Failed to open template manager: ${g.message}`)}});o.subscriptions.push(j);let Fe=vscode.commands.registerCommand("explorerDates.saveTemplate",async()=>{try{if(!i){vscode.window.showInformationMessage("Workspace templates are disabled. Enable explorerDates.enableWorkspaceTemplates to save templates.");return}let g=await vscode.window.showInputBox({prompt:"Enter template name",placeHolder:"e.g., My Project Setup"});if(g){let v=await vscode.window.showInputBox({prompt:"Enter description (optional)",placeHolder:"Brief description of this template"})||"",A=await ensureWorkspaceTemplatesManager(o);if(!A){vscode.window.showWarningMessage("Workspace templates module unavailable.");return}await A.saveCurrentConfiguration(g,v)}logger.info("Template saved")}catch(g){logger.error("Failed to save template",g),vscode.window.showErrorMessage(`Failed to save template: ${g.message}`)}});o.subscriptions.push(Fe);let ee=vscode.commands.registerCommand("explorerDates.generateReport",async()=>{try{if(!r){vscode.window.showInformationMessage("Reporting features are disabled. Enable explorerDates.enableExportReporting to generate reports.");return}if(!await featureFlags.exportReporting()){vscode.window.showWarningMessage("Export reporting feature is not available. The required module failed to load."),logger.warn("generateReport command executed but exportReporting chunk is unavailable");return}let v=await d();if(!v){vscode.window.showWarningMessage("Reporting system unavailable.");return}await v.showReportDialog(),logger.info("Report generation started")}catch(g){logger.error("Failed to generate report",g),vscode.window.showErrorMessage(`Failed to generate report: ${g.message}`)}});o.subscriptions.push(ee);let te=vscode.commands.registerCommand("explorerDates.showApiInfo",async()=>{try{if(!n){vscode.window.showInformationMessage("Explorer Dates API is disabled via settings.");return}if(!await featureFlags.extensionApi()){vscode.window.showWarningMessage("Extension API feature is not available. The required module failed to load."),logger.warn("showApiInfo command executed but extensionApi chunk is unavailable");return}let v=vscode.window.createWebviewPanel("apiInfo","Explorer Dates API Information",vscode.ViewColumn.One,{enableScripts:!0}),A=await chunkLoader.loadChunk("diagnostics");if(!A)throw new Error("Diagnostics chunk failed to load");A.ensureInitialized(o);let $=await y();if(!$)throw new Error("API factory returned null - extension API may be disabled");v.webview.html=await A.getApiInformationHtml($),logger.info("API information panel opened")}catch(g){logger.error("Failed to show API information",g),vscode.window.showErrorMessage(`Failed to show API information: ${g.message}`)}});o.subscriptions.push(te);let V,R=vscode.workspace.getConfiguration("explorerDates"),ue=R.get("performanceMode",!1);R.get("showStatusBar",!1)&&!ue&&(V=initializeStatusBar(o));let de=vscode.workspace.onDidChangeConfiguration(g=>{if(g.affectsConfiguration("explorerDates.showStatusBar")||g.affectsConfiguration("explorerDates.performanceMode")){let v=vscode.workspace.getConfiguration("explorerDates"),A=v.get("showStatusBar",!1),$=v.get("performanceMode",!1),O=A&&!$;O&&!V?V=initializeStatusBar(o):!O&&V&&(V.dispose(),V=null)}});o.subscriptions.push(de),logger.info("Explorer Dates: Date decorations ready");try{let{registerRuntimeCommands:g}=Vt(),{runtimeManager:v,teamPersistenceManager:A}=g(o);setTimeout(async()=>{try{await v.checkAutoSuggestion(),await A.validateTeamConfiguration()}catch($){logger.debug("Runtime system auto-suggestion failed:",$)}},AUTO_SUGGESTION_DELAY_MS),logger.info("Runtime chunk management system initialized")}catch(g){logger.error("Failed to initialize runtime chunk management:",g)}if(n)return y}catch(e){let t=`${l10n?l10n.getString("activationError"):"Explorer Dates failed to activate"}: ${e.message}`;throw getActiveLogger().error("Extension activation failed",e),vscode.window.showErrorMessage(t),e}}async function deactivate(){try{getActiveLogger().info("Explorer Dates extension is being deactivated"),fileDateProvider&&typeof fileDateProvider.dispose=="function"&&await fileDateProvider.dispose(),getActiveLogger().info("Explorer Dates extension deactivated successfully")}catch(o){getActiveLogger().error("Explorer Dates: Error during deactivation",o)}}module.exports={activate,deactivate}});var qt=Ht();module.exports={activate:qt.activate,deactivate:qt.deactivate};
