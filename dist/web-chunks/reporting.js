var module = { exports: {} }; var exports = module.exports; (function() {
var m=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports);var _=m((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?o=>{if(typeof o=="string")return o;try{return JSON.stringify(o,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",Logger=class{constructor(){this.t=vscode.window.createOutputChannel("Explorer Dates"),this.m=!1,this.e=null,this.a=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.a)||(this.a=DEFAULT_LOG_PROFILE),this.c=new Map,this.E=DEFAULT_CONSOLE_LEVEL,this.S(),this.e=vscode.workspace.onDidChangeConfiguration(t=>{(t.affectsConfiguration("explorerDates.enableLogging")||t.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.S()})}S(){let t=vscode.workspace.getConfiguration("explorerDates");this.m=t.get("enableLogging",!1);let e=(t.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase();this.E=LOG_LEVEL_ORDER.includes(e)?e:DEFAULT_CONSOLE_LEVEL}setLogProfile(t=DEFAULT_LOG_PROFILE){let e=(t||DEFAULT_LOG_PROFILE).toLowerCase();this.a=SUPPORTED_PROFILES.has(e)?e:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(t){if(t){this.c.delete(t);return}this.c.clear()}debug(t,...e){this.m&&this.d("debug",null,t,e)}info(t,...e){this.d("info",null,t,e)}infoWithOptions(t,e,...i){this.d("info",t||null,e,i)}warn(t,...e){this.d("warn",null,t,e)}error(t,e,...i){let s=`[${new Date().toISOString()}] [ERROR] ${t}`;this.t.appendLine(s),e instanceof Error?(this.t.appendLine(`Error: ${e.message}`),e.stack&&this.t.appendLine(`Stack: ${e.stack}`)):e&&this.t.appendLine(this.y(e));let n=this.L(i);n.length>0&&n.forEach(a=>this.t.appendLine(this.y(a))),this.g("error",s,[e,...n])}show(){this.t.show()}clear(){this.t.clear()}dispose(){this.t.dispose(),this.e&&(this.e.dispose(),this.e=null),loggerInstance===this&&(loggerInstance=null)}d(t,e,i,r){if(t==="debug"&&!this.m||this._(t,e))return;let n=`[${new Date().toISOString()}] [${t.toUpperCase()}] ${i}`;this.t.appendLine(n);let a=this.L(r);a.length>0&&a.forEach(h=>this.t.appendLine(this.y(h))),this.g(t,n,a)}L(t){return!t||t.length===0?[]:t.map(e=>{if(typeof e!="function")return e;try{return e()}catch(i){return`<<log arg threw: ${i.message}>>`}})}y(t){try{return typeof t=="string"?t:typeof t=="object"?JSON.stringify(t,null,2):inspectValue(t)}catch(e){return`<<failed to serialize log arg: ${e.message}>>`}}_(t,e){if(t!=="info"||!e||!e.throttleKey)return!1;let i=(e.profile||"stress").toLowerCase();if(!this.P(i))return!1;let r=Number(e.throttleLimit)||50,s=e.throttleKey,n=this.c.get(s)||{count:0,suppressed:0,noticeLogged:!1};if(n.count<r)return n.count+=1,this.c.set(s,n),!1;if(n.suppressed+=1,!n.noticeLogged){n.noticeLogged=!0;let a=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${s}" after ${r} entries (profile=${this.a})`;this.t.appendLine(a),this.g("info",a)}return this.c.set(s,n),!0}P(t){let e=this.a||DEFAULT_LOG_PROFILE;return t==="default"?e===DEFAULT_LOG_PROFILE:e===t}I(t){let e=LOG_LEVEL_ORDER.indexOf(this.E),i=LOG_LEVEL_ORDER.indexOf(t);return e===-1||i===-1?!1:i>=e}g(t,e,i=[]){if(!this.I(t))return;(t==="warn"?console.warn:t==="error"?console.error:console.log).call(console,e,...i)}},loggerInstance=null;function getLogger(){return loggerInstance||(loggerInstance=new Logger),loggerInstance}module.exports={Logger,getLogger}});var M=m((At,I)=>{var P=require("vscode");function st(){try{return P?.env?.uiKind===P?.UIKind?.Web}catch{return!1}}I.exports={isWebEnvironment:st}});var S=m((kt,$)=>{function y(o=""){return o?o.replace(/\\/g,"/"):""}function ot(o=""){let t=y(o);return t?t.split("/").filter(Boolean):[]}function b(o=""){let t=ot(o);return t.length?t[t.length-1]:""}function nt(o=""){let t=b(o),e=t.lastIndexOf(".");return e<=0?"":t.substring(e).toLowerCase()}function at(o=""){let t=y(o),e=t.lastIndexOf("/");return e===-1?"":t.substring(0,e)}function ct(...o){return y(o.filter(Boolean).join("/")).replace(/\/+/g,"/")}function ht(o=""){return y(o).toLowerCase()}function lt(o=""){if(!o)return"";if(typeof o=="string")return o;if(typeof o.fsPath=="string"&&o.fsPath.length>0)return o.fsPath;if(typeof o.path=="string"&&o.path.length>0)return o.path;if(typeof o.toString=="function")try{return o.toString(!0)}catch{return o.toString()}return String(o)}function ft(o="",t=""){let e=y(o),i=y(t);return e&&i.startsWith(e)?i.substring(e.length).replace(/^\/+/,""):i}$.exports={normalizePath:y,getFileName:b,getExtension:nt,getDirectory:at,joinPath:ct,getCacheKey:ht,getUriPath:lt,getRelativePath:ft}});var j=m((xt,z)=>{var L=class extends Error{constructor(t,e,i={}){super(e),this.code=t,this.context=i,this.name="ExtensionError"}},ut={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function dt(o){if(!o)return!1;let t=o.code||o?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(t)}z.exports={ExtensionError:L,ERROR_CODES:ut,isPermissionError:dt}});var T=m((Ct,W)=>{function U(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function N(o){return!!(o&&typeof o=="object"&&typeof o.getTime=="function")}function D(o){if(!o||isNaN(o))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(o)}catch{}let t=864e5,e=36e5,i=6e4,r=1e3,s=1970,n=4,a=Math.floor(o/t),h=o%t,l=Math.floor(h/e),f=Math.floor(h%e/i),g=Math.floor(h%i/r),w=s+Math.floor(a/365.25),J=Math.floor(a%365.25/30.44)+1,Q=Math.floor(a%30.44)+1,Z=String(Math.min(J,12)).padStart(2,"0"),tt=String(Math.min(Q,31)).padStart(2,"0"),et=String(l).padStart(2,"0"),it=String(f).padStart(2,"0"),rt=String(g).padStart(2,"0");return`${Z}/${tt}/${w}, ${et}:${it}:${rt}`}function pt(o){if(N(o))return o;let t=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(o==null){if(!t){let e=U();return{getTime:()=>e,toLocaleString:()=>D(e),toString:()=>D(e)}}return new Date}if(typeof o=="number")return t?new Date(o):{getTime:()=>o,toLocaleString:()=>D(o),toString:()=>D(o)};if(typeof o=="string"){let e=0;if(t)e=Date.parse(o);else{let i=parseFloat(o);e=isNaN(i)?0:i}return t?new Date(o):{getTime:()=>e,toLocaleString:()=>D(e),toString:()=>D(e)}}return t?new Date(o):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}W.exports={ensureDate:pt,isDateLike:N,getCurrentTimestamp:U}});var V=m((Ot,G)=>{var u=require("vscode"),{isWebEnvironment:mt}=M(),{normalizePath:yt}=S(),{ExtensionError:gt,ERROR_CODES:wt,isPermissionError:Dt}=j(),{ensureDate:v}=T(),B=process.env.VSCODE_WEB==="true",Ft=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",d=null;if(!B&&!Ft)try{d=require("fs").promises}catch{d=null}var E=class{constructor(){this.isWeb=B||mt()}r(t){if(!t)return"";if(typeof t=="string")return t;if(t&&typeof t=="object"&&typeof t.fsPath=="string")return t.fsPath;if(t&&typeof t=="object"&&typeof t.path=="string")return t.path;if(typeof t=="object"){if(typeof t.fsPath=="string")return t.fsPath;if(typeof t.path=="string")return t.path}return String(t)}s(t){if(t&&typeof t=="object"&&typeof t.scheme=="string"&&typeof t.path=="string")return t;if(typeof t=="string")return u.Uri.file(t);if(t&&typeof t=="object"){if(t.uri&&t.uri!==t)try{return this.s(t.uri)}catch{}if(typeof t.fsPath=="string"&&t.fsPath.length>0)return u.Uri.file(t.fsPath);if(typeof t.path=="string"&&t.path.length>0)return u.Uri.file(t.path);if(typeof t.href=="string"&&t.href.length>0)return u.Uri.parse(t.href);if(typeof t.scheme=="string")return u.Uri.from({scheme:t.scheme,authority:t.authority||"",path:t.path||t.fsPath||"",query:t.query||"",fragment:t.fragment||""});if(typeof t.toString=="function")try{let e=t.toString(!0);if(e&&e!=="[object Object]")return u.Uri.parse(e)}catch{let e=t.toString();if(e&&e!=="[object Object]")return u.Uri.parse(e)}}throw new Error(`Unsupported target type: ${typeof t}`)}async stat(t){if(!this.isWeb&&d)return d.stat(this.r(t));let e=this.s(t),i=await u.workspace.fs.stat(e);return{...i,mtime:v(i.mtime),ctime:v(i.ctime),birthtime:v(i.ctime),isFile:()=>i.type===u.FileType.File,isDirectory:()=>i.type===u.FileType.Directory}}async readFile(t,e="utf8"){if(!this.isWeb&&d)return d.readFile(this.r(t),e);let i=this.s(t),r=await u.workspace.fs.readFile(i);return e===null||e==="binary"?r:new TextDecoder(e).decode(r)}async writeFile(t,e,i="utf8"){let r=this.r(t);try{if(!this.isWeb&&d)return d.writeFile(r,e,i);let s=this.s(t),n=typeof e=="string"?new TextEncoder().encode(e):e;await u.workspace.fs.writeFile(s,n)}catch(s){this.T("write file",r,s)}}async mkdir(t,e={recursive:!0}){let i=this.r(t);try{if(!this.isWeb&&d)return d.mkdir(i,e);let r=this.s(t);await u.workspace.fs.createDirectory(r)}catch(r){this.T("create directory",i,r)}}async readdir(t,e={withFileTypes:!1}){if(!this.isWeb&&d)return d.readdir(this.r(t),e);let i=this.s(t),r=await u.workspace.fs.readDirectory(i);return e.withFileTypes?r.map(([s,n])=>({name:s,isDirectory:()=>n===u.FileType.Directory,isFile:()=>n===u.FileType.File})):r.map(([s])=>s)}async delete(t,e={recursive:!1}){if(!this.isWeb&&d){let r=this.r(t);return e.recursive?d.rm?d.rm(r,e):d.rmdir(r,e):d.unlink(r)}let i=this.s(t);await u.workspace.fs.delete(i,e)}async exists(t){try{return await this.stat(t),!0}catch{return!1}}async ensureDirectory(t){let e=yt(this.r(t));await this.mkdir(e,{recursive:!0})}T(t,e,i){throw Dt(i)?new gt(wt.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${t}`,{path:e,code:i.code}):i}},Et=new E;G.exports={FileSystemAdapter:E,fileSystem:Et}});var X=m((Rt,H)=>{var c=require("vscode"),{getLogger:St}=_(),{fileSystem:Lt}=V(),{getExtension:A,normalizePath:q}=S(),{ensureDate:k}=T(),p=St(),F=process.env.VSCODE_WEB==="true",x=["node_modules",".git","dist","build","out",".vscode-test"],C=["**/*.tmp","**/*.log","**/.git/**","**/node_modules/**"],O=3e3,K=100,Tt=2e4,R=class{constructor(){this.fileActivityCache=new Map,this.i=new Map,this.allowedFormats=["json","csv","html","markdown"],this.activityTrackingDays=30,this.activityCutoffMs=null,this.timeTrackingIntegration="none",this.maxTrackedActivityFiles=O,this.excludedFolders=[...x],this.excludedPatterns=[...C],this.v=[],this.e=null,this.h=null,this.p=[],this.l=[],this.o=new Map,this.M=Number(process.env.EXPLORER_DATES_USER_ACTIVITY_TTL_MS||300*1e3),this.n={user:0,watcher:0},this.b=process.env.EXPLORER_DATES_LIGHTWEIGHT_MODE==="1",this.f=!1,this.A(),this.$(),this.initialize()}A(){try{let t=c.workspace.getConfiguration("explorerDates"),e=t.get("reportFormats",["json","html"]),i=["json","csv","html","markdown"];this.allowedFormats=Array.from(new Set([...e,...i]));let r=t.get("activityTrackingDays",30);this.activityTrackingDays=Math.max(1,Math.min(365,r)),this.activityCutoffMs=this.activityTrackingDays*24*60*60*1e3,this.timeTrackingIntegration=t.get("timeTrackingIntegration","none"),this.maxTrackedActivityFiles=this.z(t.get("maxTrackedActivityFiles",O)),this.excludedFolders=t.get("excludedFolders",x)||x,this.excludedPatterns=t.get("excludedPatterns",C)||C,this.v=this.excludedPatterns.map(s=>this.j(s)).filter(Boolean)}catch(t){p.error("Failed to load reporting configuration",t)}}$(){this.e&&this.e.dispose(),this.e=c.workspace.onDidChangeConfiguration(t=>{(t.affectsConfiguration("explorerDates.reportFormats")||t.affectsConfiguration("explorerDates.activityTrackingDays")||t.affectsConfiguration("explorerDates.timeTrackingIntegration")||t.affectsConfiguration("explorerDates.maxTrackedActivityFiles")||t.affectsConfiguration("explorerDates.excludedFolders")||t.affectsConfiguration("explorerDates.excludedPatterns")||t.affectsConfiguration("explorerDates.performanceMode"))&&(this.A(),this.k(),p.info("Reporting configuration updated",{allowedFormats:this.allowedFormats,activityTrackingDays:this.activityTrackingDays,timeTrackingIntegration:this.timeTrackingIntegration,maxTrackedActivityFiles:this.maxTrackedActivityFiles}))})}async initialize(){try{if(this.x()){this.f=!0,this.w(),this.D(),p.info("Export & Reporting Manager initialized (activity tracking suppressed by performance/lightweight mode)");return}this.f=!1,this.F(),this.k(),p.info("Export & Reporting Manager initialized")}catch(t){p.error("Failed to initialize Export & Reporting Manager:",t)}}startFileWatcher(){if(this.h||this.maxTrackedActivityFiles===0||F){this.maxTrackedActivityFiles===0&&p.info("File activity tracking disabled (maxTrackedActivityFiles=0)"),F&&p.info("Skipping file activity watcher in web environment");return}let t=c.workspace.createFileSystemWatcher("**/*");this.h=t,this.p=[t.onDidChange(e=>this.recordFileActivity(e,"modified",{source:"watcher"})),t.onDidCreate(e=>this.recordFileActivity(e,"created",{source:"watcher"})),t.onDidDelete(e=>this.recordFileActivity(e,"deleted",{source:"watcher"}))]}D(){if(this.p.length){for(let t of this.p)try{t.dispose()}catch{}this.p=[]}if(this.h){try{this.h.dispose()}catch{}this.h=null}}k(){let t=this.x();if(t||this.maxTrackedActivityFiles<=0||F){this.f=t||this.maxTrackedActivityFiles<=0||F,this.D(),this.w(),this.fileActivityCache.clear(),this.i.clear();return}this.f&&(this.f=!1,this.F()),this.F(),this.startFileWatcher(),this.C()}recordFileActivity(t,e,i={}){try{let r=i.source||"system";if(this.maxTrackedActivityFiles===0)return;let s=t?.fsPath||t?.path;if(!s)return;let n=this.u(s);if(!n||!this.U(n))return;let a=this.fileActivityCache.get(n);a?a.path=s:(a={path:s,activities:[]},this.fileActivityCache.set(n,a));let h=new Date;a.activities.push({action:e,timestamp:h,path:s,source:r}),r==="user"&&this.O(n,h.getTime()),this.n[r]===void 0&&(this.n[r]=0),this.n[r]++,this.N(n,a),this.W(n,h.getTime())}catch(r){p.error("Failed to record file activity:",r)}}N(t,e){let i=e?.activities;if(!(!i||i.length===0)){if(this.activityCutoffMs){let r=Date.now()-this.activityCutoffMs;for(;i.length&&i[0].timestamp.getTime()<r;)i.shift()}i.length>K&&i.splice(0,i.length-K),i.length===0&&(this.fileActivityCache.delete(t),this.i.delete(t))}}async generateFileModificationReport(t={}){try{let{format:e="json",timeRange:i="all",includeDeleted:r=!1,outputPath:s=null}=t;if(!this.allowedFormats.includes(e)){let h=`Report format "${e}" is disabled. Allowed formats: ${this.allowedFormats.join(", ")}`;return c.window.showWarningMessage(h),p.warn(h),null}let n=await this.collectFileData(i,r),a=await this.formatReport(n,e);return s&&(await this.saveReport(a,s),c.window.showInformationMessage(`Report saved to ${s}`)),a}catch(e){return p.error("Failed to generate file modification report:",e),c.window.showErrorMessage("Failed to generate report"),null}}async collectFileData(t,e){let i=[],r=c.workspace.workspaceFolders;if(!r)return{files:[],summary:this.createSummary([])};for(let n of r){let a=await this.scanWorkspaceFolder(n.uri,t,e);i.push(...a)}let s=this.createSummary(i);return s.integrationTarget=this.timeTrackingIntegration,s.activityTrackingDays=this.activityTrackingDays,{generatedAt:new Date().toISOString(),workspace:r.map(n=>n.uri.fsPath),timeRange:t,files:i,summary:s}}async scanWorkspaceFolder(t,e,i){let r=[],n=c.workspace.getConfiguration("explorerDates").get("excludedPatterns",[]);try{let a=await c.workspace.fs.readDirectory(t);for(let[h,l]of a){let f=c.Uri.joinPath(t,h),g=c.workspace.asRelativePath(f);if(!this.isExcluded(g,n)){if(l===c.FileType.File){let w=await this.getFileData(f,e);w&&r.push(w)}else if(l===c.FileType.Directory){let w=await this.scanWorkspaceFolder(f,e,i);r.push(...w)}}}if(i&&t.fsPath){let h=this.getDeletedFiles(t.fsPath,e);r.push(...h)}}catch(a){p.error(`Failed to scan folder ${t.fsPath||t.path}:`,a)}return r}async getFileData(t,e){try{let i=await c.workspace.fs.stat(t),r=c.workspace.asRelativePath(t),s=t.fsPath||t.path,n=this.u(s),a=this.fileActivityCache.get(n),h=a?.activities||[],l=this.filterActivitiesByTimeRange(h,e);return{path:r,fullPath:a?.path||s,size:i.size,created:k(i.ctime),modified:k(i.mtime),type:this.getFileType(r),extension:A(r),activities:l,activityCount:l.length,lastActivity:l.length>0?l[l.length-1].timestamp:k(i.mtime)}}catch(i){return p.error(`Failed to get file data for ${t.fsPath||t.path}:`,i),null}}filterActivitiesByTimeRange(t,e){let i=t;if(e!=="all"){let r=new Date,s;switch(e){case"24h":s=new Date(r-1440*60*1e3);break;case"7d":s=new Date(r-10080*60*1e3);break;case"30d":s=new Date(r-720*60*60*1e3);break;case"90d":s=new Date(r-2160*60*60*1e3);break;default:s=null}s&&(i=i.filter(n=>n.timestamp>=s))}if(this.activityCutoffMs){let r=new Date(Date.now()-this.activityCutoffMs);i=i.filter(s=>s.timestamp>=r)}return i}getDeletedFiles(t,e){if(!t)return[];let i=[],r=t?this.u(t):"";for(let[s,n]of this.fileActivityCache.entries()){if(!n?.activities||n.activities.length===0||r&&!s.startsWith(r))continue;let a=n.activities.filter(l=>l.action==="deleted"),h=this.filterActivitiesByTimeRange(a,e);h.length>0&&i.push({path:c.workspace.asRelativePath(n.path||s),fullPath:n.path||s,size:0,created:null,modified:null,type:"deleted",extension:A(n.path||s),activities:h,activityCount:h.length,lastActivity:h[h.length-1].timestamp})}return i}createSummary(t){let e={totalFiles:t.length,totalSize:t.reduce((r,s)=>r+(s.size||0),0),fileTypes:{},activityByDay:{},mostActiveFiles:[],recentlyModified:[],largestFiles:[],oldestFiles:[],activitySourceBreakdown:{user:this.n.user||0,watcher:this.n.watcher||0}};t.forEach(r=>{let s=r.type||"unknown";e.fileTypes[s]=(e.fileTypes[s]||0)+1});let i=new Date(Date.now()-this.activityTrackingDays*24*60*60*1e3);return t.forEach(r=>{r.activities.forEach(s=>{if(s.timestamp>=i){let n=s.timestamp.toISOString().split("T")[0];e.activityByDay[n]=(e.activityByDay[n]||0)+1}})}),e.mostActiveFiles=t.sort((r,s)=>s.activityCount-r.activityCount).slice(0,10).map(r=>({path:r.path,activityCount:r.activityCount,lastActivity:r.lastActivity})),e.recentlyModified=t.filter(r=>r.modified).sort((r,s)=>s.modified-r.modified).slice(0,20).map(r=>({path:r.path,modified:r.modified,size:r.size})),e.largestFiles=t.sort((r,s)=>(s.size||0)-(r.size||0)).slice(0,10).map(r=>({path:r.path,size:r.size,modified:r.modified})),e.oldestFiles=t.filter(r=>r.modified).sort((r,s)=>r.modified-s.modified).slice(0,10).map(r=>({path:r.path,modified:r.modified,size:r.size})),e}async formatReport(t,e){switch(e.toLowerCase()){case"json":return JSON.stringify(t,null,2);case"csv":return this.formatAsCSV(t);case"html":return this.formatAsHTML(t);case"markdown":return this.formatAsMarkdown(t);default:throw new Error(`Unsupported format: ${e}`)}}formatAsCSV(t){let e=["Path,Size,Created,Modified,Type,Extension,ActivityCount,LastActivity"];return t.files.forEach(i=>{e.push([i.path,i.size||0,i.created?i.created.toISOString():"",i.modified?i.modified.toISOString():"",i.type,i.extension,i.activityCount,i.lastActivity?i.lastActivity.toISOString():""].join(","))}),e.join(`
`)}formatAsHTML(t){return`<!DOCTYPE html>
<html>
<head>
    <title>File Modification Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .summary { background-color: #f9f9f9; padding: 15px; margin: 20px 0; }
        .chart { margin: 20px 0; }
    </style>
</head>
<body>
    <h1>File Modification Report</h1>
    <p>Generated: ${new Date(t.generatedAt).toLocaleString()}</p>
    
    <div class="summary">
        <h2>Summary</h2>
        <p><strong>Total Files:</strong> ${t.summary.totalFiles}</p>
        <p><strong>Total Size:</strong> ${this.formatFileSize(t.summary.totalSize)}</p>
        <p><strong>Time Range:</strong> ${t.timeRange}</p>
    </div>
    
    <h2>File Types</h2>
    <table>
        <tr><th>Type</th><th>Count</th></tr>
        ${Object.entries(t.summary.fileTypes).map(([e,i])=>`<tr><td>${e}</td><td>${i}</td></tr>`).join("")}
    </table>
    
    <h2>Most Active Files</h2>
    <table>
        <tr><th>Path</th><th>Activity Count</th><th>Last Activity</th></tr>
        ${t.summary.mostActiveFiles.map(e=>`<tr><td>${e.path}</td><td>${e.activityCount}</td><td>${new Date(e.lastActivity).toLocaleString()}</td></tr>`).join("")}
    </table>
    
    <h2>All Files</h2>
    <table>
        <tr><th>Path</th><th>Size</th><th>Modified</th><th>Type</th><th>Activity Count</th></tr>
        ${t.files.map(e=>`<tr>
                <td>${e.path}</td>
                <td>${this.formatFileSize(e.size||0)}</td>
                <td>${e.modified?new Date(e.modified).toLocaleString():"N/A"}</td>
                <td>${e.type}</td>
                <td>${e.activityCount}</td>
            </tr>`).join("")}
    </table>
</body>
</html>`}formatAsMarkdown(t){return`# File Modification Report

**Generated:** ${new Date(t.generatedAt).toLocaleString()}
**Time Range:** ${t.timeRange}

## Summary

- **Total Files:** ${t.summary.totalFiles}
- **Total Size:** ${this.formatFileSize(t.summary.totalSize)}

## File Types

| Type | Count |
|------|-------|
${Object.entries(t.summary.fileTypes).map(([e,i])=>`| ${e} | ${i} |`).join(`
`)}

## Most Active Files

| Path | Activity Count | Last Activity |
|------|----------------|---------------|
${t.summary.mostActiveFiles.map(e=>`| ${e.path} | ${e.activityCount} | ${new Date(e.lastActivity).toLocaleString()} |`).join(`
`)}

## Recently Modified Files

| Path | Modified | Size |
|------|----------|------|
${t.summary.recentlyModified.map(e=>`| ${e.path} | ${new Date(e.modified).toLocaleString()} | ${this.formatFileSize(e.size)} |`).join(`
`)}

## All Files

| Path | Size | Modified | Type | Activities |
|------|------|----------|------|------------|
${t.files.map(e=>`| ${e.path} | ${this.formatFileSize(e.size||0)} | ${e.modified?new Date(e.modified).toLocaleString():"N/A"} | ${e.type} | ${e.activityCount} |`).join(`
`)}
`}async saveReport(t,e){try{if(F){let r=encodeURIComponent(t);await c.env.openExternal(c.Uri.parse(`data:text/plain;charset=utf-8,${r}`)),c.window.showInformationMessage("Report download triggered in browser");return}let i=e instanceof c.Uri?e:c.Uri.file(e);await Lt.writeFile(i,t,"utf8"),p.info(`Report saved to ${i.fsPath||i.path}`)}catch(i){throw p.error("Failed to save report:",i),i}}async exportToTimeTrackingTools(t={}){try{let{tool:e="generic",timeRange:i="7d"}=t,r=await this.collectFileData(i,!1);return this.formatForTimeTracking(r,e)}catch(e){return p.error("Failed to export to time tracking tools:",e),null}}formatForTimeTracking(t,e){let i=[];switch(t.files.forEach(r=>{r.activities.forEach(s=>{i.push({file:r.path,action:s.action,timestamp:s.timestamp,duration:this.estimateSessionDuration(s),project:this.extractProjectName(r.path)})})}),e){case"toggl":return this.formatForToggl(i);case"clockify":return this.formatForClockify(i);case"generic":default:return i}}formatForToggl(t){return t.map(e=>({description:`${e.action}: ${e.file}`,start:e.timestamp.toISOString(),duration:e.duration*60,project:e.project,tags:[e.action,this.getFileType(e.file)]}))}formatForClockify(t){return t.map(e=>({description:`${e.action}: ${e.file}`,start:e.timestamp.toISOString(),end:new Date(e.timestamp.getTime()+e.duration*60*1e3).toISOString(),project:e.project,tags:[e.action,this.getFileType(e.file)]}))}estimateSessionDuration(t){switch(t.action){case"created":return 15;case"modified":return 5;case"deleted":return 1;default:return 5}}extractProjectName(t){return q(t).split("/")[0]||"Unknown Project"}getFileType(t){let e=A(t);return{".js":"javascript",".ts":"typescript",".py":"python",".java":"java",".cpp":"cpp",".html":"html",".css":"css",".md":"markdown",".json":"json",".xml":"xml",".txt":"text"}[e]||"other"}isExcluded(t,e){return e.some(i=>new RegExp(i.replace(/\*/g,".*")).test(t))}formatFileSize(t){if(t===0)return"0 B";let e=1024,i=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,r)).toFixed(1))+" "+i[r]}async showReportDialog(){try{let t={"\u{1F4CA} Generate Full Report":"full","\u{1F4C5} Last 24 Hours":"24h","\u{1F4C5} Last 7 Days":"7d","\u{1F4C5} Last 30 Days":"30d","\u{1F4C5} Last 90 Days":"90d"},e=await c.window.showQuickPick(Object.keys(t),{placeHolder:"Select report time range"});if(!e)return;let i=t[e],r=["JSON","CSV","HTML","Markdown"],s=await c.window.showQuickPick(r,{placeHolder:"Select report format"});if(!s)return;let n=await c.window.showSaveDialog({defaultUri:c.Uri.file(`file-report.${s.toLowerCase()}`),filters:{[s]:[s.toLowerCase()]}});if(!n)return;await this.generateFileModificationReport({format:s.toLowerCase(),timeRange:i,outputPath:n.fsPath})}catch(t){p.error("Failed to show report dialog:",t),c.window.showErrorMessage("Failed to generate report")}}dispose(){this.e&&(this.e.dispose(),this.e=null),this.D(),this.w(),this.fileActivityCache.clear(),this.i.clear(),this.o.clear(),this.n={user:0,watcher:0},p.info("Export & Reporting Manager disposed")}u(t=""){let e=q(t||"").trim();return e?e.toLowerCase():""}U(t){if(!t)return!1;for(let e of this.excludedFolders){if(!e)continue;let i=e.replace(/^\/+|\/+$/g,"").toLowerCase();if(!i)continue;let r=`/${i}`;if(t.includes(`${r}/`)||t.endsWith(r))return!1}return!this.v.some(e=>e.test(t))}j(t){if(!t||typeof t!="string")return null;let e=t.replace(/([.+^${}()|[\]\\])/g,"\\$1").replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^/]*").replace(/\\\?/g,".");try{return new RegExp(e,"i")}catch{return null}}W(t,e){t&&(this.i.has(t)&&this.i.delete(t),this.i.set(t,e),this.C())}C(){if(this.maxTrackedActivityFiles<=0){this.fileActivityCache.clear(),this.i.clear();return}for(;this.i.size>this.maxTrackedActivityFiles;){let t=this.i.keys().next();if(t.done)break;let e=t.value;this.i.delete(e),this.fileActivityCache.delete(e)}}z(t){let e=Number(t);return Number.isFinite(e)?e<=0?0:Math.min(Math.max(Math.floor(e),500),Tt):O}x(){return c.workspace.getConfiguration("explorerDates").get("performanceMode",!1)||this.b}F(){if(this.l.length>0)return;let t=c.workspace||{},e=(l,f)=>typeof l!="function"?null:l.call(t,f),i=[],r=e(t.onDidSaveTextDocument,l=>{this.recordFileActivity(l.uri,"modified",{source:"user"})});r&&i.push(r);let s=e(t.onDidChangeTextDocument,l=>{let f=l?.document;if(!f)return;let g=this.u(f.uri.fsPath||f.uri.path||"");g&&this.O(g,Date.now())});s&&i.push(s);let n=e(t.onDidCreateFiles,l=>{l?.files?.forEach(f=>this.recordFileActivity(f,"created",{source:"user"}))});n&&i.push(n);let a=e(t.onDidDeleteFiles,l=>{l?.files?.forEach(f=>this.recordFileActivity(f,"deleted",{source:"user"}))});a&&i.push(a);let h=e(t.onDidRenameFiles,l=>{l?.files?.forEach(f=>{this.recordFileActivity(f.oldUri,"deleted",{source:"user"}),this.recordFileActivity(f.newUri,"created",{source:"user"})})});h&&i.push(h),i.length>0&&(this.l=i)}w(){if(this.l.length){for(let t of this.l)try{t.dispose()}catch{}this.l=[],this.o.clear()}}O(t,e){t&&(this.R(),this.o.set(t,e||Date.now()))}R(){if(!this.o.size)return;let t=Date.now();for(let[e,i]of this.o.entries())t-i>this.M&&this.o.delete(e)}B(t){return this.R(),this.o.has(t)?!0:!!(Array.isArray(c.workspace?.textDocuments)?c.workspace.textDocuments:[]).find(r=>(r?.uri?this.u(r.uri.fsPath||r.uri.path):"")===t)}};H.exports={ExportReportingManager:R}});var{ExportReportingManager:Y}=X();module.exports={ExportReportingManager:Y,createExportReportingManager:o=>new Y(o)};
})(); (globalThis.__explorerDatesChunks = globalThis.__explorerDatesChunks || {})["reporting"] = module.exports;
