var module = { exports: {} }; var exports = module.exports; (function() {
var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var L=m((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?r=>{if(typeof r=="string")return r;try{return JSON.stringify(r,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",TEST_CONSOLE_LEVEL=process.env.EXPLORER_DATES_TEST_MODE==="1"?"warn":null,Logger=class{constructor(){this.s=vscode.window.createOutputChannel("Explorer Dates"),this.b=!1,this.w=null,this.k=process.env.EXPLORER_DATES_TEST_MODE==="1",this.p=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.p)||(this.p=DEFAULT_LOG_PROFILE),this.h=new Map,this.S=DEFAULT_CONSOLE_LEVEL,this.A(),this.w=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.A()})}A(){let e=vscode.workspace.getConfiguration("explorerDates");this.b=e.get("enableLogging",!1);let t=(process.env.EXPLORER_DATES_LOG_LEVEL||"").toLowerCase(),s=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase(),n=TEST_CONSOLE_LEVEL||t||s||DEFAULT_CONSOLE_LEVEL;this.S=LOG_LEVEL_ORDER.includes(n)?n:DEFAULT_CONSOLE_LEVEL,TEST_CONSOLE_LEVEL&&(this.b=!1)}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.p=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.h.delete(e);return}this.h.clear()}debug(e,...t){this.b&&this.E("debug",null,e,t)}info(e,...t){this.E("info",null,e,t)}infoWithOptions(e,t,...s){this.E("info",e||null,t,s)}warn(e,...t){this.E("warn",null,e,t)}error(e,t,...s){let o=`[${new Date().toISOString()}] [ERROR] ${e}`;this.k||(this.s.appendLine(o),t instanceof Error?(this.s.appendLine(`Error: ${t.message}`),t.stack&&this.s.appendLine(`Stack: ${t.stack}`)):t&&this.s.appendLine(this._(t)));let i=this.O(s);i.length>0&&!this.k&&i.forEach(l=>this.s.appendLine(this._(l)));let a=[];t!=null&&a.push(t),i.length>0&&a.push(...i),this.v("error",o,a)}show(){this.s.show()}clear(){this.s.clear()}dispose(){this.s.dispose(),this.w&&(this.w.dispose(),this.w=null);let e="__explorerDatesLogger";typeof global<"u"&&global[e]===this?global[e]=null:typeof globalThis<"u"&&globalThis[e]===this?globalThis[e]=null:typeof globalThis<"u"&&globalThis.window?.[e]===this&&(globalThis.window[e]=null),loggerInstance===this&&(loggerInstance=null)}E(e,t,s,n){if(e==="debug"&&!this.b||this.Y(e,t))return;let i=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${s}`;this.k||this.s.appendLine(i);let a=this.O(n);a.length>0&&!this.k&&a.forEach(l=>this.s.appendLine(this._(l))),this.v(e,i,a)}O(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(s){return`<<log arg threw: ${s.message}>>`}})}_(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}Y(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let s=(t.profile||"stress").toLowerCase();if(!this.J(s))return!1;let n=Number(t.throttleLimit)||50,o=t.throttleKey,i=this.h.get(o)||{count:0,suppressed:0,noticeLogged:!1};if(i.count<n)return i.count+=1,this.h.set(o,i),!1;if(i.suppressed+=1,!i.noticeLogged){i.noticeLogged=!0;let a=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${o}" after ${n} entries (profile=${this.p})`;this.s.appendLine(a),this.v("info",a)}return this.h.set(o,i),!0}J(e){let t=this.p||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}Z(e){let t=LOG_LEVEL_ORDER.indexOf(this.S),s=LOG_LEVEL_ORDER.indexOf(e);return t===-1||s===-1?!1:s>=t}v(e,t,s=[]){if(!this.Z(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...s)}},GLOBAL_LOGGER_KEY="__explorerDatesLogger";function getLogger(){return typeof global<"u"?(global[GLOBAL_LOGGER_KEY]||(global[GLOBAL_LOGGER_KEY]=new Logger),global[GLOBAL_LOGGER_KEY]):typeof globalThis<"u"?(globalThis[GLOBAL_LOGGER_KEY]||(globalThis[GLOBAL_LOGGER_KEY]=new Logger),globalThis.window&&(globalThis.window[GLOBAL_LOGGER_KEY]=globalThis[GLOBAL_LOGGER_KEY]),globalThis[GLOBAL_LOGGER_KEY]):(loggerInstance||(loggerInstance=new Logger),loggerInstance)}var loggerInstance=null;module.exports={Logger,getLogger}});var C=m((pt,H)=>{function k(r=""){return r?r.replace(/\\/g,"/"):""}function Ce(r=""){let e=k(r);return e?e.split("/").filter(Boolean):[]}function q(r=""){let e=Ce(r);return e.length?e[e.length-1]:""}function Se(r=""){let e=q(r),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function Ae(r=""){let e=k(r),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function Oe(...r){return k(r.filter(Boolean).join("/")).replace(/\/+/g,"/")}function Te(r=""){return k(r).toLowerCase()}function Ie(r=""){if(!r)return"";if(typeof r=="string")return r;if(typeof r.fsPath=="string"&&r.fsPath.length>0)return r.fsPath;if(typeof r.path=="string"&&r.path.length>0)return r.path;if(typeof r.toString=="function")try{return r.toString(!0)}catch{return r.toString()}return String(r)}function Re(r="",e=""){let t=k(r),s=k(e);return t&&s.startsWith(t)?s.substring(t.length).replace(/^\/+/,""):s}H.exports={normalizePath:k,getFileName:q,getExtension:Se,getDirectory:Ae,joinPath:Oe,getCacheKey:Te,getUriPath:Ie,getRelativePath:Re}});var M=m((ht,Z)=>{function Y(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function J(r){return!!(r&&typeof r=="object"&&typeof r.getTime=="function")}function v(r){if(!r||isNaN(r))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(r)}catch{}let e=864e5,t=36e5,s=6e4,n=1e3,o=1970,i=Math.floor(r/e),a=r%e,l=Math.floor(a/t),c=Math.floor(a%t/s),g=Math.floor(a%s/n),w=o+Math.floor(i/365.25),y=Math.floor(i%365.25/30.44)+1,b=Math.floor(i%30.44)+1,F=String(Math.min(y,12)).padStart(2,"0"),W=String(Math.min(b,31)).padStart(2,"0"),Le=String(l).padStart(2,"0"),De=String(c).padStart(2,"0"),Fe=String(g).padStart(2,"0");return`${F}/${W}/${w}, ${Le}:${De}:${Fe}`}function Pe(r){if(J(r))return r;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(r==null){if(!e){let t=Y();return{getTime:()=>t,toLocaleString:()=>v(t),toString:()=>v(t)}}return new Date}if(typeof r=="number")return e?new Date(r):{getTime:()=>r,toLocaleString:()=>v(r),toString:()=>v(r)};if(typeof r=="string"){let t=0;if(e)t=Date.parse(r);else{let s=parseFloat(r);t=isNaN(s)?0:s}return e?new Date(r):{getTime:()=>t,toLocaleString:()=>v(t),toString:()=>v(t)}}return e?new Date(r):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}Z.exports={ensureDate:Pe,isDateLike:J,getCurrentTimestamp:Y}});var Q=m((gt,X)=>{var u={onboarding:34,analysisCommands:23,exportReporting:17,extensionApi:15,workspaceTemplates:14,advancedCache:28,workspaceIntelligence:31,incrementalWorkers:19},x=99,E={minimal:{id:"minimal",name:"Minimal",description:"Core decorations only, smallest bundle (~99KB)",targetBundleSize:x,settings:{"explorerDates.enableOnboardingSystem":!1,"explorerDates.enableAnalysisCommands":!1,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!1,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.performanceMode":!0,"explorerDates.showDateDecorations":!0,"explorerDates.dateDecorationFormat":"relative-short"},targetScenarios:["Resource-constrained environments","Basic file dates only","Large remote workspaces"]},balanced:{id:"balanced",name:"Balanced",description:"Essential features with optimization (~200KB)",targetBundleSize:x+u.onboarding+u.workspaceTemplates+u.advancedCache+u.analysisCommands,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.performanceMode":!0,"explorerDates.smartFileWatching":!0},targetScenarios:["Most development workflows","Remote environments","Medium to large workspaces"]},"web-development":{id:"web-development",name:"Web Development",description:"Optimized for web projects (~240KB)",targetBundleSize:x+u.onboarding+u.analysisCommands+u.workspaceTemplates+u.advancedCache+u.incrementalWorkers,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.showGitInfo":"author","explorerDates.colorScheme":"file-type"},targetScenarios:["JavaScript/TypeScript projects","Node.js development","Frontend frameworks"]},enterprise:{id:"enterprise",name:"Enterprise",description:"Full feature set with reporting and API (~380KB)",targetBundleSize:Object.values(u).reduce((r,e)=>r+e,x),settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!0,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.persistentCache":!0,"explorerDates.smartExclusions":!0},targetScenarios:["Team lead workflows","Analytics and reporting needs","API integration requirements","Full workspace intelligence"]},"data-science":{id:"data-science",name:"Data Science",description:"Optimized for data workflows (~280KB)",targetBundleSize:x+u.onboarding+u.analysisCommands+u.exportReporting+u.workspaceIntelligence+u.advancedCache,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.dateDecorationFormat":"iso-detailed"},targetScenarios:["Jupyter notebooks","Python data analysis","Research workflows"]}},We=new Set(["enableOnboardingSystem","enableAnalysisCommands","enableExportReporting","enableExtensionApi","enableWorkspaceTemplates","enableAdvancedCache","enableWorkspaceIntelligence","enableIncrementalWorkers","performanceMode","smartFileWatching"]);function Me(r){let e=x;return r["explorerDates.enableOnboardingSystem"]&&(e+=u.onboarding),r["explorerDates.enableAnalysisCommands"]&&(e+=u.analysisCommands),r["explorerDates.enableExportReporting"]&&(e+=u.exportReporting),r["explorerDates.enableExtensionApi"]&&(e+=u.extensionApi),r["explorerDates.enableWorkspaceTemplates"]&&(e+=u.workspaceTemplates),r["explorerDates.enableAdvancedCache"]&&(e+=u.advancedCache),r["explorerDates.enableWorkspaceIntelligence"]&&(e+=u.workspaceIntelligence),r["explorerDates.enableIncrementalWorkers"]&&(e+=u.incrementalWorkers),e}function Ke(r){switch(r){case"minimal":case"extreme":return E.minimal;case"balanced":return E.balanced;case"web-development":return E["web-development"];case"data-science":return E["data-science"];case"enterprise":return E.enterprise;default:return E.balanced}}X.exports={PRESET_DEFINITIONS:E,CHUNK_SIZES:u,BASE_BUNDLE_SIZE:x,RESTART_REQUIRED_SETTINGS:We,calculateBundleSize:Me,getDefaultPresetForProfile:Ke}});var te=m((mt,ee)=>{var S={onboarding:"src/chunks/onboarding-chunk",onboardingAssets:"src/chunks/onboarding-assets-chunk",reporting:"src/chunks/reporting-chunk",templates:"src/chunks/templates-chunk",analysis:"src/chunks/analysis-chunk",diagnostics:"src/chunks/diagnostics-chunk",extensionApi:"src/chunks/extension-api-chunk",advancedCache:"src/chunks/advancedCache-chunk",batchProcessor:"src/chunks/batchProcessor-chunk",decorationsAdvanced:"src/chunks/decorations-advanced",workspaceIntelligence:"src/chunks/workspaceIntelligence",incrementalWorkers:"src/chunks/incrementalWorkers",uiAdapters:"src/chunks/ui-adapters",gitInsights:"src/chunks/gitInsights-chunk",smartWatcherFallback:"src/chunks/smartWatcherFallback-chunk",runtimeManagement:"src/chunks/runtime-management"};function Ne(r){return S[r]||null}function Ue(){return Object.keys(S)}function $e(r){let e={};for(let[t,s]of Object.entries(S))e[t]=()=>r(`./${s}`);return e}ee.exports={CHUNK_MAP:S,getChunkSourcePath:Ne,getAllChunkNames:Ue,generateDevLoaderMap:$e}});var re=m((exports,module)=>{var FEATURE_FLAGS_GLOBAL_KEY="__explorerDatesFeatureFlags";function registerFeatureFlagsGlobal(r){if(r)try{typeof globalThis<"u"&&(globalThis[FEATURE_FLAGS_GLOBAL_KEY]=r)}catch{}}function loadFeatureFlagsFallback(){try{let dynamicRequire=typeof eval=="function"?eval("require"):null;if(typeof dynamicRequire=="function")return dynamicRequire("../featureFlags")}catch{}return null}function getFeatureFlagsGlobal(){try{if(typeof globalThis<"u"&&globalThis[FEATURE_FLAGS_GLOBAL_KEY])return globalThis[FEATURE_FLAGS_GLOBAL_KEY]}catch{}return loadFeatureFlagsFallback()}module.exports={FEATURE_FLAGS_GLOBAL_KEY,registerFeatureFlagsGlobal,getFeatureFlagsGlobal}});var se=m((exports,module)=>{var{getLogger}=L(),{CHUNK_SIZES}=Q(),{getChunkSourcePath,getAllChunkNames}=te(),{registerFeatureFlagsGlobal}=re(),featureLogger=null,DEFAULT_CHUNK_TIMEOUT_MS=Number(process.env.EXPLORER_DATES_CHUNK_TIMEOUT||5e3),NETWORK_ERROR_CODES=new Set(["ENOTFOUND","ECONNRESET","ECONNREFUSED","EAI_AGAIN","ETIMEDOUT","EHOSTUNREACH"]),BUILT_CHUNK_CACHE=new Map,CHUNK_METHOD_ALIASES={reporting:"exportReporting",templates:"workspaceTemplates",analysis:"analysisCommands"},DEV_CHUNK_PATH_CACHE=new Map;function getDevChunkImportPath(r){if(DEV_CHUNK_PATH_CACHE.has(r))return DEV_CHUNK_PATH_CACHE.get(r);let e=getChunkSourcePath(r);if(!e)return DEV_CHUNK_PATH_CACHE.set(r,null),null;let t=e;return t.startsWith("src/")&&(t=t.slice(4)),t.startsWith("./")||(t=`./${t}`),DEV_CHUNK_PATH_CACHE.set(r,t),t}function resolveNodeDependencies(){if(nativeDepsResolved)return!!(nativePath&&nativeFs);if(nativeDepsResolved=!0,!isNodeLikeRuntime())return!1;try{nativePath=eval("require")("path"),nativeFs=eval("require")("fs")}catch{nativePath=null,nativeFs=null}return!!(nativePath&&nativeFs)}var nativeDepsResolved=!1,nativePath=null,nativeFs=null;function isWebRuntime(){try{return typeof navigator<"u"&&navigator?.userAgent?navigator.userAgent.includes("vscode-web")||navigator.userAgent.includes("Code - Web"):typeof process<"u"&&process?.env?.VSCODE_WEB==="true"}catch{return!1}}function isNodeLikeRuntime(){return typeof process<"u"&&!!process.versions?.node&&!isWebRuntime()}function getChunkTimeoutMs(){return DEFAULT_CHUNK_TIMEOUT_MS>0?DEFAULT_CHUNK_TIMEOUT_MS:0}function logFeature(r,e,t){featureLogger||(featureLogger=getLogger());let s=featureLogger;typeof s[r]=="function"?s[r](e,t):s.info(e,t)}function logFeatureDisabled(r,e){logFeature("info","Feature disabled via configuration",{feature:r,savedKB:e&&CHUNK_SIZES[e]!==void 0?CHUNK_SIZES[e]:void 0})}function isLikelyNetworkIssue(r){if(!r)return!1;if(r.code&&NETWORK_ERROR_CODES.has(r.code))return!0;let e=(r.message||"").toLowerCase();return e.includes("network")||e.includes("fetch")||e.includes("timed out")}function runWithChunkTimeout(r,e){let t=getChunkTimeoutMs(),s=()=>{try{return Promise.resolve(r())}catch(n){return Promise.reject(n)}};return t?new Promise((n,o)=>{let i=!1,a=setTimeout(()=>{if(i)return;i=!0;let l=new Error(`Chunk "${e}" load timed out after ${t}ms`);l.code="CHUNK_TIMEOUT",o(l)},t);s().then(l=>{i||(i=!0,clearTimeout(a),n(l))}).catch(l=>{i||(i=!0,clearTimeout(a),o(l))})}):s()}function logResolverFailure(r,e){if(!e)return;let t={chunkName:r,error:e.message,code:e.code,networkIssue:isLikelyNetworkIssue(e),timedOut:e.code==="CHUNK_TIMEOUT"},s=t.networkIssue||t.timedOut?"warn":"error";logFeature(s,"Chunk resolver failed",t)}function tryLoadBuiltChunk(r){if(!r||!resolveNodeDependencies()||typeof nativeFs?.existsSync!="function")return null;if(BUILT_CHUNK_CACHE.has(r))return BUILT_CHUNK_CACHE.get(r);let e=[];typeof __dirname=="string"&&nativePath&&(e.push(nativePath.join(__dirname,"chunks",`${r}.js`)),e.push(nativePath.join(__dirname,"..","dist","chunks",`${r}.js`)));for(let t of e)try{if(!t||!nativeFs.existsSync(t))continue;let s=require(t),n=s?.default||s;return BUILT_CHUNK_CACHE.set(r,n||null),n&&logFeature("info","Loaded chunk via built artifact fallback",{chunkName:r,path:t}),n}catch(s){logFeature("warn","Built chunk fallback failed",{chunkName:r,path:t,error:s.message})}return BUILT_CHUNK_CACHE.set(r,null),null}function tryRequireDevChunk(r){if(isWebRuntime())return null;let e=getDevChunkImportPath(r);if(!e)return null;try{let t=require(e);return t?.default||t}catch(t){(t.code!=="MODULE_NOT_FOUND"||typeof t.message=="string"&&!t.message.includes(e))&&logFeature("debug","Dev chunk require failed",{chunkName:r,importPath:e,error:t.message})}return null}function tryRequireLocalBuiltChunk(r){if(isWebRuntime())return null;let e=`./chunks/${r}`;try{let t=require(e);return t?.default||t}catch(t){t.code==="MODULE_NOT_FOUND"||logFeature("debug","Local chunk require failed",{chunkName:r,importPath:e,error:t.message})}return null}function getSavingsKey(r){return r in CHUNK_SIZES?r:CHUNK_METHOD_ALIASES[r]||null}function announceChunkSavings(r){let e=getSavingsKey(r);if(!e)return;let t=CHUNK_SIZES[e];if(!t)return;let n=`\u{1F4BE} ${e===r||!r?e:`${e} (requested as "${r}")`} chunk unavailable - keeping the feature disabled is saving ~${t}KB`;logFeature("info","Chunk savings applied",{chunkName:e,requestedName:r,savedKB:t})}var getFeatureConfig=()=>{try{let e=require("vscode").workspace.getConfiguration("explorerDates");return{enableOnboarding:e.get("enableOnboardingSystem",!0),enableExportReporting:e.get("enableExportReporting",!0),enableWorkspaceTemplates:e.get("enableWorkspaceTemplates",!0),enableAnalysisCommands:e.get("enableAnalysisCommands",!0),enableAdvancedCache:e.get("enableAdvancedCache",!0),enableWorkspaceIntelligence:e.get("enableWorkspaceIntelligence",!0),enableIncrementalWorkers:e.get("enableIncrementalWorkers",!1),enableExtensionApi:e.get("enableExtensionApi",!0)}}catch{return{enableOnboarding:!0,enableExportReporting:!0,enableWorkspaceTemplates:!0,enableAnalysisCommands:!0,enableAdvancedCache:!0,enableWorkspaceIntelligence:!0,enableIncrementalWorkers:!1,enableExtensionApi:!0}}},featureLoaders=new Map,chunkResolver=null;function setFeatureChunkResolver(r){if(r&&typeof r!="function")throw new Error("Feature chunk resolver must be a function");chunkResolver=r||null}function registerFeatureLoader(r,e){if(typeof e!="function")throw new Error(`Feature loader for "${r}" must be a function`);featureLoaders.set(r,e)}function unregisterFeatureLoader(r){featureLoaders.delete(r)}function clearFeatureLoaders(){featureLoaders.clear()}async function loadFeatureModule(r){let e=featureLoaders.get(r);if(!e&&chunkResolver&&(e=()=>chunkResolver(r)),!e)return logFeature("warn","No loader registered for feature",{feature:r}),null;try{return await runWithChunkTimeout(()=>e(),r)}catch(t){return logFeature("warn","Feature loader failed",{feature:r,error:t.message,code:t.code,networkIssue:isLikelyNetworkIssue(t)}),announceChunkSavings(r),null}}function registerDefaultLoaders(){getAllChunkNames().forEach(e=>{featureLoaders.has(e)||registerFeatureLoader(e,createDefaultLoader(e))})}function createDefaultLoader(r){return async()=>{if(chunkResolver&&typeof chunkResolver=="function")try{let n=await runWithChunkTimeout(()=>chunkResolver(r),r);if(n)return n;logFeature("info","Chunk resolver returned no module",{chunkName:r})}catch(n){logResolverFailure(r,n)}let e=tryRequireDevChunk(r);if(e)return e;let t=tryRequireLocalBuiltChunk(r);if(t)return t;let s=tryLoadBuiltChunk(r);return s||(logFeature("warn","No built artifact available for chunk",{chunkName:r}),null)}}var featureFlags={async onboarding(){return getFeatureConfig().enableOnboarding?loadFeatureModule("onboarding"):(logFeatureDisabled("onboarding","onboarding"),null)},async exportReporting(){return getFeatureConfig().enableExportReporting?loadFeatureModule("reporting"):(logFeatureDisabled("exportReporting","exportReporting"),null)},async workspaceTemplates(){return getFeatureConfig().enableWorkspaceTemplates?loadFeatureModule("templates"):(logFeatureDisabled("workspaceTemplates","workspaceTemplates"),null)},async analysisCommands(){return getFeatureConfig().enableAnalysisCommands?loadFeatureModule("analysis"):(logFeatureDisabled("analysisCommands","analysisCommands"),null)},async advancedCache(){return getFeatureConfig().enableAdvancedCache?loadFeatureModule("advancedCache"):(logFeatureDisabled("advancedCache","advancedCache"),null)},async workspaceIntelligence(){return getFeatureConfig().enableWorkspaceIntelligence?loadFeatureModule("workspaceIntelligence"):(logFeatureDisabled("workspaceIntelligence","workspaceIntelligence"),null)},async incrementalWorkers(){return getFeatureConfig().enableIncrementalWorkers?loadFeatureModule("incrementalWorkers"):(logFeatureDisabled("incrementalWorkers","incrementalWorkers"),null)},async extensionApi(){return getFeatureConfig().enableExtensionApi?loadFeatureModule("extensionApi"):(logFeatureDisabled("extensionApi","extensionApi"),null)},async uiAdapters(){return loadFeatureModule("uiAdapters")},async batchProcessor(){return loadFeatureModule("batchProcessor")},async decorationsAdvanced(){return loadFeatureModule("decorationsAdvanced")},async gitInsights(){return loadFeatureModule("gitInsights")},isEnabled(r){let e=getFeatureConfig();return{onboarding:e.enableOnboarding,exportReporting:e.enableExportReporting,workspaceTemplates:e.enableWorkspaceTemplates,analysisCommands:e.enableAnalysisCommands,advancedCache:e.enableAdvancedCache,workspaceIntelligence:e.enableWorkspaceIntelligence,incrementalWorkers:e.enableIncrementalWorkers,extensionApi:e.enableExtensionApi}[r]??!0},getEnabledFeatures(){let r=getFeatureConfig(),e=[];return r.enableOnboarding&&e.push("onboarding"),r.enableExportReporting&&e.push("exportReporting"),r.enableWorkspaceTemplates&&e.push("workspaceTemplates"),r.enableAnalysisCommands&&e.push("analysisCommands"),r.enableAdvancedCache&&e.push("advancedCache"),r.enableWorkspaceIntelligence&&e.push("workspaceIntelligence"),r.enableIncrementalWorkers&&e.push("incrementalWorkers"),r.enableExtensionApi&&e.push("extensionApi"),e},calculateSavings(){let r=getFeatureConfig(),e=0;return r.enableOnboarding||(e+=34),r.enableExportReporting||(e+=17),r.enableExtensionApi||(e+=15),r.enableWorkspaceTemplates||(e+=14),r.enableWorkspaceIntelligence||(e+=12),r.enableAnalysisCommands||(e+=8),r.enableAdvancedCache||(e+=5),e}};for(let[r,e]of Object.entries(CHUNK_METHOD_ALIASES))!featureFlags[r]&&typeof featureFlags[e]=="function"&&(featureFlags[r]=(...t)=>featureFlags[e](...t));function calculateSavings(r){r||(r=getFeatureConfig());let e=267,t=0;r.enableOnboarding||(t+=34),r.enableExportReporting||(t+=17),r.enableExtensionApi||(t+=15),r.enableWorkspaceTemplates||(t+=14),r.enableWorkspaceIntelligence||(t+=12),r.enableIncrementalWorkers||(t+=19),r.enableAnalysisCommands||(t+=8),r.enableAdvancedCache||(t+=5);let s=e-t,n=t>0?Math.round(t/e*100):0;return{baseSize:`${e}KB`,totalSavings:`${t}KB`,optimizedSize:`${s}KB`,percentage:n}}registerDefaultLoaders();var exportedFeatureFlags={...featureFlags,getFeatureConfig,calculateSavings,registerFeatureLoader,setFeatureChunkResolver,unregisterFeatureLoader,clearFeatureLoaders,loadFeatureModule,registerDefaultLoaders};registerFeatureFlagsGlobal(exportedFeatureFlags);module.exports=exportedFeatureFlags});var ie=m((yt,oe)=>{var{getLogger:Ge}=L(),{normalizePath:A,getUriPath:K}=C(),{isDateLike:Be,ensureDate:ne}=M(),N=class{constructor(e){this._fileSystem=e,this._logger=Ge(),this._batchProcessor=null,this.a=new Map,this.g=null,this.t=null,this.l=!1,this.f=null,this.x=new Set,this.m=new Map,this.n=null,this.X=6e4}initialize(e={}){this._batchProcessor=e.batchProcessor||null,this.l=e.enableProgressiveAnalysis||!1,this.g&&(this.g.dispose(),this.g=null),this.t&&(this.t.dispose(),this.t=null)}async startInitialIndex(e,t={}){if(!this._batchProcessor||!Array.isArray(e)||e.length===0)return;this.T("restart"),this.f=new AbortController;let s=t.maxFiles||2e3;e.forEach(n=>{let o=this._batchProcessor.processDirectoryProgressively(n.uri,async i=>this.I(i,{source:"initial"}),{background:!0,priority:"low",maxFiles:s,cancellationToken:this.f.signal});o&&this.x.add(o)}),this._logger.info(`Incremental indexer scheduled initial scan for ${e.length} workspace folder(s).`)}T(e="unspecified"){if(this.f&&!this.f.signal.aborted&&this.f.abort(),this.f=null,this._batchProcessor&&this.x.size)for(let t of this.x)this._batchProcessor.cancelBatch(t);this.x.clear(),e!=="unspecified"&&this._logger.debug(`Incremental indexer cancelled initial scan (${e})`)}async I(e,t={}){try{let s=await this._fileSystem.stat(e);await this.R(e,s,t)}catch(s){this._logger.debug("Incremental indexer failed to stat URI",{error:s?.message,uri:e?.toString?.()})}}async R(e,t,s={}){let n=K(e);if(!n)return;let o=A(n);if(!o)return;let i={path:o,size:t?.size||0,mtimeMs:this.P(t?.mtime),birthtimeMs:this.P(t?.birthtime||t?.ctime||t?.mtime),indexedAt:Date.now(),digest:null,context:s};if(this.l||this.g){let a=this.g||await this.W();if(a?.isEnabled())try{let[l]=await a.runTask("digest",[i]);i.digest=l?.hash||null,i.sizeBucket=l?.sizeBucket,i.ageBucket=l?.ageBucket}catch(l){this._logger.debug("Incremental index worker error",l)}}this.a.set(o,i)}getIndexedStat(e,t=this.X){if(!e)return null;let s=A(e),n=this.a.get(s);return!n||Date.now()-(n.indexedAt||0)>t?null:{size:n.size||0,mtime:ne(n.mtimeMs||Date.now()),birthtime:ne(n.birthtimeMs||n.mtimeMs||Date.now()),isFile:()=>!0}}queueDelta(e,t="change"){if(!e)return;let s=e.toString();this.m.set(s,{uri:e,eventType:t}),this.n||(this.n=setTimeout(()=>this.Q(),300))}async Q(){this.n&&(clearTimeout(this.n),this.n=null);let e=Array.from(this.m.values());this.m.clear();for(let{uri:t,eventType:s}of e){if(s==="delete"){let n=A(K(t));n&&this.a.delete(n);continue}await this.I(t,{source:"delta",eventType:s})}}primeFromStat(e,t){!e||!t||this.R(e,t,{source:"prime"}).catch(s=>{this._logger.debug("Failed to prime index from stat",s)})}async W(){if(!this.l)return null;if(!this.t)try{let{loadFeatureModule:e}=se(),t=await e("incrementalWorkers");if(t){let{IncrementalWorkersManager:s}=t;this.t=new s({logger:this._logger}),await this.t.initialize(),this._logger.info("\u{1F4E6} Incremental workers chunk loaded on demand (~8-10KB)")}else return this._logger.warn("Failed to load incremental workers chunk"),null}catch(e){return this._logger.error("Failed to load incremental workers manager",e),null}return this.t.getWorkerHost()}async enableProgressiveAnalysis(){return this.l||(this.l=!0,this._logger.debug("Progressive analysis enabled, workers will be loaded on demand")),this.W()}disableProgressiveAnalysis(){this.l=!1,this.t&&(this.t.dispose(),this.t=null,this._logger.debug("Progressive analysis disabled, worker resources disposed"))}getMetrics(){return{entries:this.a.size,workerEnabled:!!this.t?.isWorkerEnabled(),progressiveAnalysisEnabled:this.l,deltaQueue:this.m.size}}removeFoldersFromIndex(e=[]){if(!Array.isArray(e)||e.length===0)return 0;let t=e.map(n=>A(K(n))).filter(Boolean);if(!t.length)return 0;let s=0;for(let n of Array.from(this.a.keys()))t.some(o=>n===o||n.startsWith(`${o}/`))&&(this.a.delete(n),s++);return s>0&&this._logger.debug(`Incremental indexer pruned ${s} entr${s===1?"y":"ies"} for removed workspace folder(s).`),s}P(e){if(!e)return Date.now();if(typeof e=="number")return e;if(Be(e))return e.getTime();if(typeof e=="string"){let t=Date.parse(e);return Number.isFinite(t)?t:Date.now()}return typeof e.getTime=="function"?e.getTime():Date.now()}dispose(){this.T("dispose"),this.n&&(clearTimeout(this.n),this.n=null),this.m.clear(),this.t&&(this.t.dispose(),this.t=null),this.a.clear()}};oe.exports={IncrementalIndexer:N}});var ce=m((bt,le)=>{var ae=require("vscode");function ze(){try{return ae?.env?.uiKind===ae?.UIKind?.Web}catch{return!1}}le.exports={isWebEnvironment:ze}});var fe=m((wt,de)=>{var O=class extends Error{constructor(e,t,s={}){super(t),this.code=e,this.context=s,this.name="ExtensionError"}},ue={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function Ve(r){if(!r)return!1;let e=r.code||r?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}var U=class extends O{constructor(e,t,s={}){let{recoverable:n=!0,context:o={}}=s;super(ue.CHUNK_LOAD_FAILED,`Failed to load ${e}: ${t}`,{chunkName:e,recoverable:n,...o}),this.name="ChunkLoadError",this.chunkName=e,this.recoverable=n}};function je(r,e,t={}){let s=require("vscode"),{userFacing:n=!0}=t,o=e?.recoverable??!0;n&&!o&&s.window.showErrorMessage(`Explorer Dates: ${r} feature unavailable. Please reinstall or rebuild the extension.`)}de.exports={ExtensionError:O,ERROR_CODES:ue,isPermissionError:Ve,ChunkLoadError:U,handleChunkFailure:je}});var ge=m((kt,he)=>{var d=require("vscode"),{isWebEnvironment:qe}=ce(),{normalizePath:He}=C(),{ExtensionError:Ye,ERROR_CODES:Je,isPermissionError:Ze}=fe(),{ensureDate:$}=M(),pe=process.env.VSCODE_WEB==="true",Xe=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",f=null;if(!pe&&!Xe)try{f=require("fs").promises}catch{f=null}var T=class{constructor(){this.isWeb=pe||qe()}c(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}u(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return d.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.u(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return d.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return d.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return d.Uri.parse(e.href);if(typeof e.scheme=="string")return d.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return d.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return d.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&f)return f.stat(this.c(e));let t=this.u(e),s=await d.workspace.fs.stat(t);return{...s,mtime:$(s.mtime),ctime:$(s.ctime),birthtime:$(s.ctime),isFile:()=>s.type===d.FileType.File,isDirectory:()=>s.type===d.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&f)return f.readFile(this.c(e),t);let s=this.u(e),n=await d.workspace.fs.readFile(s);return t===null||t==="binary"?n:new TextDecoder(t).decode(n)}async writeFile(e,t,s="utf8"){let n=this.c(e);try{if(!this.isWeb&&f)return f.writeFile(n,t,s);let o=this.u(e),i=typeof t=="string"?new TextEncoder().encode(t):t;await d.workspace.fs.writeFile(o,i)}catch(o){this.M("write file",n,o)}}async mkdir(e,t={recursive:!0}){let s=this.c(e);try{if(!this.isWeb&&f)return f.mkdir(s,t);let n=this.u(e);await d.workspace.fs.createDirectory(n)}catch(n){this.M("create directory",s,n)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&f)return f.readdir(this.c(e),t);let s=this.u(e),n=await d.workspace.fs.readDirectory(s);return t.withFileTypes?n.map(([o,i])=>({name:o,isDirectory:()=>i===d.FileType.Directory,isFile:()=>i===d.FileType.File})):n.map(([o])=>o)}async delete(e,t={recursive:!1}){if(!this.isWeb&&f){let n=this.c(e);return t.recursive?f.rm?f.rm(n,t):f.rmdir(n,t):f.unlink(n)}let s=this.u(e);await d.workspace.fs.delete(s,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=He(this.c(e));await this.mkdir(t,{recursive:!0})}M(e,t,s){throw Ze(s)?new Ye(Je.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:s.code}):s}},Qe=new T;he.exports={FileSystemAdapter:T,fileSystem:Qe}});var ke=m((Et,we)=>{var et="__explorerDatesVscode",_=null,I=null,R=!1;function tt(){try{return globalThis[et]}catch{return}}function be(){if(I)return I;let r={get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})};return I={workspace:{workspaceFolders:[],getConfiguration:()=>r},ConfigurationTarget:{Global:1,Workspace:2,WorkspaceFolder:3}},I}var rt=new Set(["MODULE_NOT_FOUND","ERR_MODULE_NOT_FOUND","WEB_NATIVE_MODULE"]);function st(r){return!r||r.code&&rt.has(r.code)?!0:(typeof r.message=="string"?r.message:"").includes("Cannot find module 'vscode'")}function D(){let r=tt();if(r)return _=G(r),R=!1,_;if(_&&!R)return _;try{_=G(require("vscode")),R=!1}catch(e){if(st(e))_=G(be()),R=!0;else throw e}return _}var h=new Proxy({},{get(r,e){return D()[e]},set(r,e,t){return D()[e]=t,!0},has(r,e){return e in D()},ownKeys(){return Reflect.ownKeys(D())},getOwnPropertyDescriptor(r,e){let t=Object.getOwnPropertyDescriptor(D(),e);return t&&(t.configurable=!0),t}}),nt="explorerDates",me="__explorerDatesConfigWrapped";function ye(r){return!r||typeof r!="object"?{get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})}:(typeof r.get!="function"&&(r.get=()=>{}),typeof r.update!="function"&&(r.update=async()=>{}),typeof r.inspect!="function"&&(r.inspect=()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})),r)}function G(r){if(!r)return be();r.ConfigurationTarget||(r.ConfigurationTarget={Global:1,Workspace:2,WorkspaceFolder:3}),r.workspace||(r.workspace={});let e=r.workspace.getConfiguration;if(typeof e=="function"&&!e[me]){let t=function(...s){let n=e.apply(this,s);return ye(n)};t[me]=!0,r.workspace.getConfiguration=t}else typeof e!="function"&&(r.workspace.getConfiguration=()=>ye());return Array.isArray(r.workspace.workspaceFolders)||(r.workspace.workspaceFolders=[]),r}var P=class{constructor(e={}){this.ee=e.defaultSection||nt}getValue(e,t={}){let{section:s,resource:n}=t,o=this.L(e,s);return this.D(o.section,n).get(o.key)}inspect(e,t={}){let{section:s,resource:n}=t,o=this.L(e,s);return this.D(o.section,n).inspect(o.key)}async updateSetting(e,t,s={}){let{scope:n="auto",resource:o,section:i,force:a=!1}=s,l=this.L(e,i),c=this.D(l.section,o),g=this.te(n,o),w=c.get(l.key),y=c.inspect(l.key),b=this.re(y,g);return t!==void 0&&this.se(w,t)&&!a&&b!==void 0?{key:l.fullKey,updated:!1,reason:"unchanged"}:(await c.update(l.key,t,g),{key:l.fullKey,updated:!0})}async applySettings(e,t={}){let s=Array.isArray(e)?e:Object.entries(e).map(([o,i])=>({key:o,value:i})),n=[];for(let o of s){let i={...t,...o.options||{}};n.push(await this.updateSetting(o.key,o.value,i))}return n}async clearSetting(e,t={}){return this.updateSetting(e,void 0,t)}D(e,t){return h.workspace.getConfiguration(e||void 0,t)}L(e,t){let s=t||this.ee;if(!s)return{section:void 0,key:e,fullKey:e};if(e.startsWith(`${s}.`)){let n=e.slice(s.length+1);return{section:s,key:n,fullKey:e}}return e.includes(".")?{section:void 0,key:e,fullKey:e}:{section:s,key:e,fullKey:`${s}.${e}`}}te(e,t){return e&&e!=="auto"?this.ne(e)||h.ConfigurationTarget.Workspace:t?h.ConfigurationTarget.WorkspaceFolder:h.workspace.workspaceFolders&&h.workspace.workspaceFolders.length>0?h.ConfigurationTarget.Workspace:h.ConfigurationTarget.Global}ne(e){switch(e){case"user":return h.ConfigurationTarget.Global;case"workspace":return h.ConfigurationTarget.Workspace;case"workspaceFolder":return h.ConfigurationTarget.WorkspaceFolder;default:return}}he(e){switch(e){case h.ConfigurationTarget.Global:return"user";case h.ConfigurationTarget.Workspace:return"workspace";case h.ConfigurationTarget.WorkspaceFolder:return"workspaceFolder";default:return"unknown"}}se(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}re(e,t){if(e)switch(t){case h.ConfigurationTarget.Global:return e.globalValue;case h.ConfigurationTarget.Workspace:return e.workspaceValue;case h.ConfigurationTarget.WorkspaceFolder:return e.workspaceFolderValue;default:return}}},B=null;function ot(r){return(!B||r&&r.forceNew)&&(B=new P(r)),B}we.exports={SettingsCoordinator:P,getSettingsCoordinator:ot}});var xe=m((xt,Ee)=>{var p=require("vscode"),{getLogger:it}=L(),{fileSystem:at}=ge(),{normalizePath:z,getRelativePath:lt,getFileName:ct}=C(),{getSettingsCoordinator:ut}=ke(),V=class{constructor(){this._logger=it(),this.d=at,this.F=ut(),this.oe=["node_modules",".npm",".yarn","coverage","nyc_output","dist","build","out","target","bin","obj",".vscode",".idea",".vs",".vscode-test",".git",".svn",".hg",".bzr",".pnpm-store","bower_components","jspm_packages","tmp","temp",".tmp",".cache",".parcel-cache",".DS_Store","Thumbs.db","__pycache__",".pytest_cache",".tox","venv",".env",".virtualenv","vendor",".docker","logs","*.log"],this.ge=new Map,this.ie=new Map,this.ae="explorer-dates-exclusions.json",this.C="workspaceExclusionProfiles",this._logger.info("SmartExclusionManager initialized")}async cleanupAllWorkspaceProfiles(){let e=p.workspace.workspaceFolders||[];if(e.length===0){this._logger.debug("No workspace folders available for exclusion cleanup");return}let t=0;for(let s of e)try{let n=s.uri;await this.K(s.uri,n)&&t++}catch(n){this._logger.warn(`Failed to migrate exclusions for ${s.name}`,n)}t>0?this._logger.info("Migrated workspace exclusion profiles to workspace storage",{workspaces:t}):this._logger.debug("No legacy workspace exclusion profiles required migration")}async analyzeWorkspace(e){try{let t=z(e?.fsPath||e?.path||""),s={detectedPatterns:[],suggestedExclusions:[],projectType:"unknown",riskFolders:[]};s.projectType=await this.le(e);let n=await this.ce(e,t),o=this.ue(n,s.projectType);return s.detectedPatterns=n,s.suggestedExclusions=o.filter(i=>i.score>.7).map(i=>i.pattern),s.riskFolders=o.filter(i=>i.riskLevel==="high").map(i=>i.pattern),this.ie.set(t,s),this._logger.info(`Workspace analysis complete for ${t}`,s),s}catch(t){return this._logger.error("Failed to analyze workspace",t),null}}async le(e){let t=[{file:"package.json",type:"javascript"},{file:"pom.xml",type:"java"},{file:"Cargo.toml",type:"rust"},{file:"setup.py",type:"python"},{file:"requirements.txt",type:"python"},{file:"Gemfile",type:"ruby"},{file:"composer.json",type:"php"},{file:"go.mod",type:"go"},{file:"CMakeLists.txt",type:"cpp"},{file:"Dockerfile",type:"docker"}];if(!e)return"unknown";for(let s of t)try{let n=p.Uri.joinPath(e,s.file);if(await this.d.exists(n))return s.type}catch{}return"unknown"}async ce(e,t,s=2){let n=[],o=async(i,a=0)=>{if(!(a>s))try{let l=await this.d.readdir(i,{withFileTypes:!0});for(let c of l)if(c.isDirectory()){let g=p.Uri.joinPath(i,c.name),w=z(g.fsPath||g.path),y=lt(t,w);this.oe.includes(c.name)&&n.push({name:c.name,path:y,type:"common",size:await this.N(g)});let b=await this.N(g);b>10485760&&n.push({name:c.name,path:y,type:"large",size:b}),await o(g,a+1)}}catch{}};return await o(e),n}async N(e){try{let t=await this.d.readdir(e,{withFileTypes:!0}),s=0,n=0;for(let o of t){if(n>100)break;if(o.isFile())try{let i=p.Uri.joinPath(e,o.name),a=await this.d.stat(i);s+=a.size,n++}catch{}}return s}catch{return 0}}ue(e,t){return e.map(s=>{let n=0,o="low";switch(s.type==="common"&&(n+=.8),s.size>100*1024*1024?(n+=.9,o="high"):s.size>10*1024*1024&&(n+=.5,o="medium"),t){case"javascript":["node_modules",".npm","coverage","dist","build"].includes(s.name)&&(n+=.9);break;case"python":["__pycache__",".pytest_cache","venv",".env"].includes(s.name)&&(n+=.9);break;case"java":["target","build",".gradle"].includes(s.name)&&(n+=.9);break}return["src","lib","app","components","pages"].includes(s.name.toLowerCase())&&(n=0,o="none"),{pattern:s.name,path:s.path,score:Math.min(n,1),riskLevel:o,size:s.size,type:s.type}})}async getWorkspaceExclusions(e){let t=this.U(e);if(!t)return this._logger.debug("No workspace root for exclusions lookup"),[];let s=await this.$(t);return s||await this.K(e,t)||[]}async saveWorkspaceExclusions(e,t){let s=this.U(e);if(!s){this._logger.warn("Cannot save workspace exclusions without a workspace root");return}let n=this.o(t),o=await this.$(s);if(o&&this.de(o,n)){this._logger.debug("Workspace exclusions already up to date",{workspace:this.i(e)});return}await this.G(s,n),await this.B(e),this._logger.info(`Saved workspace exclusions for ${this.i(e)}`,n)}async getCombinedExclusions(e){let t=p.workspace.getConfiguration("explorerDates"),s=t.get("excludedFolders",[]),n=t.get("excludedPatterns",[]),o=t.get("smartExclusions",!0),i=[...s],a=[...n],l=await this.getWorkspaceExclusions(e);if(i.push(...l),o){let c=await this.analyzeWorkspace(e);c&&i.push(...c.suggestedExclusions)}return i=[...new Set(i)],a=[...new Set(a)],{folders:i,patterns:a}}i(e){if(!e)return"unknown-workspace";let t=e.fsPath||e.path||"";return ct(t)||z(t)}async suggestExclusions(e){let t=await this.analyzeWorkspace(e),s=this.o(t?.suggestedExclusions||[]);if(!t||s.length===0)return;let n=await this.getWorkspaceExclusions(e),o=s.filter(c=>!n.includes(c));if(o.length===0){this._logger.debug("No new smart exclusions detected",{workspace:this.i(e)});return}let i=this.z(n,o);await this.saveWorkspaceExclusions(e,i);let a=o.length===1?`Explorer Dates automatically excluded "${o[0]}" to keep Explorer responsive.`:`Explorer Dates automatically excluded ${o.length} folders to keep Explorer responsive.`,l=await p.window.showInformationMessage(`${a} Keep these exclusions?`,"Keep","Review","Revert");l==="Revert"?(await this.saveWorkspaceExclusions(e,n),p.window.showInformationMessage("Smart exclusions reverted. Decorations will refresh for the restored folders."),this._logger.info("User reverted smart exclusions",{reverted:o})):l==="Review"?(this.fe(t),this._logger.info("User reviewing smart exclusions",{pending:o})):this._logger.info("User kept smart exclusions",{accepted:o})}async suggestExclusionsBulk(e=[]){if(!e.length)return;let t=[],s=[],n=[],o=0;for(let c of e){let g=await this.analyzeWorkspace(c.uri),w=this.o(g?.suggestedExclusions||[]);if(!g||w.length===0)continue;let y=await this.getWorkspaceExclusions(c.uri),b=w.filter(W=>!y.includes(W));if(b.length===0){this._logger.debug("No new smart exclusions detected",{workspace:this.i(c.uri)});continue}let F=this.z(y,b);await this.saveWorkspaceExclusions(c.uri,F),t.push({workspace:c.name,added:b}),s.push({uri:c.uri,previous:y}),n.push({workspaceKey:this.i(c.uri),workspaceName:this.V(c.uri),workspaceUri:c.uri,analysis:g,previous:y}),o+=b.length}if(o===0)return;let i=t.length,a=o===1?`Explorer Dates automatically excluded "${t[0].added[0]}" to keep Explorer responsive.`:`Explorer Dates automatically excluded ${o} folders across ${i} workspace${i===1?"":"s"} to keep Explorer responsive.`,l=await p.window.showInformationMessage(`${a} Keep these exclusions?`,"Keep","Review","Revert");if(l==="Revert"){for(let c of s)await this.saveWorkspaceExclusions(c.uri,c.previous);p.window.showInformationMessage("Smart exclusions reverted. Decorations will refresh for the restored folders."),this._logger.info("User reverted smart exclusions",{workspaces:i,reverted:o})}else l==="Review"&&n.length?(this.pe(n),this._logger.info("User reviewing smart exclusions",{pending:o,workspaces:i})):this._logger.info("User kept smart exclusions",{accepted:o,workspaces:i})}V(e){if(!e)return"Workspace";let s=(e.fsPath||e.path||"").split(/[\\/]/).filter(Boolean);return s[s.length-1]||"Workspace"}me(e,t,s){let n=[];for(let o=0;o<t.length;o+=1){let i=t[o],a=s[o],l=e[o];!i||!a||!l||n.push({workspaceKey:this.i(l.uri),workspaceName:this.V(l.uri),workspaceUri:l.uri,analysis:i,previous:a.previous})}return n}U(e){return e||(p.workspace.workspaceFolders?.[0]?.uri??null)}j(e){return e?p.Uri.joinPath(e,".vscode"):null}q(e){let t=this.j(e);return t?p.Uri.joinPath(t,this.ae):null}async $(e){let t=this.q(e);if(!t)return null;try{let s=await this.d.readFile(t,"utf8"),n=JSON.parse(s);return Array.isArray(n)?this.o(n):Array.isArray(n?.exclusions)?this.o(n.exclusions):null}catch(s){return s?.code==="ENOENT"||s?.name==="EntryNotFound"||s?.message?.includes("ENOENT")||this._logger.warn("Failed to read workspace exclusions file",{error:s.message}),null}}async G(e,t){let s=this.q(e);if(!s)return;let n=this.j(e);n&&await this.d.ensureDirectory(n);let o={version:1,updatedAt:new Date().toISOString(),exclusions:t};await this.d.writeFile(s,JSON.stringify(o,null,2))}async K(e,t){let s=this.i(e),n=this.F.getValue(this.C)||{},o=Array.isArray(n[s])?this.o(n[s]):[];return o.length?(t&&(await this.G(t,o),await this.B(e),this._logger.info(`Migrated workspace exclusions for ${s} to workspace settings file`)),o):null}async B(e){let t=this.i(e),s=this.F.getValue(this.C)||{};t in s&&(delete s[t],await this.F.updateSetting(this.C,s,{scope:"user",reason:"workspace-exclusion-migration"}))}o(e=[]){return Array.from(new Set(e.filter(Boolean)))}z(e=[],t=[]){return this.o([...e||[],...t||[]])}de(e=[],t=[]){return e.length!==t.length?!1:e.every((s,n)=>s===t[n])}fe(e){let t=p.window.createWebviewPanel("exclusionReview","Smart Exclusion Review",p.ViewColumn.One,{enableScripts:!0});t.webview.html=this.H([{workspaceKey:"single-workspace",workspaceName:"Workspace",analysis:e,previous:[]}])}pe(e){if(!Array.isArray(e)||e.length===0)return;let t=p.window.createWebviewPanel("exclusionReview","Smart Exclusion Review",p.ViewColumn.One,{enableScripts:!0,retainContextWhenHidden:!0});t.webview.onDidReceiveMessage(async s=>{if(s?.type==="save"&&s.workspaceKey&&Array.isArray(s.exclusions)){let n=e.find(i=>i.workspaceKey===s.workspaceKey);if(!n?.workspaceUri)return;if(await p.window.showWarningMessage(`Apply updated exclusions for ${n.workspaceName}?`,{modal:!0},"Apply","Cancel")!=="Apply"){t.webview.postMessage({type:"saveCanceled",workspaceKey:s.workspaceKey});return}await this.saveWorkspaceExclusions(n.workspaceUri,this.o(s.exclusions)),this._logger.info("Updated smart exclusions from review",{workspace:n.workspaceName,count:s.exclusions.length}),t.webview.postMessage({type:"saved",workspaceKey:s.workspaceKey})}}),t.webview.html=this.H(e)}H(e){let t=i=>{if(i<1024)return`${i} B`;let a=i/1024;return a<1024?`${a.toFixed(1)} KB`:`${(a/1024).toFixed(1)} MB`},s=i=>String(i||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),n=i=>{let a=i.analysis,l=(a?.detectedPatterns||[]).map(c=>`
                <tr>
                    <td>${s(c.name)}</td>
                    <td>${s(c.path)}</td>
                    <td>${t(c.size)}</td>
                    <td>${s(c.type)}</td>
                    <td>
                        <input type="checkbox" data-workspace="${s(i.workspaceKey)}" data-name="${s(c.name)}" ${a?.suggestedExclusions?.includes(c.name)?"checked":""}>
                    </td>
                </tr>
            `).join("");return`
                <section class="workspace">
                    <header>
                        <h2>${s(i.workspaceName)}</h2>
                        <div class="project-info">
                            <div><strong>Project Type:</strong> ${s(a?.projectType||"unknown")}</div>
                            <div><strong>Detected Patterns:</strong> ${a?.detectedPatterns?.length||0}</div>
                            <div><strong>Suggested Exclusions:</strong> ${a?.suggestedExclusions?.length||0}</div>
                        </div>
                        <button class="save" data-workspace="${s(i.workspaceKey)}">Save changes</button>
                        <span class="status" id="status-${s(i.workspaceKey)}"></span>
                    </header>
                    <table>
                        <thead>
                            <tr>
                                <th>Folder</th>
                                <th>Path</th>
                                <th>Size</th>
                                <th>Type</th>
                                <th>Exclude</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${l}
                        </tbody>
                    </table>
                </section>
            `};return`
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>Smart Exclusion Review</title>
                <style>
                    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 16px; }
                    .workspace { margin-bottom: 32px; border: 1px solid var(--vscode-panel-border); border-radius: 6px; padding: 12px; }
                    header { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
                    .project-info { display: flex; gap: 12px; flex-wrap: wrap; font-size: 12px; color: var(--vscode-editor-foreground); }
                    table { width: 100%; border-collapse: collapse; margin-top: 12px; }
                    th, td { padding: 6px 8px; text-align: left; border-bottom: 1px solid var(--vscode-panel-border); }
                    th { background-color: var(--vscode-editor-background); font-weight: bold; }
                    button.save { padding: 6px 12px; }
                    .status { font-size: 12px; color: var(--vscode-descriptionForeground); }
                </style>
            </head>
            <body>
                <h1>\u{1F9E0} Smart Exclusion Review</h1>
                <p>Adjust exclusion selections per workspace and click "Save changes". Each save will ask for confirmation.</p>
                ${e.map(n).join("")}
                <script>
                    const vscode = acquireVsCodeApi();

                    function getSelections(workspaceKey) {
                        const boxes = Array.from(document.querySelectorAll('input[type="checkbox"][data-workspace="' + workspaceKey + '"]'));
                        return boxes.filter((box) => box.checked).map((box) => box.dataset.name);
                    }

                    function setStatus(workspaceKey, text, success) {
                        const el = document.getElementById('status-' + workspaceKey);
                        if (el) {
                            el.textContent = text;
                            el.style.color = success ? 'var(--vscode-testing-iconPassed)' : 'var(--vscode-editor-foreground)';
                        }
                    }

                    document.querySelectorAll('button.save').forEach((button) => {
                        button.addEventListener('click', () => {
                            const workspaceKey = button.dataset.workspace;
                            const exclusions = getSelections(workspaceKey);
                            setStatus(workspaceKey, 'Saving...', false);
                            vscode.postMessage({ type: 'save', workspaceKey, exclusions });
                        });
                    });

                    window.addEventListener('message', (event) => {
                        const message = event.data;
                        if (!message || !message.type) return;
                        if (message.type === 'saved') {
                            setStatus(message.workspaceKey, 'Saved', true);
                        }
                        if (message.type === 'saveCanceled') {
                            setStatus(message.workspaceKey, 'Canceled', false);
                        }
                    });
                <\/script>
            </body>
            </html>
        `}};Ee.exports={SmartExclusionManager:V}});var{IncrementalIndexer:_e}=ie(),{SmartExclusionManager:ve}=xe(),{getLogger:dt}=L(),j=class{constructor(e){this._fileSystem=e,this._logger=dt(),this.r=null,this.e=null,this.y=!1}async initialize(e={}){if(this.y)return;let{batchProcessor:t,enableProgressiveAnalysis:s}=e,n=!!t?.processDirectoryProgressively;this.r||(this.r=new _e(this._fileSystem)),this.r.initialize({batchProcessor:n?t:null,enableProgressiveAnalysis:s}),t&&!n&&this._logger.warn("BatchProcessor missing progressive API; workspace indexing disabled"),this.e||(this.e=new ve),this.y=!0,this._logger.info("Workspace intelligence components initialized")}async analyzeWorkspace(e,t={}){if(!(!this.y||!e?.length))try{if(this.r?.startInitialIndex&&(await this.r.startInitialIndex(e,{maxFiles:t.maxFiles||2e3}),this._logger.info("Workspace indexing started")),this.e)try{await this.e.suggestExclusionsBulk(e),this._logger.info("Smart exclusions analyzed for all workspace folders",{workspaces:e.length})}catch(s){this._logger.error("Failed to analyze smart exclusions for workspace folders",s)}}catch(s){this._logger.error("Failed to analyze workspace",s)}}async cleanupWorkspaceProfiles(){if(this.e)try{await this.e.cleanupAllWorkspaceProfiles()}catch(e){this._logger.warn("Failed to clean workspace exclusion profiles",e)}}async enableProgressiveAnalysis(){return this.r?this.r.enableProgressiveAnalysis():null}disableProgressiveAnalysis(){this.r&&this.r.disableProgressiveAnalysis()}getMetrics(){let e={};return this.r?.getMetrics&&(e.incrementalIndexer=this.r.getMetrics()),this.e?.getMetrics&&(e.smartExclusion=this.e.getMetrics()),e}async onWorkspaceFoldersChanged(e){if(this.y&&(e.added?.length&&await this.analyzeWorkspace(e.added),e.removed?.length&&this.e))for(let t of e.removed)try{await this.e.removeWorkspaceProfile(t.uri)}catch(s){this._logger.warn(`Failed to remove workspace profile for ${t.name}`,s)}}shouldExclude(e){return this.e?this.e.shouldExclude(e):!1}getExclusionPatterns(e){return this.e?this.e.getExclusionPatterns(e):[]}dispose(){this.r?.dispose&&this.r.dispose(),this.e?.dispose&&this.e.dispose(),this.y=!1,this._logger.debug("Workspace intelligence components disposed")}get incrementalIndexer(){return this.r}get smartExclusion(){return this.e}};module.exports={WorkspaceIntelligenceManager:j,IncrementalIndexer:_e,SmartExclusionManager:ve};
})(); (function(){const primaryKey="explorerDatesChunks";const legacyKey="__explorerDatesChunks";const registry=(globalThis[primaryKey]=globalThis[primaryKey]||globalThis[legacyKey]||(globalThis[legacyKey]={}));registry["workspaceIntelligence"]=module.exports;})();
