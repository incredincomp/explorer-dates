var module = { exports: {} }; var exports = module.exports; (function() {
var E=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var $=E((Je,V)=>{var U=require("vscode");function ge(){try{return U?.env?.uiKind===U?.UIKind?.Web}catch{return!1}}V.exports={isWebEnvironment:ge}});var O=E((Xe,q)=>{function C(s=""){return s?s.replace(/\\/g,"/"):""}function me(s=""){let e=C(s);return e?e.split("/").filter(Boolean):[]}function K(s=""){let e=me(s);return e.length?e[e.length-1]:""}function we(s=""){let e=K(s),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function ye(s=""){let e=C(s),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function Ee(...s){return C(s.filter(Boolean).join("/")).replace(/\/+/g,"/")}function De(s=""){return C(s).toLowerCase()}function Ce(s=""){if(!s)return"";if(typeof s=="string")return s;if(typeof s.fsPath=="string"&&s.fsPath.length>0)return s.fsPath;if(typeof s.path=="string"&&s.path.length>0)return s.path;if(typeof s.toString=="function")try{return s.toString(!0)}catch{return s.toString()}return String(s)}function Se(s="",e=""){let t=C(s),o=C(e);return t&&o.startsWith(t)?o.substring(t.length).replace(/^\/+/,""):o}q.exports={normalizePath:C,getFileName:K,getExtension:we,getDirectory:ye,joinPath:Ee,getCacheKey:De,getUriPath:Ce,getRelativePath:Se}});var j=E((Qe,B)=>{var N=class extends Error{constructor(e,t,o={}){super(t),this.code=e,this.context=o,this.name="ExtensionError"}},Le={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function Fe(s){if(!s)return!1;let e=s.code||s?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}B.exports={ExtensionError:N,ERROR_CODES:Le,isPermissionError:Fe}});var P=E((Ze,Y)=>{function z(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function H(s){return!!(s&&typeof s=="object"&&typeof s.getTime=="function")}function F(s){if(!s||isNaN(s))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(s)}catch{}let e=864e5,t=36e5,o=6e4,n=1e3,i=1970,r=4,c=Math.floor(s/e),l=s%e,f=Math.floor(l/t),w=Math.floor(l%t/o),u=Math.floor(l%o/n),D=i+Math.floor(c/365.25),y=Math.floor(c%365.25/30.44)+1,m=Math.floor(c%30.44)+1,A=String(Math.min(y,12)).padStart(2,"0"),fe=String(Math.min(m,31)).padStart(2,"0"),de=String(f).padStart(2,"0"),he=String(w).padStart(2,"0"),pe=String(u).padStart(2,"0");return`${A}/${fe}/${D}, ${de}:${he}:${pe}`}function be(s){if(H(s))return s;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(s==null){if(!e){let t=z();return{getTime:()=>t,toLocaleString:()=>F(t),toString:()=>F(t)}}return new Date}if(typeof s=="number")return e?new Date(s):{getTime:()=>s,toLocaleString:()=>F(s),toString:()=>F(s)};if(typeof s=="string"){let t=0;if(e)t=Date.parse(s);else{let o=parseFloat(s);t=isNaN(o)?0:o}return e?new Date(s):{getTime:()=>t,toLocaleString:()=>F(t),toString:()=>F(t)}}return e?new Date(s):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}Y.exports={ensureDate:be,isDateLike:H,getCurrentTimestamp:z}});var Q=E((et,X)=>{var d=require("vscode"),{isWebEnvironment:Oe}=$(),{normalizePath:Te}=O(),{ExtensionError:ke,ERROR_CODES:Ie,isPermissionError:_e}=j(),{ensureDate:v}=P(),J=process.env.VSCODE_WEB==="true",Re=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",h=null;if(!J&&!Re)try{h=require("fs").promises}catch{h=null}var T=class{constructor(){this.isWeb=J||Oe()}s(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}o(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return d.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.o(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return d.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return d.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return d.Uri.parse(e.href);if(typeof e.scheme=="string")return d.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return d.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return d.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&h)return h.stat(this.s(e));let t=this.o(e),o=await d.workspace.fs.stat(t);return{...o,mtime:v(o.mtime),ctime:v(o.ctime),birthtime:v(o.ctime),isFile:()=>o.type===d.FileType.File,isDirectory:()=>o.type===d.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&h)return h.readFile(this.s(e),t);let o=this.o(e),n=await d.workspace.fs.readFile(o);return t===null||t==="binary"?n:new TextDecoder(t).decode(n)}async writeFile(e,t,o="utf8"){let n=this.s(e);try{if(!this.isWeb&&h)return h.writeFile(n,t,o);let i=this.o(e),r=typeof t=="string"?new TextEncoder().encode(t):t;await d.workspace.fs.writeFile(i,r)}catch(i){this.p("write file",n,i)}}async mkdir(e,t={recursive:!0}){let o=this.s(e);try{if(!this.isWeb&&h)return h.mkdir(o,t);let n=this.o(e);await d.workspace.fs.createDirectory(n)}catch(n){this.p("create directory",o,n)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&h)return h.readdir(this.s(e),t);let o=this.o(e),n=await d.workspace.fs.readDirectory(o);return t.withFileTypes?n.map(([i,r])=>({name:i,isDirectory:()=>r===d.FileType.Directory,isFile:()=>r===d.FileType.File})):n.map(([i])=>i)}async delete(e,t={recursive:!1}){if(!this.isWeb&&h){let n=this.s(e);return t.recursive?h.rm?h.rm(n,t):h.rmdir(n,t):h.unlink(n)}let o=this.o(e);await d.workspace.fs.delete(o,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=Te(this.s(e));await this.mkdir(t,{recursive:!0})}p(e,t,o){throw _e(o)?new ke(Ie.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:o.code}):o}},xe=new T;X.exports={FileSystemAdapter:T,fileSystem:xe}});var oe=E((tt,se)=>{var Ae="__explorerDatesVscode",S=null,k=null,I=!1;function Ne(){try{return globalThis[Ae]}catch{return}}function te(){if(k)return k;let s={get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})};return k={workspace:{workspaceFolders:[],getConfiguration:()=>s},ConfigurationTarget:{Global:1,Workspace:2,WorkspaceFolder:3}},k}var Pe=new Set(["MODULE_NOT_FOUND","ERR_MODULE_NOT_FOUND","WEB_NATIVE_MODULE"]);function ve(s){return!s||s.code&&Pe.has(s.code)?!0:(typeof s.message=="string"?s.message:"").includes("Cannot find module 'vscode'")}function b(){let s=Ne();if(s)return S=M(s),I=!1,S;if(S&&!I)return S;try{S=M(require("vscode")),I=!1}catch(e){if(ve(e))S=M(te()),I=!0;else throw e}return S}var g=new Proxy({},{get(s,e){return b()[e]},set(s,e,t){return b()[e]=t,!0},has(s,e){return e in b()},ownKeys(){return Reflect.ownKeys(b())},getOwnPropertyDescriptor(s,e){let t=Object.getOwnPropertyDescriptor(b(),e);return t&&(t.configurable=!0),t}}),Me="explorerDates",Z="__explorerDatesConfigWrapped";function ee(s){return!s||typeof s!="object"?{get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})}:(typeof s.get!="function"&&(s.get=()=>{}),typeof s.update!="function"&&(s.update=async()=>{}),typeof s.inspect!="function"&&(s.inspect=()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})),s)}function M(s){if(!s)return te();s.ConfigurationTarget||(s.ConfigurationTarget={Global:1,Workspace:2,WorkspaceFolder:3}),s.workspace||(s.workspace={});let e=s.workspace.getConfiguration;if(typeof e=="function"&&!e[Z]){let t=function(...o){let n=e.apply(this,o);return ee(n)};t[Z]=!0,s.workspace.getConfiguration=t}else typeof e!="function"&&(s.workspace.getConfiguration=()=>ee());return Array.isArray(s.workspace.workspaceFolders)||(s.workspace.workspaceFolders=[]),s}var _=class{constructor(e={}){this.D=e.defaultSection||Me}getValue(e,t={}){let{section:o,resource:n}=t,i=this.c(e,o);return this.l(i.section,n).get(i.key)}inspect(e,t={}){let{section:o,resource:n}=t,i=this.c(e,o);return this.l(i.section,n).inspect(i.key)}async updateSetting(e,t,o={}){let{scope:n="auto",resource:i,section:r,reason:c="",force:l=!1}=o,f=this.c(e,r),w=this.l(f.section,i),u=this.C(n,i),D=w.get(f.key),y=w.inspect(f.key),m=this.S(y,u);return t!==void 0&&this.L(D,t)&&!l&&m!==void 0?{key:f.fullKey,updated:!1,reason:"unchanged"}:(await w.update(f.key,t,u),{key:f.fullKey,updated:!0})}async applySettings(e,t={}){let o=Array.isArray(e)?e:Object.entries(e).map(([i,r])=>({key:i,value:r})),n=[];for(let i of o){let r={...t,...i.options||{}};n.push(await this.updateSetting(i.key,i.value,r))}return n}async clearSetting(e,t={}){return this.updateSetting(e,void 0,t)}l(e,t){return g.workspace.getConfiguration(e||void 0,t)}c(e,t){let o=t||this.D;if(!o)return{section:void 0,key:e,fullKey:e};if(e.startsWith(`${o}.`)){let n=e.slice(o.length+1);return{section:o,key:n,fullKey:e}}return e.includes(".")?{section:void 0,key:e,fullKey:e}:{section:o,key:e,fullKey:`${o}.${e}`}}C(e,t){return e&&e!=="auto"?this.F(e)||g.ConfigurationTarget.Workspace:t?g.ConfigurationTarget.WorkspaceFolder:g.workspace.workspaceFolders&&g.workspace.workspaceFolders.length>0?g.ConfigurationTarget.Workspace:g.ConfigurationTarget.Global}F(e){switch(e){case"user":return g.ConfigurationTarget.Global;case"workspace":return g.ConfigurationTarget.Workspace;case"workspaceFolder":return g.ConfigurationTarget.WorkspaceFolder;default:return}}v(e){switch(e){case g.ConfigurationTarget.Global:return"user";case g.ConfigurationTarget.Workspace:return"workspace";case g.ConfigurationTarget.WorkspaceFolder:return"workspaceFolder";default:return"unknown"}}L(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}S(e,t){if(e)switch(t){case g.ConfigurationTarget.Global:return e.globalValue;case g.ConfigurationTarget.Workspace:return e.workspaceValue;case g.ConfigurationTarget.WorkspaceFolder:return e.workspaceFolderValue;default:return}}},G=null;function Ge(s){return(!G||s&&s.forceNew)&&(G=new _(s)),G}se.exports={SettingsCoordinator:_,getSettingsCoordinator:Ge}});var R=E((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?s=>{if(typeof s=="string")return s;try{return JSON.stringify(s,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",Logger=class{constructor(){this.t=vscode.window.createOutputChannel("Explorer Dates"),this.u=!1,this.i=null,this.r=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.r)||(this.r=DEFAULT_LOG_PROFILE),this.n=new Map,this.g=DEFAULT_CONSOLE_LEVEL,this.m(),this.i=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.m()})}m(){let e=vscode.workspace.getConfiguration("explorerDates");this.u=e.get("enableLogging",!1);let t=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase();this.g=LOG_LEVEL_ORDER.includes(t)?t:DEFAULT_CONSOLE_LEVEL}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.r=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.n.delete(e);return}this.n.clear()}debug(e,...t){this.u&&this.a("debug",null,e,t)}info(e,...t){this.a("info",null,e,t)}infoWithOptions(e,t,...o){this.a("info",e||null,t,o)}warn(e,...t){this.a("warn",null,e,t)}error(e,t,...o){let i=`[${new Date().toISOString()}] [ERROR] ${e}`;this.t.appendLine(i),t instanceof Error?(this.t.appendLine(`Error: ${t.message}`),t.stack&&this.t.appendLine(`Stack: ${t.stack}`)):t&&this.t.appendLine(this.f(t));let r=this.w(o);r.length>0&&r.forEach(c=>this.t.appendLine(this.f(c))),this.d("error",i,[t,...r])}show(){this.t.show()}clear(){this.t.clear()}dispose(){this.t.dispose(),this.i&&(this.i.dispose(),this.i=null);let e="__explorerDatesLogger";typeof global<"u"&&global[e]===this?global[e]=null:typeof globalThis<"u"&&globalThis[e]===this?globalThis[e]=null:typeof window<"u"&&window[e]===this&&(window[e]=null),loggerInstance===this&&(loggerInstance=null)}a(e,t,o,n){if(e==="debug"&&!this.u||this.b(e,t))return;let r=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${o}`;this.t.appendLine(r);let c=this.w(n);c.length>0&&c.forEach(l=>this.t.appendLine(this.f(l))),this.d(e,r,c)}w(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(o){return`<<log arg threw: ${o.message}>>`}})}f(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}b(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let o=(t.profile||"stress").toLowerCase();if(!this.O(o))return!1;let n=Number(t.throttleLimit)||50,i=t.throttleKey,r=this.n.get(i)||{count:0,suppressed:0,noticeLogged:!1};if(r.count<n)return r.count+=1,this.n.set(i,r),!1;if(r.suppressed+=1,!r.noticeLogged){r.noticeLogged=!0;let c=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${i}" after ${n} entries (profile=${this.r})`;this.t.appendLine(c),this.d("info",c)}return this.n.set(i,r),!0}O(e){let t=this.r||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}T(e){let t=LOG_LEVEL_ORDER.indexOf(this.g),o=LOG_LEVEL_ORDER.indexOf(e);return t===-1||o===-1?!1:o>=t}d(e,t,o=[]){if(!this.T(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...o)}},GLOBAL_LOGGER_KEY="__explorerDatesLogger";function getLogger(){return typeof global<"u"?(global[GLOBAL_LOGGER_KEY]||(global[GLOBAL_LOGGER_KEY]=new Logger),global[GLOBAL_LOGGER_KEY]):typeof globalThis<"u"?(globalThis[GLOBAL_LOGGER_KEY]||(globalThis[GLOBAL_LOGGER_KEY]=new Logger),globalThis[GLOBAL_LOGGER_KEY]):typeof window<"u"?(window[GLOBAL_LOGGER_KEY]||(window[GLOBAL_LOGGER_KEY]=new Logger),window[GLOBAL_LOGGER_KEY]):(loggerInstance||(loggerInstance=new Logger),loggerInstance)}var loggerInstance=null;module.exports={Logger,getLogger}});var ne=E((st,re)=>{var p=require("vscode"),{getLogger:We}=R(),W=class{constructor(e){this.h=We(),this.e=e,this.M=[]}async runComprehensiveDiagnostics(){this.h.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let e={timestamp:new Date().toISOString(),vscodeVersion:p.version,extensionVersion:p.extensions.getExtension("incredincomp.explorer-dates")?.packageJSON?.version,tests:{}};return e.tests.vscodeSettings=await this.k(),e.tests.providerRegistration=await this.I(),e.tests.fileProcessing=await this._(),e.tests.decorationCreation=await this.R(),e.tests.cacheAnalysis=await this.x(),e.tests.extensionConflicts=await this.A(),e.tests.uriPathIssues=await this.N(),this.h.info("\u{1F50D} Comprehensive diagnostics completed",e),e}async k(){let e=p.workspace.getConfiguration("explorer"),t=p.workspace.getConfiguration("workbench"),o=p.workspace.getConfiguration("explorerDates"),n={"explorer.decorations.badges":e.get("decorations.badges"),"explorer.decorations.colors":e.get("decorations.colors"),"workbench.colorTheme":t.get("colorTheme"),"explorerDates.showDateDecorations":o.get("showDateDecorations"),"explorerDates.colorScheme":o.get("colorScheme"),"explorerDates.showGitInfo":o.get("showGitInfo")},i=[];return n["explorer.decorations.badges"]===!1&&i.push("CRITICAL: explorer.decorations.badges is disabled"),n["explorer.decorations.colors"]===!1&&i.push("WARNING: explorer.decorations.colors is disabled"),n["explorerDates.showDateDecorations"]===!1&&i.push("CRITICAL: explorerDates.showDateDecorations is disabled"),{status:i.length>0?"ISSUES_FOUND":"OK",settings:n,issues:i}}async I(){let e=[];if(!this.e)return e.push("CRITICAL: Decoration provider is null/undefined"),{status:"FAILED",issues:e};typeof this.e.provideFileDecoration!="function"&&e.push("CRITICAL: provideFileDecoration method missing"),this.e.onDidChangeFileDecorations||e.push("WARNING: onDidChangeFileDecorations event emitter missing");let t=p.Uri.file("/test/path");try{let o=await this.e.provideFileDecoration(t);this.h.debug("Provider test call completed",{result:!!o})}catch(o){e.push(`ERROR: Provider test call failed: ${o.message}`)}return{status:e.length>0?"ISSUES_FOUND":"OK",providerActive:!!this.e,issues:e}}async _(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace folders available"]};let t=[],o=[];try{let n=["package.json","README.md","extension.js","src/logger.js"];for(let i of n){let r=p.Uri.joinPath(e[0].uri,i);try{await p.workspace.fs.stat(r);let c=this.e.y?await this.e.y(r):!1,l=await this.e.provideFileDecoration(r);t.push({file:i,exists:!0,excluded:c,hasDecoration:!!l,badge:l?.badge,uri:r.toString()})}catch(c){t.push({file:i,exists:!1,error:c.message})}}}catch(n){o.push(`File processing test failed: ${n.message}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",testFiles:t,issues:o}}async R(){let e=[],t=[];try{let n=new p.FileDecoration("test");e.push({name:"Simple decoration",success:!0,badge:n.badge})}catch(n){e.push({name:"Simple decoration",success:!1,error:n.message}),t.push("CRITICAL: Cannot create simple FileDecoration")}try{let n=new p.FileDecoration("test","Test tooltip");e.push({name:"Decoration with tooltip",success:!0,hasTooltip:!!(n&&n.tooltip)})}catch(n){e.push({name:"Decoration with tooltip",success:!1,error:n.message}),t.push("WARNING: Cannot create FileDecoration with tooltip")}try{let n=new p.FileDecoration("test","Test tooltip",new p.ThemeColor("charts.red"));e.push({name:"Decoration with color",success:!0,hasColor:!!n.color})}catch(n){e.push({name:"Decoration with color",success:!1,error:n.message}),t.push("WARNING: Cannot create FileDecoration with color")}let o=["1d","10m","2h","!!","\u25CF\u25CF","JA12","123456789"];for(let n of o)try{let i=new p.FileDecoration(n);e.push({name:`Badge format: ${n}`,success:!0,badge:i.badge,length:n.length})}catch(i){e.push({name:`Badge format: ${n}`,success:!1,error:i.message}),n.length<=8&&t.push(`WARNING: Valid badge format '${n}' failed`)}return{status:t.length>0?"ISSUES_FOUND":"OK",tests:e,issues:t}}async x(){let e={memoryCache:{size:this.e.G?.size||0,maxSize:this.e.W||0},advancedCache:{available:!!this.e.U,initialized:!1},metrics:this.e.getMetrics?this.e.getMetrics():null},t=[];return e.memoryCache.size>e.memoryCache.maxSize*.9&&t.push("WARNING: Memory cache is nearly full"),e.metrics&&e.metrics.cacheHits===0&&e.metrics.cacheMisses>10&&t.push("WARNING: Cache hit rate is 0% - potential cache key issues"),{status:t.length>0?"ISSUES_FOUND":"OK",cacheInfo:e,issues:t}}async A(){let e=p.extensions.all,t=[],o=[];for(let i of e){if(!i.isActive)continue;let r=i.packageJSON;r.contributes?.commands?.some(l=>l.command?.includes("decoration")||l.title?.includes("decoration")||l.title?.includes("badge")||l.title?.includes("explorer"))&&o.push({id:i.id,name:r.displayName||r.name,version:r.version}),["file-icons","vscode-icons","material-icon-theme","explorer-exclude","hide-files","file-watcher"].some(l=>i.id.includes(l))&&t.push({id:i.id,name:r.displayName||r.name,reason:"Known to potentially interfere with file decorations"})}let n=[];return o.length>1&&n.push(`WARNING: ${o.length} extensions might provide file decorations`),t.length>0&&n.push(`WARNING: ${t.length} potentially conflicting extensions detected`),{status:n.length>0?"ISSUES_FOUND":"OK",decorationExtensions:o,potentialConflicts:t,issues:n}}async N(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace available for URI testing"]};let t=[],o=[],n=["package.json","src/logger.js","README.md",".gitignore"];for(let i of n){let r=p.Uri.joinPath(e[0].uri,i);t.push({path:i,scheme:r.scheme,fsPath:r.fsPath,authority:r.authority,valid:r.scheme==="file"&&r.fsPath.length>0}),r.scheme!=="file"&&o.push(`WARNING: Non-file URI scheme for ${i}: ${r.scheme}`),(r.fsPath.includes("\\\\")||r.fsPath.includes("//"))&&o.push(`WARNING: Potential path separator issues in ${i}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",tests:t,issues:o}}};re.exports={DecorationDiagnostics:W}});var ae=E((ot,ie)=>{var L=require("vscode"),{getFileName:Ue}=O();async function Ve(){let s=R().getLogger();s.info("\u{1F3A8} Testing VS Code decoration rendering...");class e{constructor(){this.E=new L.EventEmitter,this.onDidChangeFileDecorations=this.E.event}provideFileDecoration(i){let r=Ue(i.fsPath||i.path),c=new L.FileDecoration("TEST");return c.tooltip=`Test decoration for ${r}`,c.color=new L.ThemeColor("charts.red"),s.info(`\u{1F9EA} Test provider returning decoration for: ${r}`),c}}let t=new e,o=L.window.registerFileDecorationProvider(t);return s.info("\u{1F9EA} Test decoration provider registered"),setTimeout(()=>{t.E.fire(void 0),s.info("\u{1F504} Test decoration refresh triggered"),setTimeout(()=>{o.dispose(),s.info("\u{1F9EA} Test decoration provider disposed")},1e4)},1e3),"Test decoration provider registered for 10 seconds"}async function $e(){let s=R().getLogger();s.info("\u{1F527} Testing FileDecoration API...");let e=[];try{let o=new L.FileDecoration("MIN");e.push({name:"Minimal decoration",success:!0,badge:o.badge}),s.info("\u2705 Minimal decoration created successfully")}catch(o){e.push({name:"Minimal decoration",success:!1,error:o.message}),s.error("\u274C Minimal decoration failed:",o)}try{let o=new L.FileDecoration("FULL","Full decoration tooltip",new L.ThemeColor("charts.blue"));o.propagate=!1,e.push({name:"Full decoration",success:!0,badge:o.badge,hasTooltip:!!o.tooltip,hasColor:!!o.color,propagate:o.propagate}),s.info("\u2705 Full decoration created successfully")}catch(o){e.push({name:"Full decoration",success:!1,error:o.message}),s.error("\u274C Full decoration failed:",o)}let t=["charts.red","charts.blue","charts.green","charts.yellow","terminal.ansiRed","terminal.ansiGreen","terminal.ansiBlue","editorError.foreground","editorWarning.foreground","editorInfo.foreground"];for(let o of t)try{e.push({name:`ThemeColor: ${o}`,success:!0,colorId:o})}catch(n){e.push({name:`ThemeColor: ${o}`,success:!1,error:n.message}),s.error(`\u274C ThemeColor ${o} failed:`,n)}return e}ie.exports={testVSCodeDecorationRendering:Ve,testFileDecorationAPI:$e}});var le=E((rt,ce)=>{var a=require("vscode"),{fileSystem:Ke}=Q(),{getFileName:qe,getRelativePath:Be}=O(),{ensureDate:je}=P(),{getSettingsCoordinator:ze}=oe(),x=ze();function He({context:s,fileDateProvider:e,logger:t,chunkLoader:o}){let n=[];async function i(){try{let r=await o.loadChunk("diagnostics");if(!r)throw new Error("Diagnostics chunk not available");return s&&r.ensureInitialized(s),{generateWorkspaceActivityHTML:r.generateWorkspaceActivityHTML,generatePerformanceAnalyticsHTML:r.generatePerformanceAnalyticsHTML,generateDiagnosticsHTML:r.generateDiagnosticsHTML,generateDiagnosticsWebview:r.generateDiagnosticsWebview}}catch(r){throw new Error(`Failed to load diagnostics generators: ${r.message}`)}}n.push(a.commands.registerCommand("explorerDates.showWorkspaceActivity",async()=>{try{if(!a.workspace.getConfiguration("explorerDates").get("enableAnalysisCommands",!0)){a.window.showInformationMessage("Analysis commands are disabled. Enable explorerDates.enableAnalysisCommands to use this feature.");return}let{generateWorkspaceActivityHTML:l}=await i(),f=a.window.createWebviewPanel("workspaceActivity","Workspace File Activity",a.ViewColumn.One,{enableScripts:!0});if(!a.workspace.workspaceFolders){a.window.showWarningMessage("No workspace folder open");return}let w=a.workspace.workspaceFolders[0],u=[],D=await a.workspace.findFiles("**/*","**/node_modules/**",100);for(let y of D)try{let m=await Ke.stat(y);(typeof m.isFile=="function"?m.isFile():!0)&&u.push({path:Be(w.uri.fsPath||w.uri.path,y.fsPath||y.path),modified:je(m.mtime),size:m.size})}catch{}u.sort((y,m)=>m.modified.getTime()-y.modified.getTime()),f.webview.html=await l(u.slice(0,50)),t.info("Workspace activity panel opened")}catch(r){t.error("Failed to show workspace activity",r),a.window.showErrorMessage(`Failed to show workspace activity: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.showPerformanceAnalytics",async()=>{try{let{generatePerformanceAnalyticsHTML:r}=await i(),c=a.window.createWebviewPanel("performanceAnalytics","Explorer Dates Performance Analytics",a.ViewColumn.One,{enableScripts:!0}),l=e?e.getMetrics():{};c.webview.html=await r(l),t.info("Performance analytics panel opened")}catch(r){t.error("Failed to show performance analytics",r),a.window.showErrorMessage(`Failed to show performance analytics: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.debugCache",async()=>{try{if(e){let r=e.getMetrics(),c={"Cache Summary":{"Memory Cache Size":r.cacheSize,"Cache Hit Rate":r.cacheHitRate,"Total Hits":r.cacheHits,"Total Misses":r.cacheMisses,"Cache Timeout":`${r.cacheDebugging.cacheTimeout}ms`},"Advanced Cache":r.advancedCache||"Not available","Cache Namespace":r.cacheDebugging.cacheNamespace||"default","Sample Cache Keys":r.cacheDebugging.memoryCacheKeys||[]};a.window.showInformationMessage(`Cache Debug Info:
${JSON.stringify(c,null,2)}`,{modal:!0}),t.info("Cache debug info displayed",c)}}catch(r){t.error("Failed to show cache debug info",r),a.window.showErrorMessage(`Failed to show cache debug info: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.runDiagnostics",async()=>{try{let{generateDiagnosticsHTML:r}=await i(),c=a.workspace.getConfiguration("explorerDates"),l=a.window.activeTextEditor,f={"Extension Status":{"Provider Active":e?"Yes":"No","Decorations Enabled":c.get("showDateDecorations",!0)?"Yes":"No","VS Code Version":a.version,"Extension Version":s.extension.packageJSON.version}};if(l){let{uri:u}=l.document;u.scheme==="file"&&(f["Current File"]={"File Path":u.fsPath,"File Extension":qe(u.fsPath||u.path).split(".").pop()||"No extension","Is Excluded":e?await e.y(u):"Unknown"})}if(f.Configuration={"Excluded Folders":c.get("excludedFolders",[]),"Excluded Patterns":c.get("excludedPatterns",[]),"Color Scheme":c.get("colorScheme","none"),"Cache Timeout":`${c.get("cacheTimeout",3e4)}ms`},e){let u=e.getMetrics();f.Performance={"Total Decorations":u.totalDecorations,"Cache Size":u.cacheSize,"Cache Hit Rate":u.cacheHitRate,Errors:u.errors},u.performanceTiming&&(f["Performance Timing"]={"Avg Git Blame (ms)":u.performanceTiming.avgGitBlameMs,"Avg File Stat (ms)":u.performanceTiming.avgFileStatMs,"Git Calls":u.performanceTiming.gitBlameCalls,"File Stat Calls":u.performanceTiming.fileStatCalls,"Total Git Time (ms)":u.performanceTiming.totalGitBlameTimeMs,"Total File Stat Time (ms)":u.performanceTiming.totalFileStatTimeMs})}let w=a.window.createWebviewPanel("explorerDatesDiagnostics","Explorer Dates Diagnostics",a.ViewColumn.One,{enableScripts:!0});w.webview.html=await r(f),t.info("Diagnostics panel opened",f)}catch(r){t.error("Failed to run diagnostics",r),a.window.showErrorMessage(`Failed to run diagnostics: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.testDecorations",async()=>{try{let{generateDiagnosticsWebview:r}=await i();t.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let{DecorationDiagnostics:c}=ne(),f=await new c(e).runComprehensiveDiagnostics(),w=a.window.createWebviewPanel("decorationDiagnostics","Decoration Diagnostics - Root Cause Analysis",a.ViewColumn.One,{enableScripts:!0});w.webview.html=await r(f);let u=[],D=[];Object.values(f.tests).forEach(y=>{y.issues&&y.issues.forEach(m=>{m.startsWith("CRITICAL:")?u.push(m):m.startsWith("WARNING:")&&D.push(m)})}),u.length>0?a.window.showErrorMessage(`CRITICAL ISSUES FOUND: ${u.join(", ")}`):D.length>0?a.window.showWarningMessage(`Warnings found: ${D.length} potential issues detected. Check diagnostics panel.`):a.window.showInformationMessage("No critical issues found. Decorations should be working properly."),t.info("\u{1F50D} Comprehensive diagnostics completed",f)}catch(r){t.error("Failed to run comprehensive diagnostics",r),a.window.showErrorMessage(`Diagnostics failed: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.monitorDecorations",async()=>{if(!e){a.window.showErrorMessage("Decoration provider not available");return}e.startProviderCallMonitoring(),e.forceRefreshAllDecorations(),setTimeout(()=>{let r=e.getProviderCallStats(),c=`VS Code Decoration Requests: ${r.totalCalls} calls for ${r.uniqueFiles} files`;a.window.showInformationMessage(c),t.info("\u{1F50D} Decoration monitoring results:",r)},5e3),a.window.showInformationMessage("Started monitoring VS Code decoration requests. Results in 5 seconds...")})),n.push(a.commands.registerCommand("explorerDates.testVSCodeRendering",async()=>{try{let{testVSCodeDecorationRendering:r,testFileDecorationAPI:c}=ae();t.info("\u{1F3A8} Testing VS Code decoration rendering system...");let l=await c();t.info("\u{1F527} FileDecoration API tests:",l);let f=await r();t.info("\u{1F3A8} Decoration rendering test:",f),a.window.showInformationMessage('VS Code decoration rendering test started. Check Output panel and Explorer for "TEST" badges on files.')}catch(r){t.error("Failed to test VS Code rendering:",r),a.window.showErrorMessage(`VS Code rendering test failed: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.quickFix",async()=>{try{let r=[];x.getValue("showDateDecorations")||r.push({issue:"Date decorations are disabled",description:"Enable date decorations",fix:async()=>x.updateSetting("showDateDecorations",!0,{scope:"user",reason:"quick-fix"})});let c=x.getValue("excludedPatterns")||[];if(c.includes("**/*")&&r.push({issue:"All files are excluded by pattern",description:"Remove overly broad exclusion pattern",fix:async()=>{let f=c.filter(w=>w!=="**/*");await x.updateSetting("excludedPatterns",f,{scope:"user",reason:"quick-fix"})}}),r.length===0){a.window.showInformationMessage("No common issues detected. Decorations should be working.");return}let l=await a.window.showQuickPick(r.map(f=>({label:f.description,description:f.issue,fix:f.fix})),{placeHolder:"Select an issue to fix automatically"});l&&(await l.fix(),a.window.showInformationMessage("Fixed! Try refreshing decorations now."),e&&(e.clearAllCaches(),e.refreshAll()))}catch(r){t.error("Failed to run quick fix",r),a.window.showErrorMessage(`Failed to run quick fix: ${r.message}`)}})),n.push(a.commands.registerCommand("explorerDates.showKeyboardShortcuts",async()=>{try{e?.P?await e.P.showKeyboardShortcutsHelp():a.window.showInformationMessage("Keyboard shortcuts: Ctrl+Shift+D (toggle), Ctrl+Shift+C (copy date), Ctrl+Shift+I (file details), Ctrl+Shift+R (refresh), Ctrl+Shift+A (workspace activity)"),t.info("Keyboard shortcuts help shown")}catch(r){t.error("Failed to show keyboard shortcuts help",r),a.window.showErrorMessage(`Failed to show keyboard shortcuts help: ${r.message}`)}})),n.forEach(r=>s.subscriptions.push(r))}ce.exports={registerAnalysisCommands:He}});var ue=le();module.exports={...ue,registerAnalysisCommands:ue.registerAnalysisCommands};
})(); (globalThis.__explorerDatesChunks = globalThis.__explorerDatesChunks || {})["analysis"] = module.exports;
