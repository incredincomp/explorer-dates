var E=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var K=E((Xe,$)=>{var U=require("vscode");function me(){try{return U?.env?.uiKind===U?.UIKind?.Web}catch{return!1}}$.exports={isWebEnvironment:me}});var F=E((Qe,B)=>{function C(s=""){return s?s.replace(/\\/g,"/"):""}function we(s=""){let e=C(s);return e?e.split("/").filter(Boolean):[]}function q(s=""){let e=we(s);return e.length?e[e.length-1]:""}function ye(s=""){let e=q(s),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function Ee(s=""){let e=C(s),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function De(...s){return C(s.filter(Boolean).join("/")).replace(/\/+/g,"/")}function Ce(s=""){return C(s).toLowerCase()}function Le(s=""){if(!s)return"";if(typeof s=="string")return s;if(typeof s.fsPath=="string"&&s.fsPath.length>0)return s.fsPath;if(typeof s.path=="string"&&s.path.length>0)return s.path;if(typeof s.toString=="function")try{return s.toString(!0)}catch{return s.toString()}return String(s)}function Se(s="",e=""){let t=C(s),o=C(e);return t&&o.startsWith(t)?o.substring(t.length).replace(/^\/+/,""):o}B.exports={normalizePath:C,getFileName:q,getExtension:ye,getDirectory:Ee,joinPath:De,getCacheKey:Ce,getUriPath:Le,getRelativePath:Se}});var H=E((Ze,z)=>{var T=class extends Error{constructor(e,t,o={}){super(t),this.code=e,this.context=o,this.name="ExtensionError"}},j={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function be(s){if(!s)return!1;let e=s.code||s?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}var N=class extends T{constructor(e,t,o={}){let{recoverable:n=!0,context:i={}}=o;super(j.CHUNK_LOAD_FAILED,`Failed to load ${e}: ${t}`,{chunkName:e,recoverable:n,...i}),this.name="ChunkLoadError",this.chunkName=e,this.recoverable=n}};function Oe(s,e,t={}){let o=require("vscode"),{userFacing:n=!0}=t,i=e?.recoverable??!0;n&&!i&&o.window.showErrorMessage(`Explorer Dates: ${s} feature unavailable. Please reinstall or rebuild the extension.`)}z.exports={ExtensionError:T,ERROR_CODES:j,isPermissionError:be,ChunkLoadError:N,handleChunkFailure:Oe}});var v=E((et,X)=>{function Y(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function J(s){return!!(s&&typeof s=="object"&&typeof s.getTime=="function")}function b(s){if(!s||isNaN(s))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(s)}catch{}let e=864e5,t=36e5,o=6e4,n=1e3,i=1970,r=Math.floor(s/e),a=s%e,l=Math.floor(a/t),f=Math.floor(a%t/o),w=Math.floor(a%o/n),u=i+Math.floor(r/365.25),D=Math.floor(r%365.25/30.44)+1,y=Math.floor(r%30.44)+1,m=String(Math.min(D,12)).padStart(2,"0"),V=String(Math.min(y,31)).padStart(2,"0"),he=String(l).padStart(2,"0"),pe=String(f).padStart(2,"0"),ge=String(w).padStart(2,"0");return`${m}/${V}/${u}, ${he}:${pe}:${ge}`}function Fe(s){if(J(s))return s;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(s==null){if(!e){let t=Y();return{getTime:()=>t,toLocaleString:()=>b(t),toString:()=>b(t)}}return new Date}if(typeof s=="number")return e?new Date(s):{getTime:()=>s,toLocaleString:()=>b(s),toString:()=>b(s)};if(typeof s=="string"){let t=0;if(e)t=Date.parse(s);else{let o=parseFloat(s);t=isNaN(o)?0:o}return e?new Date(s):{getTime:()=>t,toLocaleString:()=>b(t),toString:()=>b(t)}}return e?new Date(s):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}X.exports={ensureDate:Fe,isDateLike:J,getCurrentTimestamp:Y}});var ee=E((tt,Z)=>{var d=require("vscode"),{isWebEnvironment:Te}=K(),{normalizePath:_e}=F(),{ExtensionError:ke,ERROR_CODES:Ie,isPermissionError:Re}=H(),{ensureDate:P}=v(),Q=process.env.VSCODE_WEB==="true",xe=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",h=null;if(!Q&&!xe)try{h=require("fs").promises}catch{h=null}var _=class{constructor(){this.isWeb=Q||Te()}s(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}o(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return d.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.o(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return d.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return d.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return d.Uri.parse(e.href);if(typeof e.scheme=="string")return d.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return d.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return d.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&h)return h.stat(this.s(e));let t=this.o(e),o=await d.workspace.fs.stat(t);return{...o,mtime:P(o.mtime),ctime:P(o.ctime),birthtime:P(o.ctime),isFile:()=>o.type===d.FileType.File,isDirectory:()=>o.type===d.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&h)return h.readFile(this.s(e),t);let o=this.o(e),n=await d.workspace.fs.readFile(o);return t===null||t==="binary"?n:new TextDecoder(t).decode(n)}async writeFile(e,t,o="utf8"){let n=this.s(e);try{if(!this.isWeb&&h)return h.writeFile(n,t,o);let i=this.o(e),r=typeof t=="string"?new TextEncoder().encode(t):t;await d.workspace.fs.writeFile(i,r)}catch(i){this.p("write file",n,i)}}async mkdir(e,t={recursive:!0}){let o=this.s(e);try{if(!this.isWeb&&h)return h.mkdir(o,t);let n=this.o(e);await d.workspace.fs.createDirectory(n)}catch(n){this.p("create directory",o,n)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&h)return h.readdir(this.s(e),t);let o=this.o(e),n=await d.workspace.fs.readDirectory(o);return t.withFileTypes?n.map(([i,r])=>({name:i,isDirectory:()=>r===d.FileType.Directory,isFile:()=>r===d.FileType.File})):n.map(([i])=>i)}async delete(e,t={recursive:!1}){if(!this.isWeb&&h){let n=this.s(e);return t.recursive?h.rm?h.rm(n,t):h.rmdir(n,t):h.unlink(n)}let o=this.o(e);await d.workspace.fs.delete(o,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=_e(this.s(e));await this.mkdir(t,{recursive:!0})}p(e,t,o){throw Re(o)?new ke(Ie.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:o.code}):o}},Ae=new _;Z.exports={FileSystemAdapter:_,fileSystem:Ae}});var ne=E((st,re)=>{var Ne="__explorerDatesVscode",L=null,k=null,I=!1;function ve(){try{return globalThis[Ne]}catch{return}}function oe(){if(k)return k;let s={get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})};return k={workspace:{workspaceFolders:[],getConfiguration:()=>s},ConfigurationTarget:{Global:1,Workspace:2,WorkspaceFolder:3}},k}var Pe=new Set(["MODULE_NOT_FOUND","ERR_MODULE_NOT_FOUND","WEB_NATIVE_MODULE"]);function Me(s){return!s||s.code&&Pe.has(s.code)?!0:(typeof s.message=="string"?s.message:"").includes("Cannot find module 'vscode'")}function O(){let s=ve();if(s)return L=M(s),I=!1,L;if(L&&!I)return L;try{L=M(require("vscode")),I=!1}catch(e){if(Me(e))L=M(oe()),I=!0;else throw e}return L}var g=new Proxy({},{get(s,e){return O()[e]},set(s,e,t){return O()[e]=t,!0},has(s,e){return e in O()},ownKeys(){return Reflect.ownKeys(O())},getOwnPropertyDescriptor(s,e){let t=Object.getOwnPropertyDescriptor(O(),e);return t&&(t.configurable=!0),t}}),Ge="explorerDates",te="__explorerDatesConfigWrapped";function se(s){return!s||typeof s!="object"?{get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})}:(typeof s.get!="function"&&(s.get=()=>{}),typeof s.update!="function"&&(s.update=async()=>{}),typeof s.inspect!="function"&&(s.inspect=()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})),s)}function M(s){if(!s)return oe();s.ConfigurationTarget||(s.ConfigurationTarget={Global:1,Workspace:2,WorkspaceFolder:3}),s.workspace||(s.workspace={});let e=s.workspace.getConfiguration;if(typeof e=="function"&&!e[te]){let t=function(...o){let n=e.apply(this,o);return se(n)};t[te]=!0,s.workspace.getConfiguration=t}else typeof e!="function"&&(s.workspace.getConfiguration=()=>se());return Array.isArray(s.workspace.workspaceFolders)||(s.workspace.workspaceFolders=[]),s}var R=class{constructor(e={}){this.D=e.defaultSection||Ge}getValue(e,t={}){let{section:o,resource:n}=t,i=this.u(e,o);return this.f(i.section,n).get(i.key)}inspect(e,t={}){let{section:o,resource:n}=t,i=this.u(e,o);return this.f(i.section,n).inspect(i.key)}async updateSetting(e,t,o={}){let{scope:n="auto",resource:i,section:r,force:a=!1}=o,l=this.u(e,r),f=this.f(l.section,i),w=this.C(n,i),u=f.get(l.key),D=f.inspect(l.key),y=this.L(D,w);return t!==void 0&&this.S(u,t)&&!a&&y!==void 0?{key:l.fullKey,updated:!1,reason:"unchanged"}:(await f.update(l.key,t,w),{key:l.fullKey,updated:!0})}async applySettings(e,t={}){let o=Array.isArray(e)?e:Object.entries(e).map(([i,r])=>({key:i,value:r})),n=[];for(let i of o){let r={...t,...i.options||{}};n.push(await this.updateSetting(i.key,i.value,r))}return n}async clearSetting(e,t={}){return this.updateSetting(e,void 0,t)}f(e,t){return g.workspace.getConfiguration(e||void 0,t)}u(e,t){let o=t||this.D;if(!o)return{section:void 0,key:e,fullKey:e};if(e.startsWith(`${o}.`)){let n=e.slice(o.length+1);return{section:o,key:n,fullKey:e}}return e.includes(".")?{section:void 0,key:e,fullKey:e}:{section:o,key:e,fullKey:`${o}.${e}`}}C(e,t){return e&&e!=="auto"?this.b(e)||g.ConfigurationTarget.Workspace:t?g.ConfigurationTarget.WorkspaceFolder:g.workspace.workspaceFolders&&g.workspace.workspaceFolders.length>0?g.ConfigurationTarget.Workspace:g.ConfigurationTarget.Global}b(e){switch(e){case"user":return g.ConfigurationTarget.Global;case"workspace":return g.ConfigurationTarget.Workspace;case"workspaceFolder":return g.ConfigurationTarget.WorkspaceFolder;default:return}}v(e){switch(e){case g.ConfigurationTarget.Global:return"user";case g.ConfigurationTarget.Workspace:return"workspace";case g.ConfigurationTarget.WorkspaceFolder:return"workspaceFolder";default:return"unknown"}}S(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}L(e,t){if(e)switch(t){case g.ConfigurationTarget.Global:return e.globalValue;case g.ConfigurationTarget.Workspace:return e.workspaceValue;case g.ConfigurationTarget.WorkspaceFolder:return e.workspaceFolderValue;default:return}}},G=null;function We(s){return(!G||s&&s.forceNew)&&(G=new R(s)),G}re.exports={SettingsCoordinator:R,getSettingsCoordinator:We}});var x=E((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?s=>{if(typeof s=="string")return s;try{return JSON.stringify(s,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",TEST_CONSOLE_LEVEL=process.env.EXPLORER_DATES_TEST_MODE==="1"?"warn":null,Logger=class{constructor(){this.t=vscode.window.createOutputChannel("Explorer Dates"),this.i=!1,this.a=null,this.c=process.env.EXPLORER_DATES_TEST_MODE==="1",this.r=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.r)||(this.r=DEFAULT_LOG_PROFILE),this.n=new Map,this.g=DEFAULT_CONSOLE_LEVEL,this.m(),this.a=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.m()})}m(){let e=vscode.workspace.getConfiguration("explorerDates");this.i=e.get("enableLogging",!1);let t=(process.env.EXPLORER_DATES_LOG_LEVEL||"").toLowerCase(),o=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase(),n=TEST_CONSOLE_LEVEL||t||o||DEFAULT_CONSOLE_LEVEL;this.g=LOG_LEVEL_ORDER.includes(n)?n:DEFAULT_CONSOLE_LEVEL,TEST_CONSOLE_LEVEL&&(this.i=!1)}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.r=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.n.delete(e);return}this.n.clear()}debug(e,...t){this.i&&this.l("debug",null,e,t)}info(e,...t){this.l("info",null,e,t)}infoWithOptions(e,t,...o){this.l("info",e||null,t,o)}warn(e,...t){this.l("warn",null,e,t)}error(e,t,...o){let i=`[${new Date().toISOString()}] [ERROR] ${e}`;this.c||(this.t.appendLine(i),t instanceof Error?(this.t.appendLine(`Error: ${t.message}`),t.stack&&this.t.appendLine(`Stack: ${t.stack}`)):t&&this.t.appendLine(this.d(t)));let r=this.w(o);r.length>0&&!this.c&&r.forEach(l=>this.t.appendLine(this.d(l)));let a=[];t!=null&&a.push(t),r.length>0&&a.push(...r),this.h("error",i,a)}show(){this.t.show()}clear(){this.t.clear()}dispose(){this.t.dispose(),this.a&&(this.a.dispose(),this.a=null);let e="__explorerDatesLogger";typeof global<"u"&&global[e]===this?global[e]=null:typeof globalThis<"u"&&globalThis[e]===this?globalThis[e]=null:typeof globalThis<"u"&&globalThis.window?.[e]===this&&(globalThis.window[e]=null),loggerInstance===this&&(loggerInstance=null)}l(e,t,o,n){if(e==="debug"&&!this.i||this.O(e,t))return;let r=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${o}`;this.c||this.t.appendLine(r);let a=this.w(n);a.length>0&&!this.c&&a.forEach(l=>this.t.appendLine(this.d(l))),this.h(e,r,a)}w(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(o){return`<<log arg threw: ${o.message}>>`}})}d(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}O(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let o=(t.profile||"stress").toLowerCase();if(!this.F(o))return!1;let n=Number(t.throttleLimit)||50,i=t.throttleKey,r=this.n.get(i)||{count:0,suppressed:0,noticeLogged:!1};if(r.count<n)return r.count+=1,this.n.set(i,r),!1;if(r.suppressed+=1,!r.noticeLogged){r.noticeLogged=!0;let a=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${i}" after ${n} entries (profile=${this.r})`;this.t.appendLine(a),this.h("info",a)}return this.n.set(i,r),!0}F(e){let t=this.r||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}T(e){let t=LOG_LEVEL_ORDER.indexOf(this.g),o=LOG_LEVEL_ORDER.indexOf(e);return t===-1||o===-1?!1:o>=t}h(e,t,o=[]){if(!this.T(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...o)}},GLOBAL_LOGGER_KEY="__explorerDatesLogger";function getLogger(){return typeof global<"u"?(global[GLOBAL_LOGGER_KEY]||(global[GLOBAL_LOGGER_KEY]=new Logger),global[GLOBAL_LOGGER_KEY]):typeof globalThis<"u"?(globalThis[GLOBAL_LOGGER_KEY]||(globalThis[GLOBAL_LOGGER_KEY]=new Logger),globalThis.window&&(globalThis.window[GLOBAL_LOGGER_KEY]=globalThis[GLOBAL_LOGGER_KEY]),globalThis[GLOBAL_LOGGER_KEY]):(loggerInstance||(loggerInstance=new Logger),loggerInstance)}var loggerInstance=null;module.exports={Logger,getLogger}});var ae=E((ot,ie)=>{var p=require("vscode"),{getLogger:Ve}=x(),W=class{constructor(e){this._logger=Ve(),this.e=e,this.P=[]}async runComprehensiveDiagnostics(){this._logger.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let e={timestamp:new Date().toISOString(),vscodeVersion:p.version,extensionVersion:p.extensions.getExtension("incredincomp.explorer-dates")?.packageJSON?.version,tests:{}};return e.tests.vscodeSettings=await this._(),e.tests.providerRegistration=await this.k(),e.tests.fileProcessing=await this.I(),e.tests.decorationCreation=await this.R(),e.tests.cacheAnalysis=await this.x(),e.tests.extensionConflicts=await this.A(),e.tests.uriPathIssues=await this.N(),this._logger.info("\u{1F50D} Comprehensive diagnostics completed",e),e}async _(){let e=p.workspace.getConfiguration("explorer"),t=p.workspace.getConfiguration("workbench"),o=p.workspace.getConfiguration("explorerDates"),n={"explorer.decorations.badges":e.get("decorations.badges"),"explorer.decorations.colors":e.get("decorations.colors"),"workbench.colorTheme":t.get("colorTheme"),"explorerDates.showDateDecorations":o.get("showDateDecorations"),"explorerDates.colorScheme":o.get("colorScheme"),"explorerDates.showGitInfo":o.get("showGitInfo")},i=[];return n["explorer.decorations.badges"]===!1&&i.push("CRITICAL: explorer.decorations.badges is disabled"),n["explorer.decorations.colors"]===!1&&i.push("WARNING: explorer.decorations.colors is disabled"),n["explorerDates.showDateDecorations"]===!1&&i.push("CRITICAL: explorerDates.showDateDecorations is disabled"),{status:i.length>0?"ISSUES_FOUND":"OK",settings:n,issues:i}}async k(){let e=[];if(!this.e)return e.push("CRITICAL: Decoration provider is null/undefined"),{status:"FAILED",issues:e};typeof this.e.provideFileDecoration!="function"&&e.push("CRITICAL: provideFileDecoration method missing"),this.e.onDidChangeFileDecorations||e.push("WARNING: onDidChangeFileDecorations event emitter missing");let t=p.Uri.file("/test/path");try{let o=await this.e.provideFileDecoration(t);this._logger.debug("Provider test call completed",{result:!!o})}catch(o){e.push(`ERROR: Provider test call failed: ${o.message}`)}return{status:e.length>0?"ISSUES_FOUND":"OK",providerActive:!!this.e,issues:e}}async I(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace folders available"]};let t=[],o=[];try{let n=["package.json","README.md","extension.js","src/logger.js"];for(let i of n){let r=p.Uri.joinPath(e[0].uri,i);try{await p.workspace.fs.stat(r);let a=this.e.y?await this.e.y(r):!1,l=await this.e.provideFileDecoration(r);t.push({file:i,exists:!0,excluded:a,hasDecoration:!!l,badge:l?.badge,uri:r.toString()})}catch(a){t.push({file:i,exists:!1,error:a.message})}}}catch(n){o.push(`File processing test failed: ${n.message}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",testFiles:t,issues:o}}async R(){let e=[],t=[];try{let n=new p.FileDecoration("test");e.push({name:"Simple decoration",success:!0,badge:n.badge})}catch(n){e.push({name:"Simple decoration",success:!1,error:n.message}),t.push("CRITICAL: Cannot create simple FileDecoration")}try{let n=new p.FileDecoration("test","Test tooltip");e.push({name:"Decoration with tooltip",success:!0,hasTooltip:!!(n&&n.tooltip)})}catch(n){e.push({name:"Decoration with tooltip",success:!1,error:n.message}),t.push("WARNING: Cannot create FileDecoration with tooltip")}try{let n=new p.FileDecoration("test","Test tooltip",new p.ThemeColor("charts.red"));e.push({name:"Decoration with color",success:!0,hasColor:!!n.color})}catch(n){e.push({name:"Decoration with color",success:!1,error:n.message}),t.push("WARNING: Cannot create FileDecoration with color")}let o=["1d","10m","2h","!!","\u25CF\u25CF","JA12","123456789"];for(let n of o)try{let i=new p.FileDecoration(n);e.push({name:`Badge format: ${n}`,success:!0,badge:i.badge,length:n.length})}catch(i){e.push({name:`Badge format: ${n}`,success:!1,error:i.message}),n.length<=8&&t.push(`WARNING: Valid badge format '${n}' failed`)}return{status:t.length>0?"ISSUES_FOUND":"OK",tests:e,issues:t}}async x(){let e={memoryCache:{size:this.e.M?.size||0,maxSize:this.e.G||0},advancedCache:{available:!!this.e._advancedCache,initialized:!1},metrics:this.e.getMetrics?this.e.getMetrics():null},t=[];return e.memoryCache.size>e.memoryCache.maxSize*.9&&t.push("WARNING: Memory cache is nearly full"),e.metrics&&e.metrics.cacheHits===0&&e.metrics.cacheMisses>10&&t.push("WARNING: Cache hit rate is 0% - potential cache key issues"),{status:t.length>0?"ISSUES_FOUND":"OK",cacheInfo:e,issues:t}}async A(){let e=p.extensions.all,t=[],o=[];for(let i of e){if(!i.isActive)continue;let r=i.packageJSON;r.contributes?.commands?.some(l=>l.command?.includes("decoration")||l.title?.includes("decoration")||l.title?.includes("badge")||l.title?.includes("explorer"))&&o.push({id:i.id,name:r.displayName||r.name,version:r.version}),["file-icons","vscode-icons","material-icon-theme","explorer-exclude","hide-files","file-watcher"].some(l=>i.id.includes(l))&&t.push({id:i.id,name:r.displayName||r.name,reason:"Known to potentially interfere with file decorations"})}let n=[];return o.length>1&&n.push(`WARNING: ${o.length} extensions might provide file decorations`),t.length>0&&n.push(`WARNING: ${t.length} potentially conflicting extensions detected`),{status:n.length>0?"ISSUES_FOUND":"OK",decorationExtensions:o,potentialConflicts:t,issues:n}}async N(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace available for URI testing"]};let t=[],o=[],n=["package.json","src/logger.js","README.md",".gitignore"];for(let i of n){let r=p.Uri.joinPath(e[0].uri,i);t.push({path:i,scheme:r.scheme,fsPath:r.fsPath,authority:r.authority,valid:r.scheme==="file"&&r.fsPath.length>0}),r.scheme!=="file"&&o.push(`WARNING: Non-file URI scheme for ${i}: ${r.scheme}`),(r.fsPath.includes("\\\\")||r.fsPath.includes("//"))&&o.push(`WARNING: Potential path separator issues in ${i}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",tests:t,issues:o}}};ie.exports={DecorationDiagnostics:W}});var le=E((rt,ce)=>{var S=require("vscode"),{getFileName:Ue}=F();async function $e(){let s=x().getLogger();s.info("\u{1F3A8} Testing VS Code decoration rendering...");class e{constructor(){this.E=new S.EventEmitter,this.onDidChangeFileDecorations=this.E.event}provideFileDecoration(i){let r=Ue(i.fsPath||i.path),a=new S.FileDecoration("TEST");return a.tooltip=`Test decoration for ${r}`,a.color=new S.ThemeColor("charts.red"),s.info(`\u{1F9EA} Test provider returning decoration for: ${r}`),a}}let t=new e,o=S.window.registerFileDecorationProvider(t);return s.info("\u{1F9EA} Test decoration provider registered"),setTimeout(()=>{t.E.fire(void 0),s.info("\u{1F504} Test decoration refresh triggered"),setTimeout(()=>{o.dispose(),s.info("\u{1F9EA} Test decoration provider disposed")},1e4)},1e3),"Test decoration provider registered for 10 seconds"}async function Ke(){let s=x().getLogger();s.info("\u{1F527} Testing FileDecoration API...");let e=[];try{let o=new S.FileDecoration("MIN");e.push({name:"Minimal decoration",success:!0,badge:o.badge}),s.info("\u2705 Minimal decoration created successfully")}catch(o){e.push({name:"Minimal decoration",success:!1,error:o.message}),s.error("\u274C Minimal decoration failed:",o)}try{let o=new S.FileDecoration("FULL","Full decoration tooltip",new S.ThemeColor("charts.blue"));o.propagate=!1,e.push({name:"Full decoration",success:!0,badge:o.badge,hasTooltip:!!o.tooltip,hasColor:!!o.color,propagate:o.propagate}),s.info("\u2705 Full decoration created successfully")}catch(o){e.push({name:"Full decoration",success:!1,error:o.message}),s.error("\u274C Full decoration failed:",o)}let t=["charts.red","charts.blue","charts.green","charts.yellow","terminal.ansiRed","terminal.ansiGreen","terminal.ansiBlue","editorError.foreground","editorWarning.foreground","editorInfo.foreground"];for(let o of t)try{e.push({name:`ThemeColor: ${o}`,success:!0,colorId:o})}catch(n){e.push({name:`ThemeColor: ${o}`,success:!1,error:n.message}),s.error(`\u274C ThemeColor ${o} failed:`,n)}return e}ce.exports={testVSCodeDecorationRendering:$e,testFileDecorationAPI:Ke}});var fe=E((nt,ue)=>{var c=require("vscode"),{fileSystem:qe}=ee(),{getFileName:Be,getRelativePath:je}=F(),{ensureDate:ze}=v(),{getSettingsCoordinator:He}=ne(),A=He();function Ye({context:s,fileDateProvider:e,logger:t,chunkLoader:o}){let n=[];async function i(){try{let r=await o.loadChunk("diagnostics");if(!r)throw new Error("Diagnostics chunk not available");return s&&r.ensureInitialized(s),{generateWorkspaceActivityHTML:r.generateWorkspaceActivityHTML,generatePerformanceAnalyticsHTML:r.generatePerformanceAnalyticsHTML,generateDiagnosticsHTML:r.generateDiagnosticsHTML,generateDiagnosticsWebview:r.generateDiagnosticsWebview}}catch(r){throw new Error(`Failed to load diagnostics generators: ${r.message}`)}}n.push(c.commands.registerCommand("explorerDates.showWorkspaceActivity",async()=>{try{if(!c.workspace.getConfiguration("explorerDates").get("enableAnalysisCommands",!0)){c.window.showInformationMessage("Analysis commands are disabled. Enable explorerDates.enableAnalysisCommands to use this feature.");return}let{generateWorkspaceActivityHTML:l}=await i(),f=c.window.createWebviewPanel("workspaceActivity","Workspace File Activity",c.ViewColumn.One,{enableScripts:!0});if(!c.workspace.workspaceFolders){c.window.showWarningMessage("No workspace folder open");return}let w=c.workspace.workspaceFolders[0],u=[],D=await c.workspace.findFiles("**/*","**/node_modules/**",100);for(let y of D)try{let m=await qe.stat(y);(typeof m.isFile=="function"?m.isFile():!0)&&u.push({path:je(w.uri.fsPath||w.uri.path,y.fsPath||y.path),modified:ze(m.mtime),size:m.size})}catch{}u.sort((y,m)=>m.modified.getTime()-y.modified.getTime()),f.webview.html=await l(u.slice(0,50)),t.info("Workspace activity panel opened")}catch(r){t.error("Failed to show workspace activity",r),c.window.showErrorMessage(`Failed to show workspace activity: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.showPerformanceAnalytics",async()=>{try{let{generatePerformanceAnalyticsHTML:r}=await i(),a=c.window.createWebviewPanel("performanceAnalytics","Explorer Dates Performance Analytics",c.ViewColumn.One,{enableScripts:!0}),l=e?e.getMetrics():{};a.webview.html=await r(l),t.info("Performance analytics panel opened")}catch(r){t.error("Failed to show performance analytics",r),c.window.showErrorMessage(`Failed to show performance analytics: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.debugCache",async()=>{try{if(e){let r=e.getMetrics(),a={"Cache Summary":{"Memory Cache Size":r.cacheSize,"Cache Hit Rate":r.cacheHitRate,"Total Hits":r.cacheHits,"Total Misses":r.cacheMisses,"Cache Timeout":`${r.cacheDebugging.cacheTimeout}ms`},"Advanced Cache":r.advancedCache||"Not available","Cache Namespace":r.cacheDebugging.cacheNamespace||"default","Sample Cache Keys":r.cacheDebugging.memoryCacheKeys||[]};c.window.showInformationMessage(`Cache Debug Info:
${JSON.stringify(a,null,2)}`,{modal:!0}),t.info("Cache debug info displayed",a)}}catch(r){t.error("Failed to show cache debug info",r),c.window.showErrorMessage(`Failed to show cache debug info: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.runDiagnostics",async()=>{try{let{generateDiagnosticsHTML:r}=await i(),a=c.workspace.getConfiguration("explorerDates"),l=c.window.activeTextEditor,f={"Extension Status":{"Provider Active":e?"Yes":"No","Decorations Enabled":a.get("showDateDecorations",!0)?"Yes":"No","VS Code Version":c.version,"Extension Version":s.extension.packageJSON.version}};if(l){let{uri:u}=l.document;u.scheme==="file"&&(f["Current File"]={"File Path":u.fsPath,"File Extension":Be(u.fsPath||u.path).split(".").pop()||"No extension","Is Excluded":e?await e.y(u):"Unknown"})}if(f.Configuration={"Excluded Folders":a.get("excludedFolders",[]),"Excluded Patterns":a.get("excludedPatterns",[]),"Color Scheme":a.get("colorScheme","none"),"Cache Timeout":`${a.get("cacheTimeout",3e4)}ms`},e){let u=e.getMetrics();f.Performance={"Total Decorations":u.totalDecorations,"Cache Size":u.cacheSize,"Cache Hit Rate":u.cacheHitRate,Errors:u.errors},u.performanceTiming&&(f["Performance Timing"]={"Avg Git Blame (ms)":u.performanceTiming.avgGitBlameMs,"Avg File Stat (ms)":u.performanceTiming.avgFileStatMs,"Git Calls":u.performanceTiming.gitBlameCalls,"File Stat Calls":u.performanceTiming.fileStatCalls,"Total Git Time (ms)":u.performanceTiming.totalGitBlameTimeMs,"Total File Stat Time (ms)":u.performanceTiming.totalFileStatTimeMs})}let w=c.window.createWebviewPanel("explorerDatesDiagnostics","Explorer Dates Diagnostics",c.ViewColumn.One,{enableScripts:!0});w.webview.html=await r(f),t.info("Diagnostics panel opened",f)}catch(r){t.error("Failed to run diagnostics",r),c.window.showErrorMessage(`Failed to run diagnostics: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.testDecorations",async()=>{try{let{generateDiagnosticsWebview:r}=await i();t.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let{DecorationDiagnostics:a}=ae(),f=await new a(e).runComprehensiveDiagnostics(),w=c.window.createWebviewPanel("decorationDiagnostics","Decoration Diagnostics - Root Cause Analysis",c.ViewColumn.One,{enableScripts:!0});w.webview.html=await r(f);let u=[],D=[];Object.values(f.tests).forEach(y=>{y.issues&&y.issues.forEach(m=>{m.startsWith("CRITICAL:")?u.push(m):m.startsWith("WARNING:")&&D.push(m)})}),u.length>0?c.window.showErrorMessage(`CRITICAL ISSUES FOUND: ${u.join(", ")}`):D.length>0?c.window.showWarningMessage(`Warnings found: ${D.length} potential issues detected. Check diagnostics panel.`):c.window.showInformationMessage("No critical issues found. Decorations should be working properly."),t.info("\u{1F50D} Comprehensive diagnostics completed",f)}catch(r){t.error("Failed to run comprehensive diagnostics",r),c.window.showErrorMessage(`Diagnostics failed: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.monitorDecorations",async()=>{if(!e){c.window.showErrorMessage("Decoration provider not available");return}e.startProviderCallMonitoring(),e.forceRefreshAllDecorations(),setTimeout(()=>{let r=e.getProviderCallStats(),a=`VS Code Decoration Requests: ${r.totalCalls} calls for ${r.uniqueFiles} files`;c.window.showInformationMessage(a),t.info("\u{1F50D} Decoration monitoring results:",r)},5e3),c.window.showInformationMessage("Started monitoring VS Code decoration requests. Results in 5 seconds...")})),n.push(c.commands.registerCommand("explorerDates.testVSCodeRendering",async()=>{try{let{testVSCodeDecorationRendering:r,testFileDecorationAPI:a}=le();t.info("\u{1F3A8} Testing VS Code decoration rendering system...");let l=await a();t.info("\u{1F527} FileDecoration API tests:",l);let f=await r();t.info("\u{1F3A8} Decoration rendering test:",f),c.window.showInformationMessage('VS Code decoration rendering test started. Check Output panel and Explorer for "TEST" badges on files.')}catch(r){t.error("Failed to test VS Code rendering:",r),c.window.showErrorMessage(`VS Code rendering test failed: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.quickFix",async()=>{try{let r=[];A.getValue("showDateDecorations")||r.push({issue:"Date decorations are disabled",description:"Enable date decorations",fix:async()=>A.updateSetting("showDateDecorations",!0,{scope:"user",reason:"quick-fix"})});let a=A.getValue("excludedPatterns")||[];if(a.includes("**/*")&&r.push({issue:"All files are excluded by pattern",description:"Remove overly broad exclusion pattern",fix:async()=>{let f=a.filter(w=>w!=="**/*");await A.updateSetting("excludedPatterns",f,{scope:"user",reason:"quick-fix"})}}),r.length===0){c.window.showInformationMessage("No common issues detected. Decorations should be working.");return}let l=await c.window.showQuickPick(r.map(f=>({label:f.description,description:f.issue,fix:f.fix})),{placeHolder:"Select an issue to fix automatically"});l&&(await l.fix(),c.window.showInformationMessage("Fixed! Try refreshing decorations now."),e&&(e.clearAllCaches(),e.refreshAll()))}catch(r){t.error("Failed to run quick fix",r),c.window.showErrorMessage(`Failed to run quick fix: ${r.message}`)}})),n.push(c.commands.registerCommand("explorerDates.showKeyboardShortcuts",async()=>{try{e?._accessibility?await e._accessibility.showKeyboardShortcutsHelp():c.window.showInformationMessage("Keyboard shortcuts: Ctrl+Shift+D (toggle), Ctrl+Shift+C (copy date), Ctrl+Shift+I (file details), Ctrl+Shift+R (refresh), Ctrl+Shift+A (workspace activity)"),t.info("Keyboard shortcuts help shown")}catch(r){t.error("Failed to show keyboard shortcuts help",r),c.window.showErrorMessage(`Failed to show keyboard shortcuts help: ${r.message}`)}})),n.forEach(r=>s.subscriptions.push(r))}ue.exports={registerAnalysisCommands:Ye}});var de=fe();module.exports={...de,registerAnalysisCommands:de.registerAnalysisCommands};
