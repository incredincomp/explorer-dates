var y=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var P=y((Re,A)=>{var _=require("vscode");function te(){try{return _?.env?.uiKind===_?.UIKind?.Web}catch{return!1}}A.exports={isWebEnvironment:te}});var C=y((xe,k)=>{function D(i=""){return i?i.replace(/\\/g,"/"):""}function se(i=""){let e=D(i);return e?e.split("/").filter(Boolean):[]}function N(i=""){let e=se(i);return e.length?e[e.length-1]:""}function oe(i=""){let e=N(i),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function ie(i=""){let e=D(i),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function re(...i){return D(i.filter(Boolean).join("/")).replace(/\/+/g,"/")}function ne(i=""){return D(i).toLowerCase()}function ae(i=""){if(!i)return"";if(typeof i=="string")return i;if(typeof i.fsPath=="string"&&i.fsPath.length>0)return i.fsPath;if(typeof i.path=="string"&&i.path.length>0)return i.path;if(typeof i.toString=="function")try{return i.toString(!0)}catch{return i.toString()}return String(i)}function ce(i="",e=""){let t=D(i),o=D(e);return t&&o.startsWith(t)?o.substring(t.length).replace(/^\/+/,""):o}k.exports={normalizePath:D,getFileName:N,getExtension:oe,getDirectory:ie,joinPath:re,getCacheKey:ne,getUriPath:ae,getRelativePath:ce}});var M=y((_e,v)=>{var O=class extends Error{constructor(e,t,o={}){super(t),this.code=e,this.context=o,this.name="ExtensionError"}},le={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function he(i){if(!i)return!1;let e=i.code||i?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}v.exports={ExtensionError:O,ERROR_CODES:le,isPermissionError:he}});var I=y((Ae,W)=>{function G(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function U(i){return!!(i&&typeof i=="object"&&typeof i.getTime=="function")}function S(i){if(!i||isNaN(i))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(i)}catch{}let e=864e5,t=36e5,o=6e4,r=1e3,n=1970,s=4,c=Math.floor(i/e),h=i%e,u=Math.floor(h/t),g=Math.floor(h%t/o),l=Math.floor(h%o/r),E=n+Math.floor(c/365.25),w=Math.floor(c%365.25/30.44)+1,m=Math.floor(c%30.44)+1,x=String(Math.min(w,12)).padStart(2,"0"),X=String(Math.min(m,31)).padStart(2,"0"),Q=String(u).padStart(2,"0"),Z=String(g).padStart(2,"0"),ee=String(l).padStart(2,"0");return`${x}/${X}/${E}, ${Q}:${Z}:${ee}`}function ue(i){if(U(i))return i;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(i==null){if(!e){let t=G();return{getTime:()=>t,toLocaleString:()=>S(t),toString:()=>S(t)}}return new Date}if(typeof i=="number")return e?new Date(i):{getTime:()=>i,toLocaleString:()=>S(i),toString:()=>S(i)};if(typeof i=="string"){let t=0;if(e)t=Date.parse(i);else{let o=parseFloat(i);t=isNaN(o)?0:o}return e?new Date(i):{getTime:()=>t,toLocaleString:()=>S(t),toString:()=>S(t)}}return e?new Date(i):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}W.exports={ensureDate:ue,isDateLike:U,getCurrentTimestamp:G}});var V=y((Pe,K)=>{var f=require("vscode"),{isWebEnvironment:fe}=P(),{normalizePath:de}=C(),{ExtensionError:pe,ERROR_CODES:ge,isPermissionError:me}=M(),{ensureDate:T}=I(),$=process.env.VSCODE_WEB==="true",we=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",d=null;if(!$&&!we)try{d=require("fs").promises}catch{d=null}var b=class{constructor(){this.isWeb=$||fe()}s(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}o(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return f.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.o(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return f.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return f.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return f.Uri.parse(e.href);if(typeof e.scheme=="string")return f.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return f.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return f.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&d)return d.stat(this.s(e));let t=this.o(e),o=await f.workspace.fs.stat(t);return{...o,mtime:T(o.mtime),ctime:T(o.ctime),birthtime:T(o.ctime),isFile:()=>o.type===f.FileType.File,isDirectory:()=>o.type===f.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&d)return d.readFile(this.s(e),t);let o=this.o(e),r=await f.workspace.fs.readFile(o);return t===null||t==="binary"?r:new TextDecoder(t).decode(r)}async writeFile(e,t,o="utf8"){let r=this.s(e);try{if(!this.isWeb&&d)return d.writeFile(r,t,o);let n=this.o(e),s=typeof t=="string"?new TextEncoder().encode(t):t;await f.workspace.fs.writeFile(n,s)}catch(n){this.f("write file",r,n)}}async mkdir(e,t={recursive:!0}){let o=this.s(e);try{if(!this.isWeb&&d)return d.mkdir(o,t);let r=this.o(e);await f.workspace.fs.createDirectory(r)}catch(r){this.f("create directory",o,r)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&d)return d.readdir(this.s(e),t);let o=this.o(e),r=await f.workspace.fs.readDirectory(o);return t.withFileTypes?r.map(([n,s])=>({name:n,isDirectory:()=>s===f.FileType.Directory,isFile:()=>s===f.FileType.File})):r.map(([n])=>n)}async delete(e,t={recursive:!1}){if(!this.isWeb&&d){let r=this.s(e);return t.recursive?d.rm?d.rm(r,t):d.rmdir(r,t):d.unlink(r)}let o=this.o(e);await f.workspace.fs.delete(o,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=de(this.s(e));await this.mkdir(t,{recursive:!0})}f(e,t,o){throw me(o)?new pe(ge.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:o.code}):o}},ye=new b;K.exports={FileSystemAdapter:b,fileSystem:ye}});var F=y((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?i=>{if(typeof i=="string")return i;try{return JSON.stringify(i,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",Logger=class{constructor(){this.t=vscode.window.createOutputChannel("Explorer Dates"),this.c=!1,this.n=null,this.i=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.i)||(this.i=DEFAULT_LOG_PROFILE),this.r=new Map,this.d=DEFAULT_CONSOLE_LEVEL,this.p(),this.n=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.p()})}p(){let e=vscode.workspace.getConfiguration("explorerDates");this.c=e.get("enableLogging",!1);let t=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase();this.d=LOG_LEVEL_ORDER.includes(t)?t:DEFAULT_CONSOLE_LEVEL}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.i=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.r.delete(e);return}this.r.clear()}debug(e,...t){this.c&&this.a("debug",null,e,t)}info(e,...t){this.a("info",null,e,t)}infoWithOptions(e,t,...o){this.a("info",e||null,t,o)}warn(e,...t){this.a("warn",null,e,t)}error(e,t,...o){let n=`[${new Date().toISOString()}] [ERROR] ${e}`;this.t.appendLine(n),t instanceof Error?(this.t.appendLine(`Error: ${t.message}`),t.stack&&this.t.appendLine(`Stack: ${t.stack}`)):t&&this.t.appendLine(this.l(t));let s=this.g(o);s.length>0&&s.forEach(c=>this.t.appendLine(this.l(c))),this.h("error",n,[t,...s])}show(){this.t.show()}clear(){this.t.clear()}dispose(){this.t.dispose(),this.n&&(this.n.dispose(),this.n=null);let e="__explorerDatesLogger";typeof global<"u"&&global[e]===this?global[e]=null:typeof globalThis<"u"&&globalThis[e]===this?globalThis[e]=null:typeof window<"u"&&window[e]===this&&(window[e]=null),loggerInstance===this&&(loggerInstance=null)}a(e,t,o,r){if(e==="debug"&&!this.c||this.y(e,t))return;let s=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${o}`;this.t.appendLine(s);let c=this.g(r);c.length>0&&c.forEach(h=>this.t.appendLine(this.l(h))),this.h(e,s,c)}g(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(o){return`<<log arg threw: ${o.message}>>`}})}l(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}y(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let o=(t.profile||"stress").toLowerCase();if(!this.E(o))return!1;let r=Number(t.throttleLimit)||50,n=t.throttleKey,s=this.r.get(n)||{count:0,suppressed:0,noticeLogged:!1};if(s.count<r)return s.count+=1,this.r.set(n,s),!1;if(s.suppressed+=1,!s.noticeLogged){s.noticeLogged=!0;let c=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${n}" after ${r} entries (profile=${this.i})`;this.t.appendLine(c),this.h("info",c)}return this.r.set(n,s),!0}E(e){let t=this.i||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}D(e){let t=LOG_LEVEL_ORDER.indexOf(this.d),o=LOG_LEVEL_ORDER.indexOf(e);return t===-1||o===-1?!1:o>=t}h(e,t,o=[]){if(!this.D(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...o)}},GLOBAL_LOGGER_KEY="__explorerDatesLogger";function getLogger(){return typeof global<"u"?(global[GLOBAL_LOGGER_KEY]||(global[GLOBAL_LOGGER_KEY]=new Logger),global[GLOBAL_LOGGER_KEY]):typeof globalThis<"u"?(globalThis[GLOBAL_LOGGER_KEY]||(globalThis[GLOBAL_LOGGER_KEY]=new Logger),globalThis[GLOBAL_LOGGER_KEY]):typeof window<"u"?(window[GLOBAL_LOGGER_KEY]||(window[GLOBAL_LOGGER_KEY]=new Logger),window[GLOBAL_LOGGER_KEY]):(loggerInstance||(loggerInstance=new Logger),loggerInstance)}var loggerInstance=null;module.exports={Logger,getLogger}});var B=y((Ne,q)=>{var p=require("vscode"),{getLogger:Ee}=F(),R=class{constructor(e){this.u=Ee(),this.e=e,this.R=[]}async runComprehensiveDiagnostics(){this.u.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let e={timestamp:new Date().toISOString(),vscodeVersion:p.version,extensionVersion:p.extensions.getExtension("incredincomp.explorer-dates")?.packageJSON?.version,tests:{}};return e.tests.vscodeSettings=await this.L(),e.tests.providerRegistration=await this.S(),e.tests.fileProcessing=await this.C(),e.tests.decorationCreation=await this.b(),e.tests.cacheAnalysis=await this.F(),e.tests.extensionConflicts=await this.O(),e.tests.uriPathIssues=await this.I(),this.u.info("\u{1F50D} Comprehensive diagnostics completed",e),e}async L(){let e=p.workspace.getConfiguration("explorer"),t=p.workspace.getConfiguration("workbench"),o=p.workspace.getConfiguration("explorerDates"),r={"explorer.decorations.badges":e.get("decorations.badges"),"explorer.decorations.colors":e.get("decorations.colors"),"workbench.colorTheme":t.get("colorTheme"),"explorerDates.showDateDecorations":o.get("showDateDecorations"),"explorerDates.colorScheme":o.get("colorScheme"),"explorerDates.showGitInfo":o.get("showGitInfo")},n=[];return r["explorer.decorations.badges"]===!1&&n.push("CRITICAL: explorer.decorations.badges is disabled"),r["explorer.decorations.colors"]===!1&&n.push("WARNING: explorer.decorations.colors is disabled"),r["explorerDates.showDateDecorations"]===!1&&n.push("CRITICAL: explorerDates.showDateDecorations is disabled"),{status:n.length>0?"ISSUES_FOUND":"OK",settings:r,issues:n}}async S(){let e=[];if(!this.e)return e.push("CRITICAL: Decoration provider is null/undefined"),{status:"FAILED",issues:e};typeof this.e.provideFileDecoration!="function"&&e.push("CRITICAL: provideFileDecoration method missing"),this.e.onDidChangeFileDecorations||e.push("WARNING: onDidChangeFileDecorations event emitter missing");let t=p.Uri.file("/test/path");try{let o=await this.e.provideFileDecoration(t);this.u.debug("Provider test call completed",{result:!!o})}catch(o){e.push(`ERROR: Provider test call failed: ${o.message}`)}return{status:e.length>0?"ISSUES_FOUND":"OK",providerActive:!!this.e,issues:e}}async C(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace folders available"]};let t=[],o=[];try{let r=["package.json","README.md","extension.js","src/logger.js"];for(let n of r){let s=p.Uri.joinPath(e[0].uri,n);try{await p.workspace.fs.stat(s);let c=this.e.m?await this.e.m(s):!1,h=await this.e.provideFileDecoration(s);t.push({file:n,exists:!0,excluded:c,hasDecoration:!!h,badge:h?.badge,uri:s.toString()})}catch(c){t.push({file:n,exists:!1,error:c.message})}}}catch(r){o.push(`File processing test failed: ${r.message}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",testFiles:t,issues:o}}async b(){let e=[],t=[];try{let r=new p.FileDecoration("test");e.push({name:"Simple decoration",success:!0,badge:r.badge})}catch(r){e.push({name:"Simple decoration",success:!1,error:r.message}),t.push("CRITICAL: Cannot create simple FileDecoration")}try{let r=new p.FileDecoration("test","Test tooltip");e.push({name:"Decoration with tooltip",success:!0,hasTooltip:!!(r&&r.tooltip)})}catch(r){e.push({name:"Decoration with tooltip",success:!1,error:r.message}),t.push("WARNING: Cannot create FileDecoration with tooltip")}try{let r=new p.FileDecoration("test","Test tooltip",new p.ThemeColor("charts.red"));e.push({name:"Decoration with color",success:!0,hasColor:!!r.color})}catch(r){e.push({name:"Decoration with color",success:!1,error:r.message}),t.push("WARNING: Cannot create FileDecoration with color")}let o=["1d","10m","2h","!!","\u25CF\u25CF","JA12","123456789"];for(let r of o)try{let n=new p.FileDecoration(r);e.push({name:`Badge format: ${r}`,success:!0,badge:n.badge,length:r.length})}catch(n){e.push({name:`Badge format: ${r}`,success:!1,error:n.message}),r.length<=8&&t.push(`WARNING: Valid badge format '${r}' failed`)}return{status:t.length>0?"ISSUES_FOUND":"OK",tests:e,issues:t}}async F(){let e={memoryCache:{size:this.e.x?.size||0,maxSize:this.e._||0},advancedCache:{available:!!this.e.A,initialized:!1},metrics:this.e.getMetrics?this.e.getMetrics():null},t=[];return e.memoryCache.size>e.memoryCache.maxSize*.9&&t.push("WARNING: Memory cache is nearly full"),e.metrics&&e.metrics.cacheHits===0&&e.metrics.cacheMisses>10&&t.push("WARNING: Cache hit rate is 0% - potential cache key issues"),{status:t.length>0?"ISSUES_FOUND":"OK",cacheInfo:e,issues:t}}async O(){let e=p.extensions.all,t=[],o=[];for(let n of e){if(!n.isActive)continue;let s=n.packageJSON;s.contributes?.commands?.some(h=>h.command?.includes("decoration")||h.title?.includes("decoration")||h.title?.includes("badge")||h.title?.includes("explorer"))&&o.push({id:n.id,name:s.displayName||s.name,version:s.version}),["file-icons","vscode-icons","material-icon-theme","explorer-exclude","hide-files","file-watcher"].some(h=>n.id.includes(h))&&t.push({id:n.id,name:s.displayName||s.name,reason:"Known to potentially interfere with file decorations"})}let r=[];return o.length>1&&r.push(`WARNING: ${o.length} extensions might provide file decorations`),t.length>0&&r.push(`WARNING: ${t.length} potentially conflicting extensions detected`),{status:r.length>0?"ISSUES_FOUND":"OK",decorationExtensions:o,potentialConflicts:t,issues:r}}async I(){let e=p.workspace.workspaceFolders;if(!e||e.length===0)return{status:"NO_WORKSPACE",issues:["No workspace available for URI testing"]};let t=[],o=[],r=["package.json","src/logger.js","README.md",".gitignore"];for(let n of r){let s=p.Uri.joinPath(e[0].uri,n);t.push({path:n,scheme:s.scheme,fsPath:s.fsPath,authority:s.authority,valid:s.scheme==="file"&&s.fsPath.length>0}),s.scheme!=="file"&&o.push(`WARNING: Non-file URI scheme for ${n}: ${s.scheme}`),(s.fsPath.includes("\\\\")||s.fsPath.includes("//"))&&o.push(`WARNING: Potential path separator issues in ${n}`)}return{status:o.length>0?"ISSUES_FOUND":"OK",tests:t,issues:o}}};q.exports={DecorationDiagnostics:R}});var j=y((ke,z)=>{var L=require("vscode"),{getFileName:De}=C();async function Le(){let i=F().getLogger();i.info("\u{1F3A8} Testing VS Code decoration rendering...");class e{constructor(){this.w=new L.EventEmitter,this.onDidChangeFileDecorations=this.w.event}provideFileDecoration(n){let s=De(n.fsPath||n.path),c=new L.FileDecoration("TEST");return c.tooltip=`Test decoration for ${s}`,c.color=new L.ThemeColor("charts.red"),i.info(`\u{1F9EA} Test provider returning decoration for: ${s}`),c}}let t=new e,o=L.window.registerFileDecorationProvider(t);return i.info("\u{1F9EA} Test decoration provider registered"),setTimeout(()=>{t.w.fire(void 0),i.info("\u{1F504} Test decoration refresh triggered"),setTimeout(()=>{o.dispose(),i.info("\u{1F9EA} Test decoration provider disposed")},1e4)},1e3),"Test decoration provider registered for 10 seconds"}async function Se(){let i=F().getLogger();i.info("\u{1F527} Testing FileDecoration API...");let e=[];try{let o=new L.FileDecoration("MIN");e.push({name:"Minimal decoration",success:!0,badge:o.badge}),i.info("\u2705 Minimal decoration created successfully")}catch(o){e.push({name:"Minimal decoration",success:!1,error:o.message}),i.error("\u274C Minimal decoration failed:",o)}try{let o=new L.FileDecoration("FULL","Full decoration tooltip",new L.ThemeColor("charts.blue"));o.propagate=!1,e.push({name:"Full decoration",success:!0,badge:o.badge,hasTooltip:!!o.tooltip,hasColor:!!o.color,propagate:o.propagate}),i.info("\u2705 Full decoration created successfully")}catch(o){e.push({name:"Full decoration",success:!1,error:o.message}),i.error("\u274C Full decoration failed:",o)}let t=["charts.red","charts.blue","charts.green","charts.yellow","terminal.ansiRed","terminal.ansiGreen","terminal.ansiBlue","editorError.foreground","editorWarning.foreground","editorInfo.foreground"];for(let o of t)try{e.push({name:`ThemeColor: ${o}`,success:!0,colorId:o})}catch(r){e.push({name:`ThemeColor: ${o}`,success:!1,error:r.message}),i.error(`\u274C ThemeColor ${o} failed:`,r)}return e}z.exports={testVSCodeDecorationRendering:Le,testFileDecorationAPI:Se}});var Y=y((ve,H)=>{var a=require("vscode"),{fileSystem:Ce}=V(),{getFileName:be,getRelativePath:Fe}=C(),{ensureDate:Oe}=I();function Ie({context:i,fileDateProvider:e,logger:t,chunkLoader:o}){let r=[];async function n(){try{let s=await o.loadChunk("diagnostics");if(!s)throw new Error("Diagnostics chunk not available");return i&&s.ensureInitialized(i),{generateWorkspaceActivityHTML:s.generateWorkspaceActivityHTML,generatePerformanceAnalyticsHTML:s.generatePerformanceAnalyticsHTML,generateDiagnosticsHTML:s.generateDiagnosticsHTML,generateDiagnosticsWebview:s.generateDiagnosticsWebview}}catch(s){throw new Error(`Failed to load diagnostics generators: ${s.message}`)}}r.push(a.commands.registerCommand("explorerDates.showWorkspaceActivity",async()=>{try{if(!a.workspace.getConfiguration("explorerDates").get("enableAnalysisCommands",!0)){a.window.showInformationMessage("Analysis commands are disabled. Enable explorerDates.enableAnalysisCommands to use this feature.");return}let{generateWorkspaceActivityHTML:h}=await n(),u=a.window.createWebviewPanel("workspaceActivity","Workspace File Activity",a.ViewColumn.One,{enableScripts:!0});if(!a.workspace.workspaceFolders){a.window.showWarningMessage("No workspace folder open");return}let g=a.workspace.workspaceFolders[0],l=[],E=await a.workspace.findFiles("**/*","**/node_modules/**",100);for(let w of E)try{let m=await Ce.stat(w);(typeof m.isFile=="function"?m.isFile():!0)&&l.push({path:Fe(g.uri.fsPath||g.uri.path,w.fsPath||w.path),modified:Oe(m.mtime),size:m.size})}catch{}l.sort((w,m)=>m.modified.getTime()-w.modified.getTime()),u.webview.html=await h(l.slice(0,50)),t.info("Workspace activity panel opened")}catch(s){t.error("Failed to show workspace activity",s),a.window.showErrorMessage(`Failed to show workspace activity: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.showPerformanceAnalytics",async()=>{try{let{generatePerformanceAnalyticsHTML:s}=await n(),c=a.window.createWebviewPanel("performanceAnalytics","Explorer Dates Performance Analytics",a.ViewColumn.One,{enableScripts:!0}),h=e?e.getMetrics():{};c.webview.html=await s(h),t.info("Performance analytics panel opened")}catch(s){t.error("Failed to show performance analytics",s),a.window.showErrorMessage(`Failed to show performance analytics: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.debugCache",async()=>{try{if(e){let s=e.getMetrics(),c={"Cache Summary":{"Memory Cache Size":s.cacheSize,"Cache Hit Rate":s.cacheHitRate,"Total Hits":s.cacheHits,"Total Misses":s.cacheMisses,"Cache Timeout":`${s.cacheDebugging.cacheTimeout}ms`},"Advanced Cache":s.advancedCache||"Not available","Cache Namespace":s.cacheDebugging.cacheNamespace||"default","Sample Cache Keys":s.cacheDebugging.memoryCacheKeys||[]};a.window.showInformationMessage(`Cache Debug Info:
${JSON.stringify(c,null,2)}`,{modal:!0}),t.info("Cache debug info displayed",c)}}catch(s){t.error("Failed to show cache debug info",s),a.window.showErrorMessage(`Failed to show cache debug info: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.runDiagnostics",async()=>{try{let{generateDiagnosticsHTML:s}=await n(),c=a.workspace.getConfiguration("explorerDates"),h=a.window.activeTextEditor,u={"Extension Status":{"Provider Active":e?"Yes":"No","Decorations Enabled":c.get("showDateDecorations",!0)?"Yes":"No","VS Code Version":a.version,"Extension Version":i.extension.packageJSON.version}};if(h){let{uri:l}=h.document;l.scheme==="file"&&(u["Current File"]={"File Path":l.fsPath,"File Extension":be(l.fsPath||l.path).split(".").pop()||"No extension","Is Excluded":e?await e.m(l):"Unknown"})}if(u.Configuration={"Excluded Folders":c.get("excludedFolders",[]),"Excluded Patterns":c.get("excludedPatterns",[]),"Color Scheme":c.get("colorScheme","none"),"Cache Timeout":`${c.get("cacheTimeout",3e4)}ms`},e){let l=e.getMetrics();u.Performance={"Total Decorations":l.totalDecorations,"Cache Size":l.cacheSize,"Cache Hit Rate":l.cacheHitRate,Errors:l.errors},l.performanceTiming&&(u["Performance Timing"]={"Avg Git Blame (ms)":l.performanceTiming.avgGitBlameMs,"Avg File Stat (ms)":l.performanceTiming.avgFileStatMs,"Git Calls":l.performanceTiming.gitBlameCalls,"File Stat Calls":l.performanceTiming.fileStatCalls,"Total Git Time (ms)":l.performanceTiming.totalGitBlameTimeMs,"Total File Stat Time (ms)":l.performanceTiming.totalFileStatTimeMs})}let g=a.window.createWebviewPanel("explorerDatesDiagnostics","Explorer Dates Diagnostics",a.ViewColumn.One,{enableScripts:!0});g.webview.html=await s(u),t.info("Diagnostics panel opened",u)}catch(s){t.error("Failed to run diagnostics",s),a.window.showErrorMessage(`Failed to run diagnostics: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.testDecorations",async()=>{try{let{generateDiagnosticsWebview:s}=await n();t.info("\u{1F50D} Starting comprehensive decoration diagnostics...");let{DecorationDiagnostics:c}=B(),u=await new c(e).runComprehensiveDiagnostics(),g=a.window.createWebviewPanel("decorationDiagnostics","Decoration Diagnostics - Root Cause Analysis",a.ViewColumn.One,{enableScripts:!0});g.webview.html=await s(u);let l=[],E=[];Object.values(u.tests).forEach(w=>{w.issues&&w.issues.forEach(m=>{m.startsWith("CRITICAL:")?l.push(m):m.startsWith("WARNING:")&&E.push(m)})}),l.length>0?a.window.showErrorMessage(`CRITICAL ISSUES FOUND: ${l.join(", ")}`):E.length>0?a.window.showWarningMessage(`Warnings found: ${E.length} potential issues detected. Check diagnostics panel.`):a.window.showInformationMessage("No critical issues found. Decorations should be working properly."),t.info("\u{1F50D} Comprehensive diagnostics completed",u)}catch(s){t.error("Failed to run comprehensive diagnostics",s),a.window.showErrorMessage(`Diagnostics failed: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.monitorDecorations",async()=>{if(!e){a.window.showErrorMessage("Decoration provider not available");return}e.startProviderCallMonitoring(),e.forceRefreshAllDecorations(),setTimeout(()=>{let s=e.getProviderCallStats(),c=`VS Code Decoration Requests: ${s.totalCalls} calls for ${s.uniqueFiles} files`;a.window.showInformationMessage(c),t.info("\u{1F50D} Decoration monitoring results:",s)},5e3),a.window.showInformationMessage("Started monitoring VS Code decoration requests. Results in 5 seconds...")})),r.push(a.commands.registerCommand("explorerDates.testVSCodeRendering",async()=>{try{let{testVSCodeDecorationRendering:s,testFileDecorationAPI:c}=j();t.info("\u{1F3A8} Testing VS Code decoration rendering system...");let h=await c();t.info("\u{1F527} FileDecoration API tests:",h);let u=await s();t.info("\u{1F3A8} Decoration rendering test:",u),a.window.showInformationMessage('VS Code decoration rendering test started. Check Output panel and Explorer for "TEST" badges on files.')}catch(s){t.error("Failed to test VS Code rendering:",s),a.window.showErrorMessage(`VS Code rendering test failed: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.quickFix",async()=>{try{let s=a.workspace.getConfiguration("explorerDates"),c=[];s.get("showDateDecorations",!0)||c.push({issue:"Date decorations are disabled",description:"Enable date decorations",fix:async()=>s.update("showDateDecorations",!0,a.ConfigurationTarget.Global)});let h=s.get("excludedPatterns",[]);if(h.includes("**/*")&&c.push({issue:"All files are excluded by pattern",description:"Remove overly broad exclusion pattern",fix:async()=>{let g=h.filter(l=>l!=="**/*");await s.update("excludedPatterns",g,a.ConfigurationTarget.Global)}}),c.length===0){a.window.showInformationMessage("No common issues detected. Decorations should be working.");return}let u=await a.window.showQuickPick(c.map(g=>({label:g.description,description:g.issue,fix:g.fix})),{placeHolder:"Select an issue to fix automatically"});u&&(await u.fix(),a.window.showInformationMessage("Fixed! Try refreshing decorations now."),e&&(e.clearAllCaches(),e.refreshAll()))}catch(s){t.error("Failed to run quick fix",s),a.window.showErrorMessage(`Failed to run quick fix: ${s.message}`)}})),r.push(a.commands.registerCommand("explorerDates.showKeyboardShortcuts",async()=>{try{e?.T?await e.T.showKeyboardShortcutsHelp():a.window.showInformationMessage("Keyboard shortcuts: Ctrl+Shift+D (toggle), Ctrl+Shift+C (copy date), Ctrl+Shift+I (file details), Ctrl+Shift+R (refresh), Ctrl+Shift+A (workspace activity)"),t.info("Keyboard shortcuts help shown")}catch(s){t.error("Failed to show keyboard shortcuts help",s),a.window.showErrorMessage(`Failed to show keyboard shortcuts help: ${s.message}`)}})),r.forEach(s=>i.subscriptions.push(s))}H.exports={registerAnalysisCommands:Ie}});var J=Y();module.exports={...J,registerAnalysisCommands:J.registerAnalysisCommands};
