var E=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var L=E((exports,module)=>{var vscode=require("vscode"),isWebRuntime=process.env.VSCODE_WEB==="true",inspectValue=isWebRuntime?o=>{if(typeof o=="string")return o;try{return JSON.stringify(o,null,2)}catch{return"<<unable to serialize log arg>>"}}:eval("require")("util").inspect,DEFAULT_LOG_PROFILE="default",SUPPORTED_PROFILES=new Set(["default","stress","soak"]),LOG_LEVEL_ORDER=["debug","info","warn","error"],DEFAULT_CONSOLE_LEVEL="warn",TEST_CONSOLE_LEVEL=process.env.EXPLORER_DATES_TEST_MODE==="1"?"warn":null,Logger=class{constructor(){this.r=vscode.window.createOutputChannel("Explorer Dates"),this.y=!1,this.b=null,this.S=process.env.EXPLORER_DATES_TEST_MODE==="1",this.w=(process.env.EXPLORER_DATES_LOG_PROFILE||DEFAULT_LOG_PROFILE).toLowerCase(),SUPPORTED_PROFILES.has(this.w)||(this.w=DEFAULT_LOG_PROFILE),this.E=new Map,this.N=DEFAULT_CONSOLE_LEVEL,this.W(),this.b=vscode.workspace.onDidChangeConfiguration(e=>{(e.affectsConfiguration("explorerDates.enableLogging")||e.affectsConfiguration("explorerDates.consoleLogLevel"))&&this.W()})}W(){let e=vscode.workspace.getConfiguration("explorerDates");this.y=e.get("enableLogging",!1);let t=(process.env.EXPLORER_DATES_LOG_LEVEL||"").toLowerCase(),r=(e.get("consoleLogLevel",DEFAULT_CONSOLE_LEVEL)||"").toLowerCase(),n=TEST_CONSOLE_LEVEL||t||r||DEFAULT_CONSOLE_LEVEL;this.N=LOG_LEVEL_ORDER.includes(n)?n:DEFAULT_CONSOLE_LEVEL,TEST_CONSOLE_LEVEL&&(this.y=!1)}setLogProfile(e=DEFAULT_LOG_PROFILE){let t=(e||DEFAULT_LOG_PROFILE).toLowerCase();this.w=SUPPORTED_PROFILES.has(t)?t:DEFAULT_LOG_PROFILE,this.resetThrottle()}resetThrottle(e){if(e){this.E.delete(e);return}this.E.clear()}debug(e,...t){this.y&&this.k("debug",null,e,t)}info(e,...t){this.k("info",null,e,t)}infoWithOptions(e,t,...r){this.k("info",e||null,t,r)}warn(e,...t){this.k("warn",null,e,t)}error(e,t,...r){let s=`[${new Date().toISOString()}] [ERROR] ${e}`;this.S||(this.r.appendLine(s),t instanceof Error?(this.r.appendLine(`Error: ${t.message}`),t.stack&&this.r.appendLine(`Stack: ${t.stack}`)):t&&this.r.appendLine(this.T(t)));let i=this.M(r);i.length>0&&!this.S&&i.forEach(c=>this.r.appendLine(this.T(c)));let a=[];t!=null&&a.push(t),i.length>0&&a.push(...i),this.A("error",s,a)}show(){this.r.show()}clear(){this.r.clear()}dispose(){this.r.dispose(),this.b&&(this.b.dispose(),this.b=null);let e="__explorerDatesLogger";typeof global<"u"&&global[e]===this?global[e]=null:typeof globalThis<"u"&&globalThis[e]===this?globalThis[e]=null:typeof globalThis<"u"&&globalThis.window?.[e]===this&&(globalThis.window[e]=null),loggerInstance===this&&(loggerInstance=null)}k(e,t,r,n){if(e==="debug"&&!this.y||this.Q(e,t))return;let i=`[${new Date().toISOString()}] [${e.toUpperCase()}] ${r}`;this.S||this.r.appendLine(i);let a=this.M(n);a.length>0&&!this.S&&a.forEach(c=>this.r.appendLine(this.T(c))),this.A(e,i,a)}M(e){return!e||e.length===0?[]:e.map(t=>{if(typeof t!="function")return t;try{return t()}catch(r){return`<<log arg threw: ${r.message}>>`}})}T(e){try{return typeof e=="string"?e:typeof e=="object"?JSON.stringify(e,null,2):inspectValue(e)}catch(t){return`<<failed to serialize log arg: ${t.message}>>`}}Q(e,t){if(e!=="info"||!t||!t.throttleKey)return!1;let r=(t.profile||"stress").toLowerCase();if(!this.ee(r))return!1;let n=Number(t.throttleLimit)||50,s=t.throttleKey,i=this.E.get(s)||{count:0,suppressed:0,noticeLogged:!1};if(i.count<n)return i.count+=1,this.E.set(s,i),!1;if(i.suppressed+=1,!i.noticeLogged){i.noticeLogged=!0;let a=`[${new Date().toISOString()}] [INFO] \u23F8\uFE0F Suppressing further logs for "${s}" after ${n} entries (profile=${this.w})`;this.r.appendLine(a),this.A("info",a)}return this.E.set(s,i),!0}ee(e){let t=this.w||DEFAULT_LOG_PROFILE;return e==="default"?t===DEFAULT_LOG_PROFILE:t===e}te(e){let t=LOG_LEVEL_ORDER.indexOf(this.N),r=LOG_LEVEL_ORDER.indexOf(e);return t===-1||r===-1?!1:r>=t}A(e,t,r=[]){if(!this.te(e))return;(e==="warn"?console.warn:e==="error"?console.error:console.log).call(console,t,...r)}},GLOBAL_LOGGER_KEY="__explorerDatesLogger";function getLogger(){return typeof global<"u"?(global[GLOBAL_LOGGER_KEY]||(global[GLOBAL_LOGGER_KEY]=new Logger),global[GLOBAL_LOGGER_KEY]):typeof globalThis<"u"?(globalThis[GLOBAL_LOGGER_KEY]||(globalThis[GLOBAL_LOGGER_KEY]=new Logger),globalThis.window&&(globalThis.window[GLOBAL_LOGGER_KEY]=globalThis[GLOBAL_LOGGER_KEY]),globalThis[GLOBAL_LOGGER_KEY]):(loggerInstance||(loggerInstance=new Logger),loggerInstance)}var loggerInstance=null;module.exports={Logger,getLogger}});var U=E((Zt,se)=>{var Be=["Ja","Fe","Mr","Ap","My","Jn","Jl","Au","Se","Oc","No","De"],Ue=Number(process.env.EXPLORER_DATES_DECORATION_POOL_SIZE||2048),Ge=Number(process.env.EXPLORER_DATES_FLYWEIGHT_CACHE_SIZE||4096),ze=Number(process.env.EXPLORER_DATES_WORKSPACE_BALANCED_THRESHOLD||15e3),He=Number(process.env.EXPLORER_DATES_WORKSPACE_LARGE_THRESHOLD||25e4),ne=Number(process.env.EXPLORER_DATES_WORKSPACE_EXTREME_THRESHOLD||4e5),qe=Number(process.env.EXPLORER_DATES_WORKSPACE_SCAN_MAX_RESULTS||Math.min(ne+1,50001)),Je={ADVANCED_CACHE:"explorerDates.advancedCache",ADVANCED_CACHE_METADATA:"explorerDates.advancedCacheMetadata",TEMPLATE_STORE:"explorerDates.templates",WEB_GIT_NOTICE:"explorerDates.webGitNotice"},Ye="explorerDatesChunks",Xe="__explorerDatesChunks";se.exports={DEFAULT_CACHE_TIMEOUT:12e4,DEFAULT_MAX_CACHE_SIZE:1e4,DEFAULT_PERSISTENT_CACHE_TTL:864e5,DEFAULT_DECORATION_POOL_SIZE:Ue,DEFAULT_FLYWEIGHT_CACHE_SIZE:Ge,MAX_BADGE_LENGTH:2,MONTH_ABBREVIATIONS:Be,WORKSPACE_SCALE_BALANCED_THRESHOLD:ze,WORKSPACE_SCALE_LARGE_THRESHOLD:He,WORKSPACE_SCALE_EXTREME_THRESHOLD:ne,WORKSPACE_SCAN_MAX_RESULTS:qe,GLOBAL_STATE_KEYS:Je,WEB_CHUNK_GLOBAL_KEY:Ye,LEGACY_WEB_CHUNK_GLOBAL_KEY:Xe}});var ue=E((Qt,le)=>{var b=require("vscode"),{getLogger:Ze}=L(),{WORKSPACE_SCALE_BALANCED_THRESHOLD:oe,WORKSPACE_SCALE_LARGE_THRESHOLD:P,WORKSPACE_SCALE_EXTREME_THRESHOLD:ie,WORKSPACE_SCAN_MAX_RESULTS:ae}=U(),G=Ze(),R=null;function ce(o){return o&&(o.fsPath||o.path)||null}function z(o,e){let t=ce(o);!t||typeof e!="number"||(R={workspaceKey:t,fileCount:e,timestamp:Date.now()})}function H(o){let e=ce(o);return!e||!R||R.workspaceKey!==e?null:R}function Qe(o,e="default"){if(!o)return`unknown-workspace-${e}`;let t=o.fsPath||o.path||"",r=t.split("/").pop()||"workspace",n=Math.abs(t.split("").reduce((i,a)=>(i=(i<<5)-i+a.charCodeAt(0),i&i),0)).toString(36).substr(0,8),s=Math.abs(e.split("").reduce((i,a)=>(i=(i<<5)-i+a.charCodeAt(0),i&i),0)).toString(36).substr(0,4);return`${r}-${n}-${s}`}async function et(o){try{if(!o)return"unknown";let e=H(o),t;e?t=e.fileCount:(t=(await b.workspace.findFiles("**/*",null,ae)).length,z(o,t));let r="small";t>=ie?r="extreme":t>=P?r="large":t>=1e3&&(r="medium");let n=b.env.remoteName,s=b.env.uiKind===b.UIKind.Web,i=r==="medium"&&t>=oe&&t<P;if(r==="extreme"||r==="large"&&(n||s))return"minimal";if(r==="large"||i||n||s)return"balanced";try{let c=(await b.workspace.fs.readDirectory(o)).map(([p])=>p.toLowerCase());if(c.includes("package.json")||c.includes("yarn.lock"))return"web-development";if(c.some(p=>p.endsWith(".ipynb"))||c.includes("requirements.txt"))return"data-science";if(c.includes("docker-compose.yml")||c.includes(".enterprise"))return"enterprise"}catch(a){G.debug("Project type detection failed:",a)}return"full"}catch(e){return G.error("Workspace profile detection failed:",e),"unknown"}}async function tt(o){if(!o)return null;try{let e=H(o),t;e?t=e.fileCount:(t=(await b.workspace.findFiles("**/*",null,ae)).length,z(o,t));let r="small";t>=ie?r="extreme":t>=P?r="large":t>=1e3&&(r="medium");let n=!!b.env.remoteName,s=b.env.uiKind===b.UIKind.Web,i=s?"web":n?"remote":"local",a=r==="medium"&&t>=oe&&t<P;return{workspaceSize:r,fileCount:t,remoteType:i,isRemoteEnvironment:n||s,timestamp:Date.now(),mediumBalanced:a}}catch(e){return G.error("Workspace environment analysis failed:",e),null}}le.exports={generateWorkspaceKey:Qe,detectWorkspaceProfile:et,analyzeWorkspaceEnvironment:tt,setCachedWorkspaceMetrics:z,getCachedWorkspaceMetrics:H}});var I=E((er,fe)=>{var f={onboarding:34,analysisCommands:23,exportReporting:17,extensionApi:15,workspaceTemplates:14,advancedCache:28,workspaceIntelligence:31,incrementalWorkers:19},D=99,k={minimal:{id:"minimal",name:"Minimal",description:"Core decorations only, smallest bundle (~99KB)",targetBundleSize:D,settings:{"explorerDates.enableOnboardingSystem":!1,"explorerDates.enableAnalysisCommands":!1,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!1,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.performanceMode":!0,"explorerDates.showDateDecorations":!0,"explorerDates.dateDecorationFormat":"relative-short"},targetScenarios:["Resource-constrained environments","Basic file dates only","Large remote workspaces"]},balanced:{id:"balanced",name:"Balanced",description:"Essential features with optimization (~200KB)",targetBundleSize:D+f.onboarding+f.workspaceTemplates+f.advancedCache+f.analysisCommands,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.performanceMode":!0,"explorerDates.smartFileWatching":!0},targetScenarios:["Most development workflows","Remote environments","Medium to large workspaces"]},"web-development":{id:"web-development",name:"Web Development",description:"Optimized for web projects (~240KB)",targetBundleSize:D+f.onboarding+f.analysisCommands+f.workspaceTemplates+f.advancedCache+f.incrementalWorkers,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!1,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!1,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.showGitInfo":"author","explorerDates.colorScheme":"file-type"},targetScenarios:["JavaScript/TypeScript projects","Node.js development","Frontend frameworks"]},enterprise:{id:"enterprise",name:"Enterprise",description:"Full feature set with reporting and API (~380KB)",targetBundleSize:Object.values(f).reduce((o,e)=>o+e,D),settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!0,"explorerDates.enableWorkspaceTemplates":!0,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!0,"explorerDates.persistentCache":!0,"explorerDates.smartExclusions":!0},targetScenarios:["Team lead workflows","Analytics and reporting needs","API integration requirements","Full workspace intelligence"]},"data-science":{id:"data-science",name:"Data Science",description:"Optimized for data workflows (~280KB)",targetBundleSize:D+f.onboarding+f.analysisCommands+f.exportReporting+f.workspaceIntelligence+f.advancedCache,settings:{"explorerDates.enableOnboardingSystem":!0,"explorerDates.enableAnalysisCommands":!0,"explorerDates.enableExportReporting":!0,"explorerDates.enableExtensionApi":!1,"explorerDates.enableWorkspaceTemplates":!1,"explorerDates.enableAdvancedCache":!0,"explorerDates.enableWorkspaceIntelligence":!0,"explorerDates.enableIncrementalWorkers":!1,"explorerDates.dateDecorationFormat":"iso-detailed"},targetScenarios:["Jupyter notebooks","Python data analysis","Research workflows"]}},rt=new Set(["enableOnboardingSystem","enableAnalysisCommands","enableExportReporting","enableExtensionApi","enableWorkspaceTemplates","enableAdvancedCache","enableWorkspaceIntelligence","enableIncrementalWorkers","performanceMode","smartFileWatching"]);function nt(o){let e=D;return o["explorerDates.enableOnboardingSystem"]&&(e+=f.onboarding),o["explorerDates.enableAnalysisCommands"]&&(e+=f.analysisCommands),o["explorerDates.enableExportReporting"]&&(e+=f.exportReporting),o["explorerDates.enableExtensionApi"]&&(e+=f.extensionApi),o["explorerDates.enableWorkspaceTemplates"]&&(e+=f.workspaceTemplates),o["explorerDates.enableAdvancedCache"]&&(e+=f.advancedCache),o["explorerDates.enableWorkspaceIntelligence"]&&(e+=f.workspaceIntelligence),o["explorerDates.enableIncrementalWorkers"]&&(e+=f.incrementalWorkers),e}function st(o){switch(o){case"minimal":case"extreme":return k.minimal;case"balanced":return k.balanced;case"web-development":return k["web-development"];case"data-science":return k["data-science"];case"enterprise":return k.enterprise;default:return k.balanced}}fe.exports={PRESET_DEFINITIONS:k,CHUNK_SIZES:f,BASE_BUNDLE_SIZE:D,RESTART_REQUIRED_SETTINGS:rt,calculateBundleSize:nt,getDefaultPresetForProfile:st}});var Y=E((tr,ge)=>{var ot="__explorerDatesVscode",C=null,F=null,$=!1;function it(){try{return globalThis[ot]}catch{return}}function he(){if(F)return F;let o={get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})};return F={workspace:{workspaceFolders:[],getConfiguration:()=>o},ConfigurationTarget:{Global:1,Workspace:2,WorkspaceFolder:3}},F}var at=new Set(["MODULE_NOT_FOUND","ERR_MODULE_NOT_FOUND","WEB_NATIVE_MODULE"]);function ct(o){return!o||o.code&&at.has(o.code)?!0:(typeof o.message=="string"?o.message:"").includes("Cannot find module 'vscode'")}function _(){let o=it();if(o)return C=q(o),$=!1,C;if(C&&!$)return C;try{C=q(require("vscode")),$=!1}catch(e){if(ct(e))C=q(he()),$=!0;else throw e}return C}var w=new Proxy({},{get(o,e){return _()[e]},set(o,e,t){return _()[e]=t,!0},has(o,e){return e in _()},ownKeys(){return Reflect.ownKeys(_())},getOwnPropertyDescriptor(o,e){let t=Object.getOwnPropertyDescriptor(_(),e);return t&&(t.configurable=!0),t}}),lt="explorerDates",pe="__explorerDatesConfigWrapped";function de(o){return!o||typeof o!="object"?{get:()=>{},async update(){},inspect:()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})}:(typeof o.get!="function"&&(o.get=()=>{}),typeof o.update!="function"&&(o.update=async()=>{}),typeof o.inspect!="function"&&(o.inspect=()=>({defaultValue:void 0,globalValue:void 0,workspaceValue:void 0,workspaceFolderValue:void 0})),o)}function q(o){if(!o)return he();o.ConfigurationTarget||(o.ConfigurationTarget={Global:1,Workspace:2,WorkspaceFolder:3}),o.workspace||(o.workspace={});let e=o.workspace.getConfiguration;if(typeof e=="function"&&!e[pe]){let t=function(...r){let n=e.apply(this,r);return de(n)};t[pe]=!0,o.workspace.getConfiguration=t}else typeof e!="function"&&(o.workspace.getConfiguration=()=>de());return Array.isArray(o.workspace.workspaceFolders)||(o.workspace.workspaceFolders=[]),o}var N=class{constructor(e={}){this.re=e.defaultSection||lt}getValue(e,t={}){let{section:r,resource:n}=t,s=this.x(e,r);return this.L(s.section,n).get(s.key)}inspect(e,t={}){let{section:r,resource:n}=t,s=this.x(e,r);return this.L(s.section,n).inspect(s.key)}async updateSetting(e,t,r={}){let{scope:n="auto",resource:s,section:i,force:a=!1}=r,c=this.x(e,i),p=this.L(c.section,s),y=this.ne(n,s),x=p.get(c.key),V=p.inspect(c.key),B=this.se(V,y);return t!==void 0&&this.oe(x,t)&&!a&&B!==void 0?{key:c.fullKey,updated:!1,reason:"unchanged"}:(await p.update(c.key,t,y),{key:c.fullKey,updated:!0})}async applySettings(e,t={}){let r=Array.isArray(e)?e:Object.entries(e).map(([s,i])=>({key:s,value:i})),n=[];for(let s of r){let i={...t,...s.options||{}};n.push(await this.updateSetting(s.key,s.value,i))}return n}async clearSetting(e,t={}){return this.updateSetting(e,void 0,t)}L(e,t){return w.workspace.getConfiguration(e||void 0,t)}x(e,t){let r=t||this.re;if(!r)return{section:void 0,key:e,fullKey:e};if(e.startsWith(`${r}.`)){let n=e.slice(r.length+1);return{section:r,key:n,fullKey:e}}return e.includes(".")?{section:void 0,key:e,fullKey:e}:{section:r,key:e,fullKey:`${r}.${e}`}}ne(e,t){return e&&e!=="auto"?this.ie(e)||w.ConfigurationTarget.Workspace:t?w.ConfigurationTarget.WorkspaceFolder:w.workspace.workspaceFolders&&w.workspace.workspaceFolders.length>0?w.ConfigurationTarget.Workspace:w.ConfigurationTarget.Global}ie(e){switch(e){case"user":return w.ConfigurationTarget.Global;case"workspace":return w.ConfigurationTarget.Workspace;case"workspaceFolder":return w.ConfigurationTarget.WorkspaceFolder;default:return}}_e(e){switch(e){case w.ConfigurationTarget.Global:return"user";case w.ConfigurationTarget.Workspace:return"workspace";case w.ConfigurationTarget.WorkspaceFolder:return"workspaceFolder";default:return"unknown"}}oe(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}se(e,t){if(e)switch(t){case w.ConfigurationTarget.Global:return e.globalValue;case w.ConfigurationTarget.Workspace:return e.workspaceValue;case w.ConfigurationTarget.WorkspaceFolder:return e.workspaceFolderValue;default:return}}},J=null;function ut(o){return(!J||o&&o.forceNew)&&(J=new N(o)),J}ge.exports={SettingsCoordinator:N,getSettingsCoordinator:ut}});var Ee=E((rr,we)=>{var d=require("vscode"),{getLogger:ft}=L(),{generateWorkspaceKey:pt,detectWorkspaceProfile:dt,analyzeWorkspaceEnvironment:X}=ue(),{PRESET_DEFINITIONS:W,calculateBundleSize:ht,getDefaultPresetForProfile:gt,RESTART_REQUIRED_SETTINGS:me}=I(),{getSettingsCoordinator:mt}=Y(),{WORKSPACE_SCALE_LARGE_THRESHOLD:wt,WORKSPACE_SCALE_EXTREME_THRESHOLD:Et}=U(),O=ft(),Z=class{constructor(e){this.j=e,this.e=e.globalState,this.t=null,this.l=null,this.u="explorerDates.pendingRestart",this.K="explorerDates.suggestionHistory",this.D="explorerDates.presetBackup",this._="explorerDates.lastPreset",this.f=mt(),this.ae(),O.info("Runtime configuration manager initialized")}async getCurrentRuntimeState(){let e=d.workspace.getConfiguration("explorerDates"),t=this.p(e),r=this.n(null,t),n=d.workspace.workspaceFolders?.[0]?.uri,s=await X(n);return{currentSettings:t,currentBundleSize:r,analysis:s,availablePresets:Object.keys(W),pendingRestart:this.e.get(this.u,[]),timestamp:Date.now()}}async checkAutoSuggestion(){try{let e=d.workspace.workspaceFolders?.[0]?.uri;if(!e)return;let t=await dt(e),r=pt(e,t),n=this.e.get(this.K,{}),s=n[r];if(!s||s.profileDetected!==t||await this.ce(s)){let a=await this.le(t);if(a){let c=await X(e);n[r]={profileDetected:t,suggestedAt:Date.now(),fileCountAtSuggestion:c?.fileCount||0,accepted:a.accepted,presetId:a.preset},await this.e.update(this.K,n),O.info("Auto-suggestion updated:",n[r])}}}catch(e){O.error("Auto-suggestion check failed:",e)}}async le(e){let t=this.p(d.workspace.getConfiguration("explorerDates")),r=gt(e),n=this.n(null,t),s=r?this.n(r.settings,t):n,i=n-s;if(i<=10)return{accepted:!1,preset:e,reason:"minimal savings"};let a=`Explorer Dates detected a ${e} workspace. Would you like to apply ${r.name} settings? This could save ~${i}KB.`;switch(await d.window.showInformationMessage(a,{modal:!1},"Apply Settings","Show Details","Not Now")){case"Apply Settings":return await this.v(r.id,r),{accepted:!0,preset:e};case"Show Details":return await this.showPresetComparison(t,r),{accepted:!1,preset:e};default:return{accepted:!1,preset:e}}}async v(e,t=null){let r=t||W[e];if(!r)throw new Error(`Unknown preset: ${e}`);let n=this.p(d.workspace.getConfiguration("explorerDates"));await this.ue(e,n);let s;try{s=await this.f.applySettings(r.settings,{scope:"workspace",reason:`apply-preset:${e}`})}catch(a){throw d.window.showErrorMessage(`Failed to apply "${r.name}" preset: ${a.message}`),O.error(`Preset application failed for ${e}:`,a),a}let i=s.filter(a=>a.updated).map(a=>a.key.replace("explorerDates.",""));return i.length>0&&(this.V(i),O.info(`Applied ${r.name} preset`,{changedSettings:i})),{applied:i.length,preset:r,requiresRestart:i.some(a=>me.has(a)),estimatedBundleSize:this.n()}}async restorePreviousPreset(e={}){let t=this.e.get(this.D,null);if(!t?.settings)return e.silent||d.window.showInformationMessage("No previous preset available to restore."),{restored:!1,reason:"no-backup"};let r;try{r=await this.f.applySettings(t.settings,{scope:"workspace",reason:"restore-previous-preset"})}catch(s){throw e.silent||d.window.showErrorMessage(`Failed to restore previous preset: ${s.message}`),O.error("Preset rollback failed:",s),s}let n=r.filter(s=>s.updated).map(s=>s.key.replace("explorerDates.",""));return await this.e.update(this.u,[]),await this.e.update(this.D,null),await this.e.update(this._,t.previousPreset||null),e.silent||d.window.showInformationMessage("Previous preset restored."),{restored:!0,changedSettings:n,restoredPreset:t.previousPreset||"unknown"}}async showPresetComparison(e,t){let r=e||this.p(d.workspace.getConfiguration("explorerDates")),n=this.n(null,r),s=t?this.n(t.settings,r):n,i=n-s,a=[{label:"\u{1F4E6} Current Configuration",description:`Bundle: ${n}KB total`,detail:this.B(r),action:"current"},t?{label:`\u26A1 Recommended: ${t.name}`,description:`Bundle: ${s}KB total (saves ${Math.max(0,i)}KB)`,detail:this.B(t.settings),action:"apply",preset:t}:null,{label:"\u{1F527} Browse All Presets...",description:`Choose from ${Object.keys(W).length} available presets`,detail:"Minimal, Balanced, Web Development, Enterprise, Data Science",action:"browse"}].filter(Boolean),c=await d.window.showQuickPick(a,{placeHolder:"Choose configuration approach",ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0});if(c)switch(c.action){case"apply":c.preset&&await this.v(c.preset.id,c.preset);break;case"browse":await this.showAllPresets();break}}async showAllPresets(){let e=this.p(d.workspace.getConfiguration("explorerDates")),t=this.n(null,e),r=Object.values(W).map(s=>{let i=this.n(s.settings,e),a=t-i,c=a>0?`saves ${a}KB`:a<0?`adds ${Math.abs(a)}KB`:"same size";return{label:`${s.name}`,description:`${i}KB (${c})`,detail:`${s.description} - ${s.targetScenarios.join(", ")}`,preset:s}}),n=await d.window.showQuickPick(r,{placeHolder:"Select a preset configuration",ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0});n?.preset&&await d.window.showInformationMessage(`Apply "${n.preset.name}" preset?
${n.preset.description}`,{modal:!1},"Apply","Cancel")==="Apply"&&await this.v(n.preset.id,n.preset)}ae(){this.t=d.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorerDates")&&this.fe(e)})}async fe(e){let t=Array.from(me).filter(r=>e.affectsConfiguration(`explorerDates.${r}`));t.length>0&&this.V(t)}V(e){let t=this.e.get(this.u,[]),r=[...new Set([...t,...e])];this.e.update(this.u,r),this.l&&clearTimeout(this.l),this.l=setTimeout(async()=>{await this.pe(),this.l=null},2e3)}async pe(){let e=this.e.get(this.u,[]);if(e.length===0)return;let t=e.map(i=>this.de(i)).join(", "),n=`${e.length===1?`"${t}"`:`${e.length} settings (${t})`} changed. Reload to apply chunk optimizations?`;await d.window.showInformationMessage(n,{modal:!1},"Reload Now","Reload Later")==="Reload Now"&&await d.commands.executeCommand("workbench.action.reloadWindow"),await this.e.update(this.u,[])}async ue(e,t={}){if(!this.e||typeof this.e.update!="function")return;let r=this.e.get(this._,null),n=this.e.get(this.D,null),s=n?.timestamp?Date.parse(n.timestamp):null,i=Number.isFinite(s)?Math.max(Date.now(),s+1):Date.now(),a={timestamp:new Date(i).toISOString(),appliedPreset:e,previousPreset:r||"unknown",settings:{...t}};await this.e.update(this.D,a),await this.e.update(this._,e)}n(e=null,t=null){let r=t?{...t}:this.p(d.workspace.getConfiguration("explorerDates"));return e&&typeof e=="object"&&Object.assign(r,e),ht(r)}p(e){let t={enableOnboardingSystem:!0,enableAnalysisCommands:!0,enableExportReporting:!0,enableExtensionApi:!0,enableWorkspaceTemplates:!0,enableAdvancedCache:!0,enableWorkspaceIntelligence:!0,enableIncrementalWorkers:!1},r={};for(let[n,s]of Object.entries(t))r[`explorerDates.${n}`]=e.get(n,s);return r}B(e){let t=Object.entries(e).filter(([s,i])=>i===!0&&s.includes("enable")).map(([s])=>s.replace("explorerDates.enable","").replace("System","")).slice(0,3),r=Math.max(0,Object.keys(e).length-3),n=r>0?` +${r} more`:"";return`Features: ${t.join(", ")}${n}`}de(e){return e.replace("enable","").replace(/([A-Z])/g," $1").trim()}async ce(e){if(!e)return!0;try{let t=d.workspace.workspaceFolders?.[0]?.uri,r=await X(t);if(!r)return!1;let n=e.fileCountAtSuggestion||0,s=r.fileCount,i=this.U(n),a=this.U(s);return i!==a}catch(t){return O.debug("Heuristics change check failed:",t),!1}}U(e){return e>=Et?"extreme":e>=wt?"large":e>=1e3?"medium":"small"}dispose(){this.t&&this.t.dispose(),this.l&&clearTimeout(this.l)}};we.exports={RuntimeConfigManager:Z}});var Se=E((nr,be)=>{var ye=require("vscode");function yt(){try{return ye?.env?.uiKind===ye?.UIKind?.Web}catch{return!1}}be.exports={isWebEnvironment:yt}});var Ce=E((sr,De)=>{function T(o=""){return o?o.replace(/\\/g,"/"):""}function bt(o=""){let e=T(o);return e?e.split("/").filter(Boolean):[]}function ke(o=""){let e=bt(o);return e.length?e[e.length-1]:""}function St(o=""){let e=ke(o),t=e.lastIndexOf(".");return t<=0?"":e.substring(t).toLowerCase()}function kt(o=""){let e=T(o),t=e.lastIndexOf("/");return t===-1?"":e.substring(0,t)}function Dt(...o){return T(o.filter(Boolean).join("/")).replace(/\/+/g,"/")}function Ct(o=""){return T(o).toLowerCase()}function Ot(o=""){if(!o)return"";if(typeof o=="string")return o;if(typeof o.fsPath=="string"&&o.fsPath.length>0)return o.fsPath;if(typeof o.path=="string"&&o.path.length>0)return o.path;if(typeof o.toString=="function")try{return o.toString(!0)}catch{return o.toString()}return String(o)}function Tt(o="",e=""){let t=T(o),r=T(e);return t&&r.startsWith(t)?r.substring(t.length).replace(/^\/+/,""):r}De.exports={normalizePath:T,getFileName:ke,getExtension:St,getDirectory:kt,joinPath:Dt,getCacheKey:Ct,getUriPath:Ot,getRelativePath:Tt}});var Ae=E((or,Te)=>{var M=class extends Error{constructor(e,t,r={}){super(t),this.code=e,this.context=r,this.name="ExtensionError"}},Oe={FILE_PERMISSION_DENIED:"FILE_PERMISSION_DENIED",WORKSPACE_TOO_LARGE:"WORKSPACE_TOO_LARGE",CHUNK_LOAD_FAILED:"CHUNK_LOAD_FAILED"};function At(o){if(!o)return!1;let e=o.code||o?.name;return["EACCES","EPERM","EROFS","NoPermissions"].includes(e)}var Q=class extends M{constructor(e,t,r={}){let{recoverable:n=!0,context:s={}}=r;super(Oe.CHUNK_LOAD_FAILED,`Failed to load ${e}: ${t}`,{chunkName:e,recoverable:n,...s}),this.name="ChunkLoadError",this.chunkName=e,this.recoverable=n}};function xt(o,e,t={}){let r=require("vscode"),{userFacing:n=!0}=t,s=e?.recoverable??!0;n&&!s&&r.window.showErrorMessage(`Explorer Dates: ${o} feature unavailable. Please reinstall or rebuild the extension.`)}Te.exports={ExtensionError:M,ERROR_CODES:Oe,isPermissionError:At,ChunkLoadError:Q,handleChunkFailure:xt}});var ve=E((ir,_e)=>{function xe(){return typeof performance<"u"&&performance.now&&performance.timeOrigin?Math.floor(performance.timeOrigin+performance.now()):typeof Date=="function"&&Date.now?Date.now():16409952e5}function Le(o){return!!(o&&typeof o=="object"&&typeof o.getTime=="function")}function A(o){if(!o||isNaN(o))return"Invalid Date";if(typeof Intl<"u"&&Intl.DateTimeFormat)try{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(o)}catch{}let e=864e5,t=36e5,r=6e4,n=1e3,s=1970,i=Math.floor(o/e),a=o%e,c=Math.floor(a/t),p=Math.floor(a%t/r),y=Math.floor(a%r/n),x=s+Math.floor(i/365.25),V=Math.floor(i%365.25/30.44)+1,B=Math.floor(i%30.44)+1,re=String(Math.min(V,12)).padStart(2,"0"),Me=String(Math.min(B,31)).padStart(2,"0"),je=String(c).padStart(2,"0"),Ke=String(p).padStart(2,"0"),Ve=String(y).padStart(2,"0");return`${re}/${Me}/${x}, ${je}:${Ke}:${Ve}`}function Lt(o){if(Le(o))return o;let e=typeof Date=="function"&&Date.prototype&&Date.prototype.constructor===Date;if(o==null){if(!e){let t=xe();return{getTime:()=>t,toLocaleString:()=>A(t),toString:()=>A(t)}}return new Date}if(typeof o=="number")return e?new Date(o):{getTime:()=>o,toLocaleString:()=>A(o),toString:()=>A(o)};if(typeof o=="string"){let t=0;if(e)t=Date.parse(o);else{let r=parseFloat(o);t=isNaN(r)?0:r}return e?new Date(o):{getTime:()=>t,toLocaleString:()=>A(t),toString:()=>A(t)}}return e?new Date(o):{getTime:()=>0,toLocaleString:()=>"Invalid Date",toString:()=>"Invalid Date"}}_e.exports={ensureDate:Lt,isDateLike:Le,getCurrentTimestamp:xe}});var Ie=E((ar,Pe)=>{var g=require("vscode"),{isWebEnvironment:_t}=Se(),{normalizePath:vt}=Ce(),{ExtensionError:Rt,ERROR_CODES:Pt,isPermissionError:It}=Ae(),{ensureDate:ee}=ve(),Re=process.env.VSCODE_WEB==="true",Ft=process.env.EXPLORER_DATES_FORCE_VSCODE_FS==="1",m=null;if(!Re&&!Ft)try{m=require("fs").promises}catch{m=null}var j=class{constructor(){this.isWeb=Re||_t()}i(e){if(!e)return"";if(typeof e=="string")return e;if(e&&typeof e=="object"&&typeof e.fsPath=="string")return e.fsPath;if(e&&typeof e=="object"&&typeof e.path=="string")return e.path;if(typeof e=="object"){if(typeof e.fsPath=="string")return e.fsPath;if(typeof e.path=="string")return e.path}return String(e)}a(e){if(e&&typeof e=="object"&&typeof e.scheme=="string"&&typeof e.path=="string")return e;if(typeof e=="string")return g.Uri.file(e);if(e&&typeof e=="object"){if(e.uri&&e.uri!==e)try{return this.a(e.uri)}catch{}if(typeof e.fsPath=="string"&&e.fsPath.length>0)return g.Uri.file(e.fsPath);if(typeof e.path=="string"&&e.path.length>0)return g.Uri.file(e.path);if(typeof e.href=="string"&&e.href.length>0)return g.Uri.parse(e.href);if(typeof e.scheme=="string")return g.Uri.from({scheme:e.scheme,authority:e.authority||"",path:e.path||e.fsPath||"",query:e.query||"",fragment:e.fragment||""});if(typeof e.toString=="function")try{let t=e.toString(!0);if(t&&t!=="[object Object]")return g.Uri.parse(t)}catch{let t=e.toString();if(t&&t!=="[object Object]")return g.Uri.parse(t)}}throw new Error(`Unsupported target type: ${typeof e}`)}async stat(e){if(!this.isWeb&&m)return m.stat(this.i(e));let t=this.a(e),r=await g.workspace.fs.stat(t);return{...r,mtime:ee(r.mtime),ctime:ee(r.ctime),birthtime:ee(r.ctime),isFile:()=>r.type===g.FileType.File,isDirectory:()=>r.type===g.FileType.Directory}}async readFile(e,t="utf8"){if(!this.isWeb&&m)return m.readFile(this.i(e),t);let r=this.a(e),n=await g.workspace.fs.readFile(r);return t===null||t==="binary"?n:new TextDecoder(t).decode(n)}async writeFile(e,t,r="utf8"){let n=this.i(e);try{if(!this.isWeb&&m)return m.writeFile(n,t,r);let s=this.a(e),i=typeof t=="string"?new TextEncoder().encode(t):t;await g.workspace.fs.writeFile(s,i)}catch(s){this.G("write file",n,s)}}async mkdir(e,t={recursive:!0}){let r=this.i(e);try{if(!this.isWeb&&m)return m.mkdir(r,t);let n=this.a(e);await g.workspace.fs.createDirectory(n)}catch(n){this.G("create directory",r,n)}}async readdir(e,t={withFileTypes:!1}){if(!this.isWeb&&m)return m.readdir(this.i(e),t);let r=this.a(e),n=await g.workspace.fs.readDirectory(r);return t.withFileTypes?n.map(([s,i])=>({name:s,isDirectory:()=>i===g.FileType.Directory,isFile:()=>i===g.FileType.File})):n.map(([s])=>s)}async delete(e,t={recursive:!1}){if(!this.isWeb&&m){let n=this.i(e);return t.recursive?m.rm?m.rm(n,t):m.rmdir(n,t):m.unlink(n)}let r=this.a(e);await g.workspace.fs.delete(r,t)}async exists(e){try{return await this.stat(e),!0}catch{return!1}}async ensureDirectory(e){let t=vt(this.i(e));await this.mkdir(t,{recursive:!0})}G(e,t,r){throw It(r)?new Rt(Pt.FILE_PERMISSION_DENIED,`Permission denied while attempting to ${e}`,{path:t,code:r.code}):r}},$t=new j;Pe.exports={FileSystemAdapter:j,fileSystem:$t}});var $e=E((cr,Fe)=>{var l=require("vscode"),{getLogger:Nt}=L(),{fileSystem:Wt}=Ie(),{CHUNK_SIZES:Mt}=I(),{getSettingsCoordinator:jt}=Y(),u=Nt(),v="1.0.0",Kt="explorerDates.teamConfig.backup",K={"explorerDates.enableOnboardingSystem":"onboarding","explorerDates.enableAnalysisCommands":"analysisCommands","explorerDates.enableExportReporting":"exportReporting","explorerDates.enableExtensionApi":"extensionApi","explorerDates.enableWorkspaceTemplates":"workspaceTemplates","explorerDates.enableAdvancedCache":"advancedCache","explorerDates.enableWorkspaceIntelligence":"workspaceIntelligence","explorerDates.enableIncrementalWorkers":"incrementalWorkers"},Vt={onboarding:"Onboarding System",analysisCommands:"Analysis Commands",exportReporting:"Export Reporting",extensionApi:"Extension API",workspaceTemplates:"Workspace Templates",advancedCache:"Advanced Cache",workspaceIntelligence:"Workspace Intelligence",incrementalWorkers:"Incremental Workers"},te=class{constructor(e){this.j=e,this.s=Wt,this.d=".explorer-dates-profiles.json",this.c=null,this.R=null,this.P=null,this.o=new Map,this.C=new Set,this.t=null,this.h=null,this.f=jt(),u.info("Team persistence manager initialized with full functionality")}async validateTeamConfiguration(){try{let e=l.workspace.workspaceFolders?.[0]?.uri;if(!e)return{valid:!0,conflicts:[],hasTeamConfig:!1};let t=l.Uri.joinPath(e,this.d);if(!await this.I(t))return u.debug("No team configuration file found"),{valid:!0,conflicts:[],hasTeamConfig:!1};let n=await this.z(t);if(!n)return{valid:!0,conflicts:[],hasTeamConfig:!1};let s=await this.he(n);return s.length>0&&await this.H(s),{valid:s.length===0,conflicts:s,hasTeamConfig:!0,teamConfig:n}}catch(e){return u.error("Team configuration validation failed:",e),{valid:!0,conflicts:[],error:e.message}}}async H(e){let t=e.length,r=`Found ${t} conflict${t>1?"s":""} between team configuration and your personal settings.`;switch(await l.window.showWarningMessage(r,"Show Details","Use Team Config","Keep My Settings")){case"Show Details":await this.ge(e);break;case"Use Team Config":await this.me();break;case"Keep My Settings":await this.we(e);break}}async z(e){try{let t=this.g(e),r;if(this.o.has(t))r=this.o.get(t),u.debug("Loaded team configuration from ephemeral storage");else{let s;try{s=await this.s.readFile(e,"utf8")}catch(i){if(i?.code==="ENOENT")return u.debug("Team configuration file not found on disk"),null;throw i}if(typeof s=="string"&&s.trim().startsWith("// virtual content"))return u.debug("Team configuration file placeholder detected (treated as missing)"),null;try{r=JSON.parse(s)}catch{throw new Error("Team configuration file is not valid JSON.")}}let n=this.Ee(r);return n.version!==v&&u.warn(`Team configuration schema mismatch. Expected ${v}, received ${n.version}`),this.c=n,this.R=e,this.P=this.O(n),u.debug("Loaded team configuration",{profileCount:Object.keys(n.profiles||{}).length}),n}catch(t){if(t?.code==="ENOENT")return u.debug("Team configuration file not found during load"),null;throw u.error("Failed to load team configuration:",t),t}}async he(e){let t=this.O(e);if(!t)return[];let r=e.profiles?.[t];if(!r||!r.settings)return[];let n=l.workspace.getConfiguration(),s=[];for(let[i,a]of Object.entries(r.settings)){let c=n.inspect(i);if(!c||!(c.workspaceValue!==void 0||c.globalValue!==void 0))continue;let y=c.workspaceValue!==void 0?c.workspaceValue:c.globalValue;if(this.q(y,a))continue;let x={key:i,profileId:t,teamValue:a,userValue:y,source:c.workspaceValue!==void 0?"workspace":"global",impact:this.ye(i,a,y),chunkEffect:this.be(i,a)};s.push(x)}return s.sort((i,a)=>{let c={high:3,medium:2,low:1};return(c[a.impact]||0)-(c[i.impact]||0)}),u.debug("Detected team configuration conflicts",{conflictCount:s.length}),s}async saveTeamProfiles(e){let t=l.workspace.workspaceFolders?.[0]?.uri;if(!t)throw new Error("No workspace folders available for team profiles");let r=l.Uri.joinPath(t,this.d),n=Object.keys(e),s={version:v,createdAt:new Date().toISOString(),defaultProfile:n[0]||null,profiles:e,metadata:{extensionVersion:this.J(),vscodeVersion:l.version}};try{await this.s.ensureDirectory(t)}catch(i){if(!this.Y(i))throw i;u.warn("Workspace directory is not writable; continuing with ephemeral storage",{code:i.code}),this.X(i)}try{return await this.Se(r,s),this.c=s,this.R=r,this.P=this.O(s),u.info("Saved team profiles",{profileCount:Object.keys(e).length}),r}catch(i){throw u.error("Failed to save team profiles:",i),new Error(`Failed to save team profiles: ${i.message}`)}}async loadTeamProfiles(e=!1){let t=l.workspace.workspaceFolders?.[0]?.uri;if(!t)return null;let r=l.Uri.joinPath(t,this.d);try{return(await this.z(r))?.profiles??null}catch(n){return n.code==="FileNotFound"||(e||(n.message.includes("not valid JSON")||n.message.includes("JSON parsing failed")?l.window.showErrorMessage("Explorer Dates team configuration file appears to be corrupted. Please check the .explorer-dates-profiles.json file or restore from backup.","Show File Location").then(s=>{s==="Show File Location"&&l.commands.executeCommand("revealInExplorer",r)}):n.code==="TIMEOUT"||n.message.includes("timed out")||n.name==="NetworkError"&&n.message.includes("fetch failed")?l.window.showErrorMessage("Explorer Dates team configuration could not be loaded due to network timeout. Please check your connection and try again.","Retry").then(s=>{s==="Retry"&&this.loadTeamProfiles(!0)}):(n.code==="EACCES"||n.code==="EPERM")&&l.window.showWarningMessage("Explorer Dates team configuration cannot be accessed due to file permissions. Contact your administrator to enable read access to the workspace folder.")),u.error("Failed to load team profiles:",n)),null}}async hasTeamConfiguration(){let e=l.workspace.workspaceFolders?.[0]?.uri;if(!e)return!1;let t=l.Uri.joinPath(e,this.d),r=this.g(t);return this.o.has(r)?!0:await this.I(t)}async createTeamProfile(e,t){let{name:r,description:n="",settings:s={},metadata:i={}}=t;if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");if(!r||typeof r!="string")throw new Error("Profile name must be a non-empty string");this.F(s);let a=await this.loadTeamProfiles(!0)||{};if(a[e])throw new Error(`Profile with ID '${e}' already exists`);let c={name:r,description:n,settings:s,metadata:{createdAt:new Date().toISOString(),createdBy:l.env.uriScheme==="vscode-insiders"?"vscode-insiders":"vscode",extensionVersion:this.J(),...i}},p={...a,[e]:c};return await this.saveTeamProfiles(p),u.info("Created team profile",{profileId:e,name:r}),c}async updateTeamProfile(e,t){if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");let r=await this.loadTeamProfiles(!0)||{};if(!r[e])throw new Error(`Profile with ID '${e}' does not exist`);let n=r[e];t.settings&&this.F(t.settings);let s={...n,...t,metadata:{...n.metadata,...t.metadata,updatedAt:new Date().toISOString(),updatedBy:l.env.uriScheme==="vscode-insiders"?"vscode-insiders":"vscode"}},i={...r,[e]:s};return await this.saveTeamProfiles(i),u.info("Updated team profile",{profileId:e,changes:Object.keys(t)}),s}async deleteTeamProfile(e){if(!e||typeof e!="string")throw new Error("Profile ID must be a non-empty string");let t=await this.loadTeamProfiles(!0)||{};if(!t[e])throw new Error(`Profile with ID '${e}' does not exist`);let{[e]:r,...n}=t;if(Object.keys(n).length===0){let s=l.workspace.workspaceFolders?.[0]?.uri;if(s){let i=l.Uri.joinPath(s,this.d),a=this.g(i);this.o.delete(a);try{await this.s.delete(i),u.info("Deleted team configuration file (no profiles remaining)")}catch(c){u.warn("Could not delete team configuration file",{error:c.message})}}}else await this.saveTeamProfiles(n);return u.info("Deleted team profile",{profileId:e,name:r.name}),r}async listTeamProfiles(e={}){let t=await this.loadTeamProfiles(!0)||{},r=Object.entries(t).map(([i,a])=>({id:i,...a})),n=r;if(e.namePattern){let i=new RegExp(e.namePattern,"i");n=n.filter(a=>i.test(a.name))}if(e.hasSettings){let i=Array.isArray(e.hasSettings)?e.hasSettings:[e.hasSettings];n=n.filter(a=>i.every(c=>a.settings&&c in a.settings))}if(e.createdAfter){let i=new Date(e.createdAfter);n=n.filter(a=>a.metadata?.createdAt&&new Date(a.metadata.createdAt)>i)}let s=e.sortBy||"createdAt";return n.sort((i,a)=>{if(s==="createdAt"){let c=i.metadata?.createdAt?new Date(i.metadata.createdAt):new Date(0);return(a.metadata?.createdAt?new Date(a.metadata.createdAt):new Date(0)).getTime()-c.getTime()}else if(s==="name")return i.name.localeCompare(a.name);return 0}),u.debug("Listed team profiles",{total:r.length,filtered:n.length,filters:e}),n}async resolveConflictsAutomatically(e,t="prompt"){if(!Array.isArray(e)||e.length===0)return{resolved:0,skipped:0,errors:[]};let r={resolved:0,skipped:0,errors:[]};for(let n of e)try{let s=!1;switch(t){case"team-wins":s=!0;break;case"user-wins":s=!1;break;case"high-impact-only":s=n.impact==="high";break;case"chunks-only":s=!!n.chunkEffect;break;case"prompt":default:let i=await l.window.showQuickPick([{label:"Apply Team Value",value:!0},{label:"Keep My Value",value:!1},{label:"Skip This Setting",value:null}],{placeHolder:`Resolve conflict for ${n.key}`,ignoreFocusOut:!0});if(!i){r.skipped++;continue}if(i.value===null){r.skipped++;continue}s=i.value;break}s?(await this.Z(n.key,n.teamValue),r.resolved++,u.info("Auto-resolved conflict",{key:n.key,strategy:t,action:"applied-team-value"})):t!=="prompt"&&(r.skipped++,u.debug("Skipped conflict resolution",{key:n.key,strategy:t,action:"kept-user-value"}))}catch(s){r.errors.push({key:n.key,error:s.message}),u.error("Failed to resolve conflict",{key:n.key,error:s.message})}return u.info("Completed automatic conflict resolution",r),r}async ge(e){if(!e||e.length===0){l.window.showInformationMessage("No Explorer Dates conflicts to review.");return}let t=e.map(s=>({label:s.key,description:`Team: ${this.m(s.teamValue)} | You: ${this.m(s.userValue)}`,detail:`${s.chunkEffect||"UI setting change"} \xB7 Impact: ${s.impact}`,conflict:s})),r=await l.window.showQuickPick(t,{placeHolder:"Review team configuration conflicts",ignoreFocusOut:!0});if(!r)return;await l.window.showInformationMessage(`Apply team value for "${r.conflict.key}"?`,"Apply Team Value","Keep My Value")==="Apply Team Value"&&(await this.Z(r.conflict.key,r.conflict.teamValue),l.window.showInformationMessage(`Updated ${r.conflict.key} to match team configuration.`))}async me(){if(!this.c){l.window.showWarningMessage("No team configuration is loaded. Validate the team config first.");return}let e=this.O(this.c),t=e?this.c.profiles?.[e]:null;if(!t||!t.settings){l.window.showWarningMessage("Team configuration is missing an active profile.");return}let r={},n=[];for(let[s,i]of Object.entries(t.settings)){let a=this.f.inspect(s),c=a?.workspaceValue??a?.globalValue??a?.defaultValue;if(r[s]=c,this.q(c,i))continue;let p=await this.f.updateSetting(s,i,{scope:"workspace",reason:`team-profile:${e}`});p.updated&&n.push(p.key)}n.length>0?(await this.j?.workspaceState?.update(Kt,{appliedAt:new Date().toISOString(),profileId:e,settings:r}),l.window.showInformationMessage(`Applied ${n.length} Explorer Dates settings from team profile "${t.name}".`)):l.window.showInformationMessage("Your settings already match the selected team profile.")}async we(e){if(!e||e.length===0){l.window.showInformationMessage("No overrides to document.");return}let t=this.ke();if(!t){u.warn("Cannot document overrides without a workspace.");return}let r=l.Uri.joinPath(t,".vscode"),n=l.Uri.joinPath(r,"explorer-dates-overrides.md");await this.s.ensureDirectory(r);let s="";await this.I(n)?(s=await this.s.readFile(n,"utf8"),s.includes("# Explorer Dates Override Notes")||(s=`# Explorer Dates Override Notes

${s.trimStart()}`)):s=`# Explorer Dates Override Notes

`;let i=this.De(e);await this.s.writeFile(n,`${s}${i}
`,"utf8"),l.window.showInformationMessage("Documented Explorer Dates overrides in .vscode/explorer-dates-overrides.md")}async I(e){let t=this.g(e);if(this.o.has(t))return!0;try{return await this.s.stat(e),!0}catch{return!1}}J(){try{return l.extensions.getExtension("your.extension-id")?.packageJSON?.version||"unknown"}catch{return"unknown"}}O(e){if(!e?.profiles)return null;let{activeProfile:t,defaultProfile:r,profiles:n}=e;return t&&n[t]?t:r&&n[r]?r:Object.keys(n)[0]||null}q(e,t){if(e===t)return!0;if(typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1}m(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="object")try{return JSON.stringify(e)}catch{return"[object]"}return String(e)}ye(e,t,r){return K[e]?typeof t=="boolean"?"high":"medium":typeof t=="boolean"&&typeof r=="boolean"?"medium":"low"}be(e,t){let r=K[e];if(!r)return null;let n=Vt[r]||r,s=Mt[r]||0;return`${n} chunk will be ${t?"enabled":"disabled"}${s?` (${s}KB)`:""}`}async Z(e,t){await this.f.updateSetting(e,t,{scope:"workspace",reason:"team-conflict-resolution"})}ke(){return l.workspace.workspaceFolders?.[0]?.uri??null}De(e){let t=[`## ${new Date().toISOString()}`,"","| Setting | Team Value | Your Value | Impact | Notes |","| --- | --- | --- | --- | --- |"];for(let r of e){let n=[];r.chunkEffect&&n.push(r.chunkEffect);let s=r.reason||r.overrideReason;s&&n.push(`Reason: ${s}`);let i=r.userChoice||r.choice;i&&n.push(`User choice: ${i}`);let a=n.length>0?n.join(" \u2022 "):"n/a";t.push(`| \`${r.key}\` | ${this.m(r.teamValue)} | ${this.m(r.userValue)} | ${r.impact} | ${a} |`)}t.push("");for(let r of e){t.push(`## Setting: ${r.key}`),t.push(`- Team value: ${this.m(r.teamValue)}`),t.push(`- Your value: ${this.m(r.userValue)}`),(r.userChoice||r.choice)&&t.push(`- User choice: ${r.userChoice||r.choice}`);let n=r.reason||r.overrideReason;n&&t.push(`- Reason: ${n}`),r.chunkEffect&&t.push(`- Chunk impact: ${r.chunkEffect}`),t.push("")}return t.push(""),t.join(`
`)}Ee(e){if(!e||typeof e!="object")throw new Error("Team configuration file is empty or invalid.");let{profiles:t}=e;if(!t||typeof t!="object"||Object.keys(t).length===0)throw new Error("Team configuration must include at least one profile.");let r={};for(let[n,s]of Object.entries(t)){if(!s||typeof s!="object")continue;let i=typeof s.settings=="object"?s.settings:{};r[n]={id:n,name:s.name||n,description:s.description||"",priority:s.priority||"normal",chunks:Array.isArray(s.chunks)?s.chunks:[],settings:i,metadata:s.metadata||{}}}if(Object.keys(r).length===0)throw new Error("Team configuration profiles are malformed.");return{version:e.version||v,defaultProfile:e.defaultProfile||Object.keys(r)[0],activeProfile:e.activeProfile,profiles:r,metadata:e.metadata||{},createdAt:e.createdAt||null,updatedAt:e.updatedAt||null}}F(e){if(!e||typeof e!="object")throw new Error("Settings must be a valid object");let t=new Set(Object.keys(K)),r=new Set(["explorerDates.dateFormat","explorerDates.showFileAge","explorerDates.colorizeByAge","explorerDates.excludePatterns","explorerDates.maxCacheSize","explorerDates.refreshInterval"]),n=new Set([...t,...r]),s=[],i=[];for(let a of Object.keys(e))n.has(a)||(a.startsWith("explorerDates.")?i.push(a):s.push(a));if(s.length>0)throw new Error(`Invalid settings detected: ${s.join(", ")}. Settings must start with 'explorerDates.'`);i.length>0&&u.warn("Unrecognized Explorer Dates settings in team profile",{keys:i});for(let[a,c]of Object.entries(e))this.Ce(a,c)}Ce(e,t){let r=new Set(Object.keys(K));if(r.add("explorerDates.showFileAge"),r.add("explorerDates.colorizeByAge"),r.has(e)&&typeof t!="boolean")throw new Error(`Setting '${e}' must be a boolean value, got ${typeof t}`);if(e==="explorerDates.dateFormat"&&(typeof t!="string"||t.trim().length===0))throw new Error(`Setting '${e}' must be a non-empty string`);if(e==="explorerDates.excludePatterns"){if(!Array.isArray(t))throw new Error(`Setting '${e}' must be an array of patterns`);for(let s of t)if(typeof s!="string")throw new Error(`Exclude pattern must be a string, got ${typeof s}`)}if(new Set(["explorerDates.maxCacheSize","explorerDates.refreshInterval"]).has(e)&&(typeof t!="number"||t<0))throw new Error(`Setting '${e}' must be a non-negative number, got ${t}`)}async exportTeamConfiguration(e="json",t={}){let r=this.c;if(!r)throw new Error("No team configuration is currently loaded");let{includeMetadata:n=!0,prettify:s=!0}=t,i={...r};switch(n||(delete i.metadata,i.profiles=Object.fromEntries(Object.entries(i.profiles).map(([a,c])=>{let p={...c};return delete p.metadata,[a,p]}))),e.toLowerCase()){case"json":return JSON.stringify(i,null,s?2:0);case"yaml":return this.Oe(i);case"vscode-settings":let a={};for(let c of Object.values(i.profiles))Object.assign(a,c.settings);return JSON.stringify(a,null,s?2:0);case"csv":return this.Te(i);default:throw new Error(`Unsupported export format: ${e}`)}}async importTeamConfiguration(e,t="json",r={}){let{validate:n=!0,merge:s=!1}=r,i;try{switch(t.toLowerCase()){case"json":i=JSON.parse(e);break;case"vscode-settings":let a=JSON.parse(e);i=this.Ae(a);break;default:throw new Error(`Unsupported import format: ${t}`)}}catch(a){throw new Error(`Failed to parse ${t} data: ${a.message}`)}if(n&&this.xe(i),s){let a=await this.loadTeamProfiles(!0)||{};i.profiles={...a,...i.profiles}}return await this.saveTeamProfiles(i.profiles),u.info("Imported team configuration",{format:t,profileCount:Object.keys(i.profiles).length,merge:s}),i}startTeamConfigWatcher(){this.t&&this.t.dispose();let e=l.workspace.workspaceFolders?.[0]?.uri;if(!e){u.warn("Cannot start team config watcher without workspace");return}let t=new l.RelativePattern(e,this.d);this.t=l.workspace.createFileSystemWatcher(t),this.t.onDidCreate(async r=>{u.info("Team configuration file created, revalidating"),await this.$(r,"created")}),this.t.onDidChange(async r=>{u.info("Team configuration file changed, revalidating"),await this.$(r,"changed")}),this.t.onDidDelete(async r=>{u.info("Team configuration file deleted"),await this.$(r,"deleted")}),u.info("Started team configuration file watcher")}stopTeamConfigWatcher(){this.t&&(this.t.dispose(),this.t=null,u.info("Stopped team configuration file watcher"))}async $(e,t){try{if(t==="deleted"){this.c=null,this.R=null,this.P=null,l.window.showInformationMessage("Explorer Dates team configuration was removed.","Understood");return}this.h&&clearTimeout(this.h),this.h=setTimeout(async()=>{try{let r=await this.validateTeamConfiguration();r.hasTeamConfig&&r.conflicts.length>0?l.window.showInformationMessage(`Explorer Dates team configuration updated with ${r.conflicts.length} conflicts detected.`,"Review Conflicts","Ignore").then(n=>{n==="Review Conflicts"&&this.H(r.conflicts)}):r.hasTeamConfig&&l.window.showInformationMessage("Explorer Dates team configuration updated successfully.","Understood")}catch(r){u.error("Failed to handle team config change",r),l.window.showErrorMessage(`Explorer Dates team configuration update failed: ${r.message}`)}},1e3)}catch(r){u.error("Error handling team config change",r)}}Oe(e){let t=[],r=(n,s=0)=>{let i="  ".repeat(s);for(let[a,c]of Object.entries(n))if(c==null)t.push(`${i}${a}: null`);else if(typeof c=="object"&&!Array.isArray(c))t.push(`${i}${a}:`),r(c,s+1);else if(Array.isArray(c)){t.push(`${i}${a}:`);for(let p of c)t.push(`${i}  - ${JSON.stringify(p)}`)}else t.push(`${i}${a}: ${JSON.stringify(c)}`)};return r(e),t.join(`
`)}Te(e){let t=[];t.push("Profile ID,Profile Name,Setting Key,Setting Value,Description");for(let[r,n]of Object.entries(e.profiles)){let s=n.name||r,i=n.description||"";if(n.settings&&Object.keys(n.settings).length>0)for(let[a,c]of Object.entries(n.settings)){let p=[r,s,a,typeof c=="string"?c:JSON.stringify(c),i].map(y=>`"${String(y).replace(/"/g,'""')}"`).join(",");t.push(p)}else{let a=[r,s,"","",i].map(c=>`"${String(c).replace(/"/g,'""')}"`).join(",");t.push(a)}}return t.join(`
`)}Ae(e){let t={};for(let[r,n]of Object.entries(e))r.startsWith("explorerDates.")&&(t[r]=n);if(Object.keys(t).length===0)throw new Error("No Explorer Dates settings found in VS Code settings");return{version:v,defaultProfile:"imported",profiles:{imported:{name:"Imported Configuration",description:"Configuration imported from VS Code settings",settings:t,metadata:{importedAt:new Date().toISOString(),source:"vscode-settings"}}},metadata:{importedAt:new Date().toISOString(),source:"vscode-settings"}}}xe(e){if(!e||typeof e!="object")throw new Error("Imported data must be a valid object");if(!e.profiles||typeof e.profiles!="object")throw new Error("Imported data must contain a profiles object");let t=Object.keys(e.profiles).length;if(t===0)throw new Error("Imported data must contain at least one profile");for(let[r,n]of Object.entries(e.profiles)){if(!n||typeof n!="object")throw new Error(`Profile '${r}' is invalid`);if(!n.name||typeof n.name!="string")throw new Error(`Profile '${r}' must have a valid name`);if(n.settings)try{this.F(n.settings)}catch(s){throw new Error(`Profile '${r}' has invalid settings: ${s.message}`)}}u.info("Validated imported team configuration",{profileCount:t})}dispose(){this.stopTeamConfigWatcher(),this.h&&(clearTimeout(this.h),this.h=null),this.o.clear(),u.info("Team persistence manager disposed")}g(e){return e?typeof e=="string"?e:e.fsPath||e.path||String(e):""}Y(e){return e?new Set(["EACCES","EPERM","EROFS","ENOSPC"]).has(e.code):!1}X(e){let t=e?.code||"generic";if(this.C.has(t))return;this.C.add(t);let r=e?.code,n;r==="ENOSPC"?n="Explorer Dates team configuration could not be saved because the disk is full.":n="Explorer Dates team configuration could not be saved because the workspace is read-only or permissions are restricted.",l.window.showWarningMessage(`${n} Changes will be kept in memory until VS Code restarts, so they may be lost.`,"Understood")}async Se(e,t){let r=JSON.stringify(t,null,2);try{await this.s.writeFile(e,r,"utf8"),this.o.delete(this.g(e)),this.Le()}catch(n){if(this.Y(n)){let s=JSON.parse(r);this.o.set(this.g(e),s),u.warn("Stored team configuration in ephemeral memory due to filesystem restriction",{code:n.code}),this.X(n);return}throw n.code==="ENOSPC"?l.window.showErrorMessage("Explorer Dates team configuration cannot be saved - disk is full. Free up some space and try again.","Understood"):(n.code==="EACCES"||n.code==="EPERM")&&l.window.showErrorMessage("Explorer Dates team configuration cannot be saved due to insufficient permissions. Contact your administrator to enable write access.","Understood"),n}}Le(){this.C.size!==0&&(this.C.clear(),u.debug("Filesystem write succeeded after restriction; warning prompts reset"))}};Fe.exports={TeamConfigPersistenceManager:te}});var We=E((lr,Ne)=>{var h=require("vscode"),{getLogger:Bt}=L(),{RuntimeConfigManager:Ut}=Ee(),{TeamConfigPersistenceManager:Gt}=$e(),S=Bt();function zt(o){let e=new Ut(o),t=new Gt(o);return[h.commands.registerCommand("explorerDates.applyPreset",async()=>{try{await e.showAllPresets()}catch(n){S.error("Apply preset command failed:",n),h.window.showErrorMessage(`Failed to apply preset: ${n.message}`)}}),h.commands.registerCommand("explorerDates.restorePreviousPreset",async()=>{try{(await e.restorePreviousPreset()).restored||S.info("No preset backup available to restore")}catch(n){S.error("Restore previous preset command failed:",n),h.window.showErrorMessage(`Failed to restore previous preset: ${n.message}`)}}),h.commands.registerCommand("explorerDates.configureRuntime",async()=>{try{let n=await e.getCurrentRuntimeState();await e.showPresetComparison(n.currentSettings)}catch(n){S.error("Configure runtime command failed:",n),h.window.showErrorMessage(`Failed to show runtime configuration: ${n.message}`)}}),h.commands.registerCommand("explorerDates.suggestOptimalPreset",async()=>{try{await e.checkAutoSuggestion()}catch(n){S.error("Suggest optimal preset command failed:",n),h.window.showErrorMessage(`Failed to suggest preset: ${n.message}`)}}),h.commands.registerCommand("explorerDates.showChunkStatus",async()=>{try{let n=await e.getCurrentRuntimeState();await Ht(n)}catch(n){S.error("Show chunk status command failed:",n),h.window.showErrorMessage(`Failed to show chunk status: ${n.message}`)}}),h.commands.registerCommand("explorerDates.optimizeBundle",async()=>{try{let n=await e.getCurrentRuntimeState();if(n.analysis){let s=Jt(n.analysis);await e.showPresetComparison(n.currentSettings,s)}else await e.showAllPresets()}catch(n){S.error("Optimize bundle command failed:",n),h.window.showErrorMessage(`Failed to optimize bundle: ${n.message}`)}}),h.commands.registerCommand("explorerDates.validateTeamConfig",async()=>{try{let n=await t.validateTeamConfiguration();if(n.hasTeamConfig){let s=n.conflicts.length>0?`Found ${n.conflicts.length} conflicts.`:"No conflicts detected.";h.window.showInformationMessage(`Team configuration validated. ${s}`)}else h.window.showInformationMessage("No team configuration found in workspace.")}catch(n){S.error("Validate team config command failed:",n),h.window.showErrorMessage(`Failed to validate team configuration: ${n.message}`)}})].forEach(n=>o.subscriptions.push(n)),S.info("Runtime management commands registered"),{runtimeManager:e,teamPersistenceManager:t}}async function Ht(o){let e=h.workspace.getConfiguration("explorerDates"),r=[{name:"Onboarding System",key:"enableOnboardingSystem",size:34},{name:"Analysis Commands",key:"enableAnalysisCommands",size:23},{name:"Export Reporting",key:"enableExportReporting",size:17},{name:"Extension API",key:"enableExtensionApi",size:15},{name:"Workspace Templates",key:"enableWorkspaceTemplates",size:14},{name:"Advanced Cache",key:"enableAdvancedCache",size:28},{name:"Workspace Intelligence",key:"enableWorkspaceIntelligence",size:31},{name:"Incremental Workers",key:"enableIncrementalWorkers",size:19}].map(n=>{let s=e.get(n.key,!0),i=s?"\u2705":"\u274C",a=s?"Enabled":"Disabled";return{label:`${i} ${n.name}`,description:`${n.size}KB | ${a}`,detail:qt(n.key)}});r.unshift({label:"\u{1F4CA} Bundle Summary",description:`Total: ${o.currentBundleSize}KB`,detail:`Base bundle: 99KB + ${o.currentBundleSize-99}KB chunks`}),await h.window.showQuickPick(r,{placeHolder:"Current chunk status",ignoreFocusOut:!0})}function qt(o){return{enableOnboardingSystem:"Welcome messages and guided setup",enableAnalysisCommands:"Advanced file analysis and metrics",enableExportReporting:"CSV/JSON export and reporting features",enableExtensionApi:"Public API for other extensions",enableWorkspaceTemplates:"Project templates and scaffolding",enableAdvancedCache:"Intelligent caching and performance",enableWorkspaceIntelligence:"Smart workspace analysis and insights",enableIncrementalWorkers:"Background processing and optimization"}[o]||"Explorer Dates feature chunk"}function Jt(o){if(!o)return null;let{workspaceSize:e,isRemoteEnvironment:t}=o,r;e==="extreme"||e==="large"&&t?r="minimal":e==="large"||t?r="balanced":r="enterprise";let{PRESET_DEFINITIONS:n}=I();return n[r]||n.balanced}Ne.exports={registerRuntimeCommands:zt}});var{registerRuntimeCommands:Yt}=We();module.exports={registerRuntimeCommands:Yt};
